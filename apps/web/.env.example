# Server-only environment variables for apps/web
# Never commit real secrets. Copy to .env.local for local dev.

# ─── Database ──────────────────────────────────────────────────────────
# Use a standard Postgres URL:
#   postgresql://user:pass@host:5432/db?sslmode=require
DATABASE_URL=postgres://postgres:postgres@localhost:5432/proofpack

# Optional: increase connect timeout for remote DBs (Neon, etc)
DB_CONNECT_TIMEOUT_SEC=30

# ─── Session Auth ──────────────────────────────────────────────────────
# Secret used to sign/verify session cookies (required).
PROOFPACK_SESSION_SECRET=change-me-to-a-random-64-char-string

# Bootstrap key required to create sessions in production.
# In dev, sessions can be created without this.
# PROOFPACK_SESSION_BOOTSTRAP_KEY=

# ─── Reviewer Auth ─────────────────────────────────────────────────────
# Shared secret for dispute reviewer endpoints.
# PROOFPACK_REVIEWER_KEY=

# ─── Exchange Admin ────────────────────────────────────────────────────
# Shared secret for admin withdrawal review endpoints.
# EXCHANGE_ADMIN_KEY=

# ─── Cron / Ops ───────────────────────────────────────────────────────
# Shared secret for cron endpoints (passed via ?secret=... or x-cron-secret).
# EXCHANGE_CRON_SECRET=
# Compatibility fallback (some endpoints accept this too):
# CRON_SECRET=

# Optional: dedicated secret for P2P cron endpoints (falls back to EXCHANGE_CRON_SECRET/CRON_SECRET).
# P2P_CRON_SECRET=

# Feature gates (production safety)
# EXCHANGE_ENABLE_PRICE_ALERTS=0
# EXCHANGE_ENABLE_CONDITIONAL_ORDERS=0
# EXCHANGE_ENABLE_NOTIFICATIONS_DIGEST=0

# ─── AI (optional) ────────────────────────────────────────────────────
# Groq API key used for AI Oracle + optional explainability rephrase.
# GROQ_API_KEY=
# Enable /api/explain/*?ai=1 (rules-first response + optional AI rephrase).
# EXPLAIN_ENABLE_AI_REPHRASE=0

# Exchange (optional safety limits)
# These are OFF by default unless explicitly set.
#
# Max number of open orders per user (0/blank = unlimited)
# EXCHANGE_MAX_OPEN_ORDERS_PER_USER=0
#
# Max order notional (price * quantity) per order (0/blank = unlimited)
# EXCHANGE_MAX_ORDER_NOTIONAL=0
#
# Limit-order price band protection in basis points around a reference price.
# Example: 250 = 2.50%. 0/blank = disabled.
# EXCHANGE_PRICE_BAND_BPS=0
#
# Per-user cancel rate limit (requests per minute). 0/blank = disabled.
# EXCHANGE_CANCEL_MAX_PER_MIN=0

# Optional: seed an admin user via scripts/seed-admin-prod.ts
# ADMIN_EMAIL=admin@tradesynapse.local
# ADMIN_PASSWORD=change-me
# ADMIN_DISPLAY_NAME=Admin

# ─── Gas fees (BSC native token) ─────────────────────────────────────
# Gas fees are displayed in BNB and can be charged in-kind (BNB) or converted
# to the transacted asset depending on the action.
#
# Enable/disable charging (display still works when disabled).
# GAS_ENABLED=false
# GAS_FEE_MODE=realtime   # realtime | static
#
# Static fallback fees (BNB, 18 decimals as numeric strings)
# GAS_ACTION_FEE_BNB=0
# GAS_USER_TRANSFER_FEE_BNB=0
#
# Burn portion of each gas fee, in basis points (100 = 1%). Default 25 bps = 0.25%.
# GAS_BURN_BPS=25

# ─── Proof Pack Signing (optional) ────────────────────────────────────
# Ed25519 private key for signing proof packs.
# PROOFPACK_SIGNING_PRIVATE_KEY=
# PROOFPACK_SIGNING_PRIVATE_KEY_B64=
# PROOFPACK_REQUIRE_SIGNED=

# ─── Evidence Storage ─────────────────────────────────────────────────
# Backend: "local" (default) or "s3"
EVIDENCE_STORAGE=local

# Local backend:
# EVIDENCE_DIR=

# S3 backend (required when EVIDENCE_STORAGE=s3):
# EVIDENCE_S3_BUCKET=proofpack-evidence
# EVIDENCE_S3_REGION=us-east-1
# EVIDENCE_S3_ENDPOINT=
# EVIDENCE_S3_ACCESS_KEY=
# EVIDENCE_S3_SECRET_KEY=
# EVIDENCE_S3_PREFIX=evidence/
# EVIDENCE_S3_FORCE_PATH=false

# ─── Withdrawal Velocity Limits ───────────────────────────────────────
# Hard caps on withdrawal requests per user. Beyond these, the request
# is rejected with 429.
# WITHDRAWAL_MAX_COUNT_1H=5
# WITHDRAWAL_MAX_COUNT_24H=15
# Max total requested amount (numeric string) per 24h window. 0 = unlimited.
# WITHDRAWAL_MAX_AMOUNT_24H=0

# ─── Outbox Worker ─────────────────────────────────────────────────────
# OUTBOX_POLL_MS=500
# OUTBOX_BATCH=25
# OUTBOX_LOCK_TTL_SEC=30
# Max handler attempts before dead-lettering an event.
# OUTBOX_MAX_ATTEMPTS=10

# ─── Email (SMTP) ─────────────────────────────────────────────────────
# Leave blank to use console-only transport (emails logged to stdout).
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASS=
# EMAIL_FROM=noreply@tradesynapse.com
# EMAIL_FROM_NAME=TradeSynapse

# ─── BSC / On-chain ───────────────────────────────────────────────────
# BSC RPC endpoint for deposit address generation.
# BSC_RPC_URL=https://bsc-dataseed.binance.org/
# Master seed for HD wallet derivation (BIP-39 mnemonic or hex).
# CITADEL_MASTER_SEED=

# ─── Client / UI ──────────────────────────────────────────────────────
# Use mainnet addresses in the UI (affects explorer links).
# NEXT_PUBLIC_USE_MAINNET=false

# ─── Security ─────────────────────────────────────────────────────────
# Allowed origin for CSRF checks (defaults to request origin).
# ALLOWED_ORIGIN=http://localhost:3000
# Enforce auth even in development? (set to "1" to require login).
# ENFORCE_AUTH=0

# Dev-only: optional proxy auto-login (middleware injects x-user-id when no session cookie exists).
# Default is OFF to keep API testing predictable and avoid identity surprises.
PROXY_DEV_AUTOLOGIN=0
# PROXY_DEV_USER_ID=aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee

# ─── Arbitrage Scanner ──────────────────────────────────────────────
# Comma-separated list of symbols to scan. Accepts e.g. BTCUSDT or BTC/USDT.
# ARB_SYMBOLS=BTCUSDT,ETHUSDT

# Comma-separated exchanges to scan (price comparison). Default: binance,bybit
# ARB_EXCHANGES=binance,bybit

# Comma-separated exchanges allowed to produce "opportunities". Default: same as ARB_EXCHANGES
# Useful when you want scanner-only venues but don't want to imply executability.
# ARB_OPP_EXCHANGES=binance,bybit

# Gross spread floor (percent). Very small by default.
# ARB_MIN_SPREAD_PCT=0.001

# Net spread floor (percent) after fees/slippage/transfer estimates.
# Default 0: only show net-positive opportunities.
# ARB_MIN_NET_SPREAD_PCT=0

# Cost model (estimates):
# - taker fee per leg in bps (10 bps = 0.10%)
# - slippage per leg in bps (2 bps default)
# - optional transfer overhead in bps (0 if you keep inventory on both exchanges)
# ARB_TAKER_FEE_BPS=10
# ARB_SLIPPAGE_BPS=2
# ARB_TRANSFER_BPS=0

# Auto-trade (disabled by default; see API safety gate)
# ARB_AUTOTRADE_ENABLED=0

# EXPRESS ROUTER (Net Quote)
# -------------------------
# Computes an estimated net route using:
#   fiat <-> USDT via P2P fixed-price ads
#   USDT <-> ASSET via external spot tickers (Binance/Bybit)
#
# Exchanges to consider for the spot leg.
# EXPRESS_EXCHANGES=binance,bybit
#
# Fee + slippage assumptions used to compute effective bid/ask.
# Defaults fall back to ARB_TAKER_FEE_BPS / ARB_SLIPPAGE_BPS.
# EXPRESS_TAKER_FEE_BPS=10
# EXPRESS_SLIPPAGE_BPS=3

# ─── Deposit Scanner ────────────────────────────────────────────────
# Scanner confirmations before crediting a deposit event.
# DEPOSIT_CONFIRMATIONS=3

# Optional initial block if no cursor exists yet.
# DEPOSIT_SCAN_START_BLOCK=0

# ─── P2P Market Seeding / Market Maker ──────────────────────────────
# One-shot seed controls:
# P2P_SEED_ADS_PER_SIDE=2
# P2P_SEED_CLOSE_EXISTING=1

# Continuous market-maker controls:
# P2P_MM_INTERVAL_MS=45000
# P2P_MM_ADS_PER_SIDE=2

# ─── P2P Verified Agents (liquidity) ───────────────────────────────
# Comma-separated list of email addresses that should be shown as "Verified"
# in the P2P marketplace even when they have no feedback/trade history yet.
# This is an explicit platform trust signal (not fake reputation).
# Example:
# P2P_AGENT_EMAILS=agent1@example.com,agent2@example.com
