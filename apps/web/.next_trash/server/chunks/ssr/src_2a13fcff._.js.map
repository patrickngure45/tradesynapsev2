{"version":3,"sources":["../../../../src/components/v2/Button.tsx","../../../../src/components/v2/Card.tsx","../../../../src/components/v2/Skeleton.tsx","../../../../src/lib/api/client.ts","../../../../src/app/admin/markets/marketsClient.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nexport type V2ButtonVariant = \"primary\" | \"secondary\" | \"ghost\" | \"danger\";\r\nexport type V2ButtonSize = \"sm\" | \"md\" | \"lg\";\r\n\r\nexport function v2ButtonClassName(options?: {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n}): string {\r\n  const variant: V2ButtonVariant = options?.variant ?? \"secondary\";\r\n  const size: V2ButtonSize = options?.size ?? \"md\";\r\n\r\n  const base =\r\n    \"inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55\";\r\n\r\n  const sizeClass =\r\n    size === \"lg\" ? \"h-12 px-5 text-[15px]\" : size === \"sm\" ? \"h-9 px-3 text-[13px]\" : \"h-11 px-4 text-[14px]\";\r\n\r\n  const variantClass =\r\n    variant === \"primary\"\r\n      ? \"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n      : variant === \"danger\"\r\n        ? \"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n        : variant === \"ghost\"\r\n          ? \"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]\"\r\n          : \"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]\";\r\n\r\n  const widthClass = options?.fullWidth ? \"w-full\" : \"\";\r\n  const extra = options?.className ?? \"\";\r\n\r\n  return [base, sizeClass, variantClass, widthClass, extra].filter(Boolean).join(\" \");\r\n}\r\n\r\nexport type V2ButtonProps = Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, \"className\"> & {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n};\r\n\r\nexport const V2Button = React.forwardRef<HTMLButtonElement, V2ButtonProps>(function V2Button(\r\n  { variant, size, fullWidth, className, type, ...props },\r\n  ref,\r\n) {\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      type={type ?? \"button\"}\r\n      className={v2ButtonClassName({ variant, size, fullWidth, className })}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n","import type { ReactNode } from \"react\";\r\n\r\nexport function V2Card({\r\n  children,\r\n  className = \"\",\r\n}: {\r\n  children: ReactNode;\r\n  className?: string;\r\n}) {\r\n  return (\r\n    <section\r\n      className={\r\n        \"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] \" +\r\n        className\r\n      }\r\n    >\r\n      {children}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport function V2CardHeader({\r\n  title,\r\n  subtitle,\r\n  right,\r\n}: {\r\n  title: ReactNode;\r\n  subtitle?: ReactNode;\r\n  right?: ReactNode;\r\n}) {\r\n  return (\r\n    <header className=\"flex items-start justify-between gap-3 px-4 pt-4\">\r\n      <div className=\"min-w-0\">\r\n        <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{title}</div>\r\n        {subtitle ? <div className=\"mt-0.5 text-[13px] text-[var(--v2-muted)]\">{subtitle}</div> : null}\r\n      </div>\r\n      {right ? <div className=\"shrink-0\">{right}</div> : null}\r\n    </header>\r\n  );\r\n}\r\n\r\nexport function V2CardBody({ children }: { children: ReactNode }) {\r\n  return <div className=\"px-4 pb-4 pt-3\">{children}</div>;\r\n}\r\n","export function V2Skeleton({ className = \"\" }: { className?: string }) {\r\n  return (\r\n    <div\r\n      className={\r\n        \"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] \" + className\r\n      }\r\n      aria-hidden=\"true\"\r\n    />\r\n  );\r\n}\r\n","export type ApiErrorPayload = {\r\n  error?: string;\r\n  message?: string;\r\n  details?: unknown;\r\n  _raw?: unknown;\r\n};\r\n\r\nexport class ApiError extends Error {\r\n  code: string;\r\n  details?: unknown;\r\n  status?: number;\r\n  requestId?: string;\r\n\r\n  constructor(code: string, opts?: { details?: unknown; status?: number; requestId?: string }) {\r\n    const msg = opts?.requestId ? `${code} (req ${opts.requestId})` : code;\r\n    super(msg);\r\n    this.name = \"ApiError\";\r\n    this.code = code;\r\n    this.details = opts?.details;\r\n    this.status = opts?.status;\r\n    this.requestId = opts?.requestId;\r\n  }\r\n}\r\n\r\nfunction safeJsonParse(text: string): unknown {\r\n  try {\r\n    return text ? JSON.parse(text) : null;\r\n  } catch {\r\n    return { _raw: text };\r\n  }\r\n}\r\n\r\nfunction looksLikeHtml(text: string): boolean {\r\n  const s = String(text ?? \"\").trimStart();\r\n  return s.startsWith(\"<!DOCTYPE html\") || s.startsWith(\"<html\") || s.startsWith(\"<!doctype html\");\r\n}\r\n\r\nfunction sleep(ms: number): Promise<void> {\r\n  return new Promise((r) => setTimeout(r, Math.max(0, Math.floor(ms))));\r\n}\r\n\r\nfunction getImpersonateUserIdFromLocation(): string | null {\r\n  if (typeof window === \"undefined\") return null;\r\n  try {\r\n    const v = new URL(window.location.href).searchParams.get(\"user_id\") ?? \"\";\r\n    const trimmed = v.trim();\r\n    return trimmed ? trimmed : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction shouldAttachImpersonationHeader(input: RequestInfo | URL): boolean {\r\n  if (typeof window === \"undefined\") return false;\r\n\r\n  try {\r\n    const origin = window.location.origin;\r\n    const url =\r\n      typeof input === \"string\"\r\n        ? new URL(input, origin)\r\n        : input instanceof URL\r\n          ? input\r\n          : input instanceof Request\r\n            ? new URL(input.url)\r\n            : null;\r\n\r\n    if (!url) return false;\r\n    if (url.origin !== origin) return false;\r\n    return url.pathname.startsWith(\"/api/\");\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction getCsrfToken(): string | null {\r\n  if (typeof document === \"undefined\") return null;\r\n  const match = document.cookie.match(/(?:^|;\\s*)__csrf=([^;]+)/);\r\n  return match?.[1] ?? null;\r\n}\r\n\r\nexport async function fetchJsonOrThrow<T>(\r\n  input: RequestInfo | URL,\r\n  init?: RequestInit\r\n): Promise<T> {\r\n  const mergedInit: RequestInit | undefined = init\r\n    ? ({\r\n        ...init,\r\n        credentials: init.credentials ?? \"same-origin\",\r\n      } as RequestInit)\r\n    : ({ credentials: \"same-origin\" } as RequestInit);\r\n\r\n  // Attach CSRF double-submit token on mutating requests\r\n  const method = (mergedInit?.method ?? \"GET\").toUpperCase();\r\n\r\n  // Read-only admin view-as: on GET/HEAD requests to our own API, forward the\r\n  // `user_id` from the current page URL as `x-impersonate-user-id`.\r\n  if ((method === \"GET\" || method === \"HEAD\") && shouldAttachImpersonationHeader(input)) {\r\n    const desired = getImpersonateUserIdFromLocation();\r\n    if (desired) {\r\n      const headers = new Headers(mergedInit?.headers);\r\n      if (!headers.has(\"x-impersonate-user-id\")) {\r\n        headers.set(\"x-impersonate-user-id\", desired);\r\n      }\r\n      mergedInit!.headers = headers;\r\n    }\r\n  }\r\n\r\n  if ([\"POST\", \"PUT\", \"PATCH\", \"DELETE\"].includes(method)) {\r\n    const csrf = getCsrfToken();\r\n    if (csrf) {\r\n      const headers = new Headers(mergedInit?.headers);\r\n      if (!headers.has(\"x-csrf-token\")) {\r\n        headers.set(\"x-csrf-token\", csrf);\r\n      }\r\n      mergedInit!.headers = headers;\r\n    }\r\n  }\r\n\r\n  const method0 = (mergedInit?.method ?? \"GET\").toUpperCase();\r\n  const canRetry = method0 === \"GET\" || method0 === \"HEAD\";\r\n  const maxRetries = canRetry ? 2 : 0;\r\n\r\n  let lastErr: unknown = null;\r\n  for (let attempt = 0; attempt <= maxRetries; attempt += 1) {\r\n    try {\r\n      const res = await fetch(input, mergedInit);\r\n      const requestId = res.headers.get(\"x-request-id\") ?? undefined;\r\n\r\n      // Best-effort: remember the last request id so UI/support flows can display it.\r\n      try {\r\n        if (typeof window !== \"undefined\" && requestId) {\r\n          window.sessionStorage.setItem(\"ts.last_request_id\", requestId);\r\n        }\r\n      } catch {\r\n        // ignore\r\n      }\r\n\r\n      const text = await res.text().catch(() => \"\");\r\n      const contentType = res.headers.get(\"content-type\") ?? \"\";\r\n      const isHtml = contentType.includes(\"text/html\") || looksLikeHtml(text);\r\n      const json = (isHtml ? { _raw: \"<html/>\" } : safeJsonParse(text)) as ApiErrorPayload | unknown;\r\n\r\n      if (!res.ok) {\r\n        // Retry transient upstream errors for idempotent requests.\r\n        if (canRetry && (res.status === 502 || res.status === 503 || res.status === 504) && attempt < maxRetries) {\r\n          await sleep(250 * Math.pow(2, attempt));\r\n          continue;\r\n        }\r\n\r\n        if (json && typeof json === \"object\" && \"error\" in (json as ApiErrorPayload)) {\r\n          const payload = json as ApiErrorPayload;\r\n          const code = typeof payload.error === \"string\" ? payload.error : `http_${res.status}`;\r\n          const details =\r\n            payload.details !== undefined\r\n              ? payload.details\r\n              : typeof payload.message === \"string\"\r\n                ? payload.message\r\n                : isHtml\r\n                  ? { message: `Upstream error (HTTP ${res.status}). Please retry.` }\r\n                  : undefined;\r\n          throw new ApiError(code, { details, status: res.status, requestId });\r\n        }\r\n\r\n        if (json && typeof json === \"object\" && \"message\" in (json as ApiErrorPayload)) {\r\n          const payload = json as ApiErrorPayload;\r\n          const details = typeof payload.message === \"string\" ? payload.message : json;\r\n          throw new ApiError(`http_${res.status}`, { details, status: res.status, requestId });\r\n        }\r\n\r\n        const details = isHtml ? { message: `Upstream error (HTTP ${res.status}). Please retry.` } : json;\r\n        throw new ApiError(`http_${res.status}`, { details, status: res.status, requestId });\r\n      }\r\n\r\n      return json as T;\r\n    } catch (e) {\r\n      lastErr = e;\r\n      // Retry network errors on idempotent requests.\r\n      if (canRetry && attempt < maxRetries) {\r\n        await sleep(250 * Math.pow(2, attempt));\r\n        continue;\r\n      }\r\n      throw e;\r\n    }\r\n  }\r\n\r\n  throw lastErr;\r\n}\r\n","\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\n\r\nimport { ApiError, fetchJsonOrThrow } from \"@/lib/api/client\";\r\nimport { V2Button } from \"@/components/v2/Button\";\r\nimport { V2Card, V2CardBody, V2CardHeader } from \"@/components/v2/Card\";\r\nimport { V2Skeleton } from \"@/components/v2/Skeleton\";\r\n\r\ntype MarketRow = {\r\n  id: string;\r\n  chain: string;\r\n  symbol: string;\r\n  status: \"enabled\" | \"disabled\" | string;\r\n  tick_size: string;\r\n  lot_size: string;\r\n  maker_fee_bps: number;\r\n  taker_fee_bps: number;\r\n  created_at: string;\r\n};\r\n\r\ntype ListResponse = {\r\n  ok: true;\r\n  markets: MarketRow[];\r\n};\r\n\r\nexport function AdminMarketsClient() {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [markets, setMarkets] = useState<MarketRow[]>([]);\r\n  const [savingId, setSavingId] = useState<string | null>(null);\r\n\r\n  async function refresh() {\r\n    setError(null);\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetchJsonOrThrow<ListResponse>(\"/api/exchange/admin/markets\", { cache: \"no-store\" });\r\n      setMarkets(Array.isArray(res.markets) ? res.markets : []);\r\n    } catch (e) {\r\n      if (e instanceof ApiError) setError(e.code);\r\n      else setError(\"Network error\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    void refresh();\r\n  }, []);\r\n\r\n  const enabledCount = useMemo(() => markets.filter((m) => m.status === \"enabled\").length, [markets]);\r\n  const disabledCount = useMemo(() => markets.filter((m) => m.status === \"disabled\").length, [markets]);\r\n\r\n  async function setStatus(marketId: string, nextStatus: \"enabled\" | \"disabled\") {\r\n    setError(null);\r\n    setSavingId(marketId);\r\n    try {\r\n      await fetchJsonOrThrow(`/api/exchange/admin/markets/${marketId}/status`, {\r\n        method: \"POST\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify({ status: nextStatus }),\r\n      });\r\n      await refresh();\r\n    } catch (e) {\r\n      if (e instanceof ApiError) setError(e.code);\r\n      else setError(\"Network error\");\r\n    } finally {\r\n      setSavingId(null);\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <V2Skeleton className=\"h-40\" />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid gap-4\">\r\n      {error ? (\r\n        <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--warn-bg)] px-4 py-3 text-[13px] font-semibold text-[var(--v2-text)]\">\r\n          Error: <span className=\"font-extrabold\">{error}</span>\r\n        </div>\r\n      ) : null}\r\n\r\n      <V2Card>\r\n        <V2CardHeader\r\n          title=\"Summary\"\r\n          subtitle={`Enabled ${enabledCount} · Disabled ${disabledCount}`}\r\n          right={\r\n            <V2Button size=\"sm\" variant=\"ghost\" onClick={() => void refresh()}>\r\n              Refresh\r\n            </V2Button>\r\n          }\r\n        />\r\n        <V2CardBody>\r\n          <div className=\"grid gap-2 text-[13px]\">\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div className=\"text-[var(--v2-muted)]\">Total markets</div>\r\n              <div className=\"font-semibold text-[var(--v2-text)]\">{markets.length}</div>\r\n            </div>\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div className=\"text-[var(--v2-muted)]\">Enabled</div>\r\n              <div className=\"font-semibold text-[var(--v2-text)]\">{enabledCount}</div>\r\n            </div>\r\n            <div className=\"flex items-center justify-between gap-3\">\r\n              <div className=\"text-[var(--v2-muted)]\">Disabled</div>\r\n              <div className=\"font-semibold text-[var(--v2-text)]\">{disabledCount}</div>\r\n            </div>\r\n          </div>\r\n        </V2CardBody>\r\n      </V2Card>\r\n\r\n      {markets.length === 0 ? (\r\n        <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-6 py-10 text-center text-[13px] text-[var(--v2-muted)] shadow-[var(--v2-shadow-sm)]\">\r\n          No markets.\r\n        </div>\r\n      ) : (\r\n        <section className=\"overflow-hidden rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-md)]\">\r\n          <table className=\"w-full text-[13px]\">\r\n            <thead className=\"bg-[var(--v2-surface-2)]\">\r\n              <tr className=\"text-left text-[11px] font-extrabold uppercase tracking-widest text-[var(--v2-muted)]\">\r\n                <th className=\"px-4 py-3\">Market</th>\r\n                <th className=\"px-4 py-3\">Status</th>\r\n                <th className=\"px-4 py-3\">Fees</th>\r\n                <th className=\"px-4 py-3 text-right\">Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {markets.map((m) => {\r\n                const isEnabled = m.status === \"enabled\";\r\n                const busy = savingId === m.id;\r\n                return (\r\n                  <tr key={m.id} className=\"border-t border-[var(--v2-border)]\">\r\n                    <td className=\"px-4 py-3\">\r\n                      <div className=\"font-semibold text-[var(--v2-text)]\">{m.symbol}</div>\r\n                      <div className=\"mt-0.5 font-mono text-[11px] text-[var(--v2-muted)]\">{m.id}</div>\r\n                    </td>\r\n                    <td className=\"px-4 py-3\">\r\n                      <span\r\n                        className={\r\n                          \"inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] font-semibold \" +\r\n                          (isEnabled\r\n                            ? \"border-[color-mix(in_srgb,var(--up)_40%,var(--v2-border))] text-[var(--up)]\"\r\n                            : \"border-[color-mix(in_srgb,var(--warn)_40%,var(--v2-border))] text-[var(--warn)]\")\r\n                        }\r\n                      >\r\n                        {isEnabled ? \"enabled\" : \"disabled\"}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-4 py-3 text-[12px] text-[var(--v2-muted)]\">\r\n                      maker {m.maker_fee_bps}bps · taker {m.taker_fee_bps}bps\r\n                    </td>\r\n                    <td className=\"px-4 py-3 text-right\">\r\n                      {isEnabled ? (\r\n                        <V2Button\r\n                          size=\"sm\"\r\n                          variant=\"secondary\"\r\n                          disabled={busy}\r\n                          onClick={() => void setStatus(m.id, \"disabled\")}\r\n                        >\r\n                          {busy ? \"…\" : \"Disable\"}\r\n                        </V2Button>\r\n                      ) : (\r\n                        <V2Button\r\n                          size=\"sm\"\r\n                          variant=\"primary\"\r\n                          disabled={busy}\r\n                          onClick={() => void setStatus(m.id, \"enabled\")}\r\n                        >\r\n                          {busy ? \"…\" : \"Enable\"}\r\n                        </V2Button>\r\n                      )}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </section>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}