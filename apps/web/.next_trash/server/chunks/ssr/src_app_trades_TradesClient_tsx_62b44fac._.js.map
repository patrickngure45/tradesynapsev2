{"version":3,"sources":["../../../../src/app/trades/TradesClient.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\n\r\nimport { ApiError, fetchJsonOrThrow } from \"@/lib/api/client\";\r\nimport { ApiErrorBanner, type ClientApiError } from \"@/components/ApiErrorBanner\";\r\nimport { canOpenDispute, canTransitionTrade, type TradeStatus } from \"@/lib/state/trade\";\r\nimport {\r\n  clearSessionCookie,\r\n  createSessionCookie,\r\n  fetchWhoAmI,\r\n} from \"@/lib/auth/clientSession\";\r\nimport {\r\n  persistActingUserIdPreference,\r\n  readActingUserIdPreference,\r\n} from \"@/lib/state/actingUser\";\r\nimport { copyToClipboard } from \"@/lib/ui/copyToClipboard\";\r\nimport { Toast, type ToastKind } from \"@/components/Toast\";\r\nimport { V2Button } from \"@/components/v2/Button\";\r\nimport { V2Card, V2CardBody, V2CardHeader } from \"@/components/v2/Card\";\r\nimport { V2Input } from \"@/components/v2/Input\";\r\n\r\ntype User = {\r\n  id: string;\r\n  status: string;\r\n  kyc_level: string;\r\n  country: string | null;\r\n  created_at: string;\r\n};\r\n\r\ntype TradeRow = {\r\n  id: string;\r\n  buyer_user_id: string;\r\n  seller_user_id: string;\r\n  fiat_currency: string;\r\n  crypto_asset: string;\r\n  fiat_amount: string;\r\n  crypto_amount: string;\r\n  price: string;\r\n  reference_market_snapshot_id: string | null;\r\n  fair_price_mid: string | null;\r\n  fair_band_pct: string | null;\r\n  price_deviation_pct: string | null;\r\n  status: string;\r\n  created_at: string;\r\n};\r\n\r\ntype CreateTradeResponse =\r\n  | {\r\n      trade: {\r\n        id: string;\r\n      };\r\n      risk_assessment: unknown | null;\r\n    };\r\n\r\nexport function TradesClient({ initialTrades }: { initialTrades: TradeRow[] }) {\r\n  const router = useRouter();\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [trades, setTrades] = useState<TradeRow[]>(initialTrades);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<ClientApiError | null>(null);\r\n\r\n  const [authMode, setAuthMode] = useState<\"header\" | \"session\">(\"session\");\r\n  const [sessionUserId, setSessionUserId] = useState<string | null>(null);\r\n  const [sessionBootstrapKey, setSessionBootstrapKey] = useState<string>(\"\");\r\n  const [sessionLoading, setSessionLoading] = useState(false);\r\n\r\n  const [actingUserId, setActingUserId] = useState<string>(\"\");\r\n\r\n  const [toastMessage, setToastMessage] = useState<string | null>(null);\r\n  const [toastKind, setToastKind] = useState<ToastKind>(\"info\");\r\n\r\n  const [transitioningTradeId, setTransitioningTradeId] = useState<string | null>(null);\r\n\r\n  const roleBadgeFor = (trade: TradeRow) => {\r\n    if (!scopeUserId) return null;\r\n    const role =\r\n      scopeUserId === trade.buyer_user_id\r\n        ? \"buyer\"\r\n        : scopeUserId === trade.seller_user_id\r\n          ? \"seller\"\r\n          : null;\r\n    if (!role) return null;\r\n\r\n    const cls =\r\n      role === \"buyer\"\r\n        ? \"border-[color-mix(in_srgb,var(--up)_35%,var(--v2-border))] bg-[color-mix(in_srgb,var(--up)_10%,transparent)] text-[var(--up)]\"\r\n        : \"border-[color-mix(in_srgb,var(--v2-accent-2)_35%,var(--v2-border))] bg-[color-mix(in_srgb,var(--v2-accent-2)_10%,transparent)] text-[var(--v2-accent-2)]\";\r\n\r\n    return <span className={`rounded-full border px-2 py-0.5 text-[11px] font-semibold ${cls}`}>{role}</span>;\r\n  };\r\n\r\n  const actionTitle = (\r\n    trade: TradeRow,\r\n    opts: {\r\n      label: string;\r\n      to?: TradeStatus;\r\n      role?: \"buyer\" | \"seller\";\r\n      kind?: \"dispute\";\r\n    }\r\n  ): string => {\r\n    if (transitioningTradeId === trade.id) return \"Working…\";\r\n    if (!scopeUserId) return \"Select an acting user.\";\r\n\r\n    if (opts.kind === \"dispute\") {\r\n      return canOpenDispute(trade.status)\r\n        ? \"Open dispute (reason=non_payment)\"\r\n        : `Not allowed from status: ${trade.status}`;\r\n    }\r\n\r\n    if (opts.to) {\r\n      if (!canTransitionTrade(trade.status, opts.to)) {\r\n        return `Not allowed from status: ${trade.status}`;\r\n      }\r\n      if (opts.role === \"buyer\" && scopeUserId !== trade.buyer_user_id) {\r\n        return \"Buyer only.\";\r\n      }\r\n      if (opts.role === \"seller\" && scopeUserId !== trade.seller_user_id) {\r\n        return \"Seller only.\";\r\n      }\r\n      if (opts.to === \"canceled\" && trade.status === \"disputed\") {\r\n        return \"Use reviewer decision to cancel disputed trades.\";\r\n      }\r\n      return opts.label;\r\n    }\r\n\r\n    return opts.label;\r\n  };\r\n\r\n  const [buyerUserId, setBuyerUserId] = useState<string>(\"\");\r\n  const [sellerUserId, setSellerUserId] = useState<string>(\"\");\r\n\r\n  const [fiatCurrency, setFiatCurrency] = useState(\"USD\");\r\n  const [cryptoAsset, setCryptoAsset] = useState(\"BTC\");\r\n  const [fiatAmount, setFiatAmount] = useState(\"1000\");\r\n  const [cryptoAmount, setCryptoAmount] = useState(\"0.01\");\r\n  const [price, setPrice] = useState(\"100000\");\r\n\r\n  const [paymentMethodLabel, setPaymentMethodLabel] = useState(\"bank transfer\");\r\n  const [paymentMethodRiskClass, setPaymentMethodRiskClass] = useState<\r\n    \"irreversible\" | \"reversible\" | \"unknown\"\r\n  >(\"unknown\");\r\n\r\n  const [assessRisk, setAssessRisk] = useState(true);\r\n\r\n  const [useReferenceMarket, setUseReferenceMarket] = useState(true);\r\n  const [exchange, setExchange] = useState<\"binance\" | \"bybit\">(\"binance\");\r\n  const [symbol, setSymbol] = useState(\"BTCUSDT\");\r\n  const [persistSnapshot, setPersistSnapshot] = useState(true);\r\n  const [bandPct, setBandPct] = useState(\"0.01\");\r\n\r\n  const scopeUserId = useMemo(() => {\r\n    if (authMode === \"session\") return sessionUserId ?? actingUserId;\r\n    return actingUserId;\r\n  }, [authMode, sessionUserId, actingUserId]);\r\n\r\n  const canSubmit = useMemo(() => {\r\n    return Boolean(buyerUserId) && Boolean(sellerUserId) && buyerUserId !== sellerUserId;\r\n  }, [buyerUserId, sellerUserId]);\r\n\r\n  const proofPackHrefFor = (tradeId: string) => {\r\n    const base = `/api/trades/${tradeId}/proof-pack`;\r\n    return scopeUserId ? `${base}?user_id=${encodeURIComponent(scopeUserId)}` : base;\r\n  };\r\n\r\n  const tradeHrefFor = (tradeId: string) => {\r\n    const base = `/trades/${tradeId}`;\r\n    return scopeUserId ? `${base}?user_id=${encodeURIComponent(scopeUserId)}` : base;\r\n  };\r\n\r\n  async function refreshSession() {\r\n    try {\r\n      const me = await fetchWhoAmI();\r\n      setSessionUserId(me.user_id);\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        if (e.code === \"missing_x_user_id\") {\r\n          setSessionUserId(null);\r\n          return;\r\n        }\r\n      }\r\n      setSessionUserId(null);\r\n    }\r\n  }\r\n\r\n  async function signInAs(userId: string): Promise<boolean> {\r\n    if (!userId) return false;\r\n\r\n    setSessionLoading(true);\r\n    setError(null);\r\n    try {\r\n      await createSessionCookie({\r\n        userId,\r\n        bootstrapKey: sessionBootstrapKey ? sessionBootstrapKey : undefined,\r\n      });\r\n      await refreshSession();\r\n      setActingUserId(userId);\r\n      setToastKind(\"success\");\r\n      setToastMessage(\"Session cookie set.\");\r\n      return true;\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"session_failed\" });\r\n      }\r\n      return false;\r\n    } finally {\r\n      setSessionLoading(false);\r\n    }\r\n  }\r\n\r\n  async function signOut() {\r\n    setSessionLoading(true);\r\n    setError(null);\r\n    try {\r\n      await clearSessionCookie();\r\n      await refreshSession();\r\n      setToastKind(\"success\");\r\n      setToastMessage(\"Signed out.\");\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"signout_failed\" });\r\n      }\r\n    } finally {\r\n      setSessionLoading(false);\r\n    }\r\n  }\r\n\r\n  async function refreshTrades(forUserId?: string) {\r\n    try {\r\n      setError(null);\r\n      const scopedUserId =\r\n        forUserId ?? (authMode === \"session\" ? sessionUserId ?? actingUserId : actingUserId);\r\n      if (!scopedUserId) {\r\n        setTrades([]);\r\n        setError({ code: \"missing_acting_user_id\" });\r\n        return;\r\n      }\r\n\r\n      if (authMode === \"session\") {\r\n        const isProd = process.env.NODE_ENV === \"production\";\r\n        const canAutoBootstrap = !isProd || Boolean(sessionBootstrapKey);\r\n\r\n        if (sessionUserId !== scopedUserId) {\r\n          if (canAutoBootstrap && !sessionLoading) {\r\n            const ok = await signInAs(scopedUserId);\r\n            if (!ok) return;\r\n          } else if (sessionUserId) {\r\n            setTrades([]);\r\n            setError({ code: \"session_user_mismatch\" });\r\n            return;\r\n          }\r\n        }\r\n      }\r\n\r\n      const json = await fetchJsonOrThrow<{ trades?: TradeRow[] }>(\r\n        `/api/trades?user_id=${encodeURIComponent(scopedUserId)}`,\r\n        {\r\n          cache: \"no-store\",\r\n          headers: authMode === \"header\" ? { \"x-user-id\": scopedUserId } : undefined,\r\n        }\r\n      );\r\n      setTrades(json.trades ?? []);\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"refresh_failed\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  async function transitionTrade(tradeId: string, next: TradeStatus) {\r\n    const scopedUserId = authMode === \"session\" ? sessionUserId ?? actingUserId : actingUserId;\r\n    if (!scopedUserId) {\r\n      setError({ code: \"missing_acting_user_id\" });\r\n      return;\r\n    }\r\n\r\n    setTransitioningTradeId(tradeId);\r\n    setError(null);\r\n\r\n    try {\r\n      if (authMode === \"session\") {\r\n        const isProd = process.env.NODE_ENV === \"production\";\r\n        const canAutoBootstrap = !isProd || Boolean(sessionBootstrapKey);\r\n\r\n        if (sessionUserId !== scopedUserId) {\r\n          if (canAutoBootstrap && !sessionLoading) {\r\n            const ok = await signInAs(scopedUserId);\r\n            if (!ok) return;\r\n          } else if (sessionUserId) {\r\n            setError({ code: \"session_user_mismatch\" });\r\n            return;\r\n          }\r\n        }\r\n      }\r\n\r\n      const segment: Record<TradeStatus, string> = {\r\n        created: \"\",\r\n        awaiting_payment: \"awaiting-payment\",\r\n        paid_marked: \"paid-marked\",\r\n        released: \"released\",\r\n        disputed: \"\",\r\n        resolved: \"resolved\",\r\n        canceled: \"canceled\",\r\n      };\r\n\r\n      const path = segment[next];\r\n      if (!path) {\r\n        setError({ code: \"trade_transition_not_allowed\" });\r\n        return;\r\n      }\r\n\r\n      const init: RequestInit = { method: \"POST\" };\r\n      if (authMode === \"header\") {\r\n        init.headers = { \"x-user-id\": scopedUserId };\r\n      }\r\n\r\n      await fetchJsonOrThrow(`/api/trades/${tradeId}/status/${path}`, init);\r\n      setToastKind(\"success\");\r\n      setToastMessage(`Trade ${tradeId.slice(0, 8)}… moved to ${next}.`);\r\n      await refreshTrades(scopedUserId);\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"transition_failed\" });\r\n      }\r\n    } finally {\r\n      setTransitioningTradeId(null);\r\n    }\r\n  }\r\n\r\n  async function openDispute(tradeId: string) {\r\n    const scopedUserId = authMode === \"session\" ? sessionUserId ?? actingUserId : actingUserId;\r\n    if (!scopedUserId) {\r\n      setError({ code: \"missing_acting_user_id\" });\r\n      return;\r\n    }\r\n\r\n    setTransitioningTradeId(tradeId);\r\n    setError(null);\r\n\r\n    try {\r\n      if (authMode === \"session\") {\r\n        const isProd = process.env.NODE_ENV === \"production\";\r\n        const canAutoBootstrap = !isProd || Boolean(sessionBootstrapKey);\r\n\r\n        if (sessionUserId !== scopedUserId) {\r\n          if (canAutoBootstrap && !sessionLoading) {\r\n            const ok = await signInAs(scopedUserId);\r\n            if (!ok) return;\r\n          } else if (sessionUserId) {\r\n            setError({ code: \"session_user_mismatch\" });\r\n            return;\r\n          }\r\n        }\r\n      }\r\n\r\n      const init: RequestInit = {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          opened_by_user_id: scopedUserId,\r\n          reason_code: \"non_payment\",\r\n        }),\r\n      };\r\n\r\n      if (authMode === \"header\") {\r\n        init.headers = {\r\n          ...(init.headers ?? {}),\r\n          \"x-user-id\": scopedUserId,\r\n        };\r\n      }\r\n\r\n      await fetchJsonOrThrow(`/api/trades/${tradeId}/dispute`, init);\r\n      setToastKind(\"success\");\r\n      setToastMessage(`Dispute opened for ${tradeId.slice(0, 8)}…`);\r\n      await refreshTrades(scopedUserId);\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"open_dispute_failed\" });\r\n      }\r\n    } finally {\r\n      setTransitioningTradeId(null);\r\n    }\r\n  }\r\n\r\n  async function refreshUsers() {\r\n    try {\r\n      const json = await fetchJsonOrThrow<{ users?: User[] }>(\"/api/dev/users\", {\r\n        cache: \"no-store\",\r\n      });\r\n      const list = json.users ?? [];\r\n      setUsers(list);\r\n\r\n      const first = list[0]?.id ?? \"\";\r\n      const second = list[1]?.id ?? first;\r\n      setBuyerUserId((prev) => (prev ? prev : first));\r\n      setSellerUserId((prev) => (prev ? prev : second));\r\n\r\n      const preferred = readActingUserIdPreference();\r\n      const fallback = preferred || first;\r\n      setActingUserId((prev) => (prev ? prev : fallback));\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"users_failed\" });\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    void refreshUsers();\r\n    void refreshSession();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!actingUserId) return;\r\n    persistActingUserIdPreference(actingUserId);\r\n    void refreshTrades(actingUserId);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [actingUserId]);\r\n\r\n  async function createDevUser() {\r\n    setError(null);\r\n    setLoading(true);\r\n    try {\r\n      await fetchJsonOrThrow(\"/api/dev/users\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ status: \"active\", kyc_level: \"basic\", country: \"US\" }),\r\n      });\r\n      await refreshUsers();\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"create_user_failed\" });\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function createTrade() {\r\n    if (!canSubmit) {\r\n      setError({ code: \"missing_or_invalid_users\" });\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (authMode === \"session\" && buyerUserId) {\r\n        if (sessionUserId !== buyerUserId) {\r\n          const ok = await signInAs(buyerUserId);\r\n          if (!ok) return;\r\n        }\r\n      }\r\n\r\n      const body: Record<string, unknown> = {\r\n        buyer_user_id: buyerUserId,\r\n        seller_user_id: sellerUserId,\r\n        fiat_currency: fiatCurrency,\r\n        crypto_asset: cryptoAsset,\r\n        fiat_amount: fiatAmount,\r\n        crypto_amount: cryptoAmount,\r\n        price,\r\n        payment_method_label: paymentMethodLabel,\r\n        payment_method_risk_class: paymentMethodRiskClass,\r\n        assess_risk: assessRisk,\r\n      };\r\n\r\n      if (useReferenceMarket) {\r\n        body.reference_market = {\r\n          exchange,\r\n          symbol,\r\n          persist: persistSnapshot,\r\n          pct: bandPct,\r\n        };\r\n      }\r\n\r\n      const json = await fetchJsonOrThrow<CreateTradeResponse>(\"/api/trades\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          ...(authMode === \"header\" ? { \"x-user-id\": buyerUserId } : {}),\r\n        },\r\n        body: JSON.stringify(body),\r\n      });\r\n\r\n      const createdId = json.trade.id;\r\n      setActingUserId(buyerUserId);\r\n      await refreshTrades(buyerUserId);\r\n      router.push(`/trades/${createdId}?user_id=${encodeURIComponent(buyerUserId)}`);\r\n      router.refresh();\r\n    } catch (e) {\r\n      if (e instanceof ApiError) {\r\n        setError({ code: e.code, details: e.details });\r\n      } else {\r\n        setError({ code: e instanceof Error ? e.message : \"create_trade_failed\" });\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"mt-6 grid gap-6\">\r\n      <Toast\r\n        message={toastMessage}\r\n        kind={toastKind}\r\n        onDone={() => setToastMessage(null)}\r\n      />\r\n      <ApiErrorBanner error={error} />\r\n\r\n      <V2Card>\r\n        <V2CardHeader\r\n          title=\"Create trade\"\r\n          right={\r\n            <V2Button variant=\"ghost\" size=\"sm\" onClick={() => void refreshTrades()}>\r\n              Refresh trades\r\n            </V2Button>\r\n          }\r\n        />\r\n        <V2CardBody>\r\n          <div className=\"grid gap-1\">\r\n            <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Acting user (scopes trade list)</span>\r\n            <select\r\n              className=\"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 font-mono text-[12px] text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n            value={actingUserId}\r\n            onChange={(e) => {\r\n              const next = e.target.value;\r\n\r\n              if (authMode !== \"session\") {\r\n                setActingUserId(next);\r\n                return;\r\n              }\r\n\r\n              const prev = actingUserId;\r\n              setActingUserId(next);\r\n\r\n              const isProd = process.env.NODE_ENV === \"production\";\r\n              const canAutoBootstrap = !isProd || Boolean(sessionBootstrapKey);\r\n              if (!canAutoBootstrap) return;\r\n\r\n              if (!next) return;\r\n              if (sessionUserId === next) return;\r\n\r\n              void (async () => {\r\n                const ok = await signInAs(next);\r\n                if (!ok) setActingUserId(prev);\r\n              })();\r\n            }}\r\n          >\r\n            <option value=\"\">(select user)</option>\r\n            {users.map((u) => (\r\n              <option key={u.id} value={u.id}>\r\n                {u.id}\r\n              </option>\r\n            ))}\r\n          </select>\r\n\r\n            <div className=\"mt-2 flex flex-wrap items-center gap-3\">\r\n              <label className=\"flex items-center gap-2 text-[12px] text-[var(--v2-muted)]\">\r\n                <span className=\"font-semibold\">Auth mode</span>\r\n                <select\r\n                  className=\"h-9 rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 text-[12px] font-semibold text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n                value={authMode}\r\n                onChange={(e) => {\r\n                  const next = e.target.value as typeof authMode;\r\n                  setAuthMode(next);\r\n\r\n                  if (next !== \"session\") return;\r\n                  if (!actingUserId) return;\r\n                  if (sessionUserId === actingUserId) return;\r\n\r\n                  const isProd = process.env.NODE_ENV === \"production\";\r\n                  const canAutoBootstrap = !isProd || Boolean(sessionBootstrapKey);\r\n                  if (!canAutoBootstrap) return;\r\n\r\n                  void signInAs(actingUserId);\r\n                }}\r\n              >\r\n                <option value=\"session\">session cookie</option>\r\n                <option value=\"header\">x-user-id header</option>\r\n              </select>\r\n            </label>\r\n\r\n            {authMode === \"session\" ? (\r\n              <div className=\"flex flex-wrap items-center gap-2 text-[12px] text-[var(--v2-muted)]\">\r\n                <span className=\"font-semibold\">Session</span>\r\n                <span className=\"font-mono\">\r\n                  {sessionUserId ? `${sessionUserId.slice(0, 8)}…` : \"(none)\"}\r\n                </span>\r\n                <V2Button\r\n                  size=\"sm\"\r\n                  variant=\"secondary\"\r\n                  disabled={!actingUserId || sessionLoading}\r\n                  onClick={() => void signInAs(actingUserId)}\r\n                >\r\n                  Sign in\r\n                </V2Button>\r\n                <V2Button\r\n                  size=\"sm\"\r\n                  variant=\"secondary\"\r\n                  disabled={sessionLoading}\r\n                  onClick={() => void signOut()}\r\n                >\r\n                  Sign out\r\n                </V2Button>\r\n                <details>\r\n                  <summary className=\"cursor-pointer text-[11px] font-semibold text-[var(--v2-muted)]\">prod bootstrap</summary>\r\n                  <div className=\"mt-2 grid gap-1\">\r\n                    <label className=\"grid gap-1\">\r\n                      <span className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">x-session-bootstrap-key</span>\r\n                      <V2Input\r\n                        className=\"h-10 font-mono text-[12px]\"\r\n                        value={sessionBootstrapKey}\r\n                        type=\"password\"\r\n                        placeholder=\"(only needed in production)\"\r\n                        onChange={(e) => setSessionBootstrapKey(e.target.value)}\r\n                      />\r\n                    </label>\r\n                  </div>\r\n                </details>\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-[12px] text-[var(--v2-muted)]\">Requests send x-user-id.</div>\r\n            )}\r\n          </div>\r\n\r\n          </div>\r\n\r\n          <div className=\"mt-4 grid gap-3\">\r\n            <div className=\"flex flex-wrap items-center gap-3\">\r\n              <V2Button\r\n                variant=\"secondary\"\r\n              disabled={loading}\r\n              onClick={() => void createDevUser()}\r\n            >\r\n              + Dev user\r\n              </V2Button>\r\n              <div className=\"text-[13px] text-[var(--v2-muted)]\">Need users? Create two, then submit.</div>\r\n            </div>\r\n\r\n            <div className=\"grid gap-3 md:grid-cols-2\">\r\n              <label className=\"grid gap-1\">\r\n                <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Buyer</span>\r\n                <select\r\n                  className=\"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 font-mono text-[12px] text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n                value={buyerUserId}\r\n                onChange={(e) => setBuyerUserId(e.target.value)}\r\n              >\r\n                {users.map((u) => (\r\n                  <option key={u.id} value={u.id}>\r\n                    {u.id}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </label>\r\n\r\n              <label className=\"grid gap-1\">\r\n                <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Seller</span>\r\n                <select\r\n                  className=\"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 font-mono text-[12px] text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n                value={sellerUserId}\r\n                onChange={(e) => setSellerUserId(e.target.value)}\r\n              >\r\n                {users.map((u) => (\r\n                  <option key={u.id} value={u.id}>\r\n                    {u.id}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"grid gap-3 md:grid-cols-3\">\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Fiat</span>\r\n              <V2Input\r\n                className=\"font-mono\"\r\n                value={fiatCurrency}\r\n                onChange={(e) => setFiatCurrency(e.target.value)}\r\n              />\r\n            </label>\r\n\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Asset</span>\r\n              <V2Input\r\n                className=\"font-mono\"\r\n                value={cryptoAsset}\r\n                onChange={(e) => setCryptoAsset(e.target.value)}\r\n              />\r\n            </label>\r\n\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Price</span>\r\n              <V2Input\r\n                className=\"font-mono\"\r\n                value={price}\r\n                onChange={(e) => setPrice(e.target.value)}\r\n              />\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"grid gap-3 md:grid-cols-2\">\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Fiat amount</span>\r\n              <V2Input\r\n                className=\"font-mono\"\r\n                value={fiatAmount}\r\n                onChange={(e) => setFiatAmount(e.target.value)}\r\n              />\r\n            </label>\r\n\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Crypto amount</span>\r\n              <V2Input\r\n                className=\"font-mono\"\r\n                value={cryptoAmount}\r\n                onChange={(e) => setCryptoAmount(e.target.value)}\r\n              />\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"grid gap-3 md:grid-cols-2\">\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Payment label</span>\r\n              <V2Input\r\n                value={paymentMethodLabel}\r\n                onChange={(e) => setPaymentMethodLabel(e.target.value)}\r\n              />\r\n            </label>\r\n\r\n            <label className=\"grid gap-1\">\r\n              <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Payment risk</span>\r\n              <select\r\n                className=\"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 text-[14px] font-semibold text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n                value={paymentMethodRiskClass}\r\n                onChange={(e) =>\r\n                  setPaymentMethodRiskClass(e.target.value as typeof paymentMethodRiskClass)\r\n                }\r\n              >\r\n                <option value=\"unknown\">unknown</option>\r\n                <option value=\"irreversible\">irreversible</option>\r\n                <option value=\"reversible\">reversible</option>\r\n              </select>\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"flex flex-wrap items-center gap-4 text-[13px] text-[var(--v2-text)]\">\r\n            <label className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={assessRisk}\r\n                onChange={(e) => setAssessRisk(e.target.checked)}\r\n                className=\"accent-[var(--v2-accent)]\"\r\n              />\r\n              Assess risk (v0)\r\n            </label>\r\n\r\n            <label className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={useReferenceMarket}\r\n                onChange={(e) => setUseReferenceMarket(e.target.checked)}\r\n                className=\"accent-[var(--v2-accent)]\"\r\n              />\r\n              Attach reference market\r\n            </label>\r\n          </div>\r\n\r\n          {useReferenceMarket ? (\r\n            <div className=\"grid gap-3 md:grid-cols-4\">\r\n              <label className=\"grid gap-1\">\r\n                <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Exchange</span>\r\n                <select\r\n                  className=\"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 text-[14px] font-semibold text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none focus:ring-2 focus:ring-[var(--v2-ring)]\"\r\n                  value={exchange}\r\n                  onChange={(e) => setExchange(e.target.value as typeof exchange)}\r\n                >\r\n                  <option value=\"binance\">binance</option>\r\n                  <option value=\"bybit\">bybit</option>\r\n                </select>\r\n              </label>\r\n\r\n              <label className=\"grid gap-1 md:col-span-2\">\r\n                <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Symbol</span>\r\n                <V2Input\r\n                  className=\"font-mono\"\r\n                  value={symbol}\r\n                  onChange={(e) => setSymbol(e.target.value)}\r\n                />\r\n              </label>\r\n\r\n              <label className=\"grid gap-1\">\r\n                <span className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Band pct</span>\r\n                <V2Input\r\n                  className=\"font-mono\"\r\n                  value={bandPct}\r\n                  onChange={(e) => setBandPct(e.target.value)}\r\n                />\r\n              </label>\r\n\r\n              <label className=\"flex items-center gap-2 text-[13px] text-[var(--v2-text)] md:col-span-4\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={persistSnapshot}\r\n                  onChange={(e) => setPersistSnapshot(e.target.checked)}\r\n                  className=\"accent-[var(--v2-accent)]\"\r\n                />\r\n                Persist snapshot to DB\r\n              </label>\r\n            </div>\r\n          ) : null}\r\n\r\n          <V2Button\r\n            variant=\"primary\"\r\n            disabled={loading || !canSubmit}\r\n            onClick={() => void createTrade()}\r\n          >\r\n            {loading ? \"Working…\" : \"Create trade\"}\r\n          </V2Button>\r\n\r\n          {!canSubmit ? (\r\n            <div className=\"text-[13px] text-[var(--v2-muted)]\">Select two different users to submit.</div>\r\n          ) : null}\r\n          </div>\r\n        </V2CardBody>\r\n      </V2Card>\r\n\r\n      <V2Card>\r\n        <V2CardHeader title=\"Recent trades\" right={<Link className=\"text-[13px] font-semibold text-[var(--v2-accent-2)] underline\" href=\"/\">Home</Link>} />\r\n        <V2CardBody>\r\n          <div className=\"overflow-x-auto rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)]\">\r\n            <table className=\"w-full text-[13px]\">\r\n              <thead className=\"bg-[var(--v2-surface-2)] text-left text-[var(--v2-muted)]\">\r\n              <tr>\r\n                <th className=\"px-3 py-2\">ID</th>\r\n                <th className=\"px-3 py-2\">Pair</th>\r\n                <th className=\"px-3 py-2\">Price</th>\r\n                <th className=\"px-3 py-2\">Deviation</th>\r\n                <th className=\"px-3 py-2\">Status</th>\r\n                <th className=\"px-3 py-2\">Actions</th>\r\n                <th className=\"px-3 py-2\">Created</th>\r\n                <th className=\"px-3 py-2\">Proof pack</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {trades.map((t) => (\r\n                <tr\r\n                  key={t.id}\r\n                  className=\"border-t border-[var(--v2-border)]\"\r\n                >\r\n                  <td className=\"px-3 py-2 font-mono\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Link className=\"font-semibold text-[var(--v2-accent-2)] underline\" href={tradeHrefFor(t.id)}>\r\n                        {t.id.slice(0, 8)}…\r\n                      </Link>\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        onClick={async () => {\r\n                          try {\r\n                            const relative = tradeHrefFor(t.id);\r\n                            const absolute = new URL(relative, window.location.origin).toString();\r\n                            const ok = await copyToClipboard(absolute);\r\n                            setToastKind(ok ? \"success\" : \"error\");\r\n                            setToastMessage(ok ? \"Trade link copied.\" : \"Copy failed.\");\r\n                          } catch {\r\n                            setToastKind(\"error\");\r\n                            setToastMessage(\"Copy failed.\");\r\n                          }\r\n                        }}\r\n                      >\r\n                        Copy\r\n                      </V2Button>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-3 py-2\">\r\n                    {t.crypto_asset}/{t.fiat_currency}\r\n                  </td>\r\n                  <td className=\"px-3 py-2 font-mono\">{t.price}</td>\r\n                  <td className=\"px-3 py-2 font-mono\">\r\n                    {t.price_deviation_pct ?? \"—\"}\r\n                  </td>\r\n                  <td className=\"px-3 py-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <span className=\"font-semibold text-[var(--v2-text)]\">{t.status}</span>\r\n                      {roleBadgeFor(t)}\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-3 py-2\">\r\n                    <div className=\"flex flex-wrap items-center gap-2\">\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          !canTransitionTrade(t.status, \"awaiting_payment\")\r\n                        }\r\n                        onClick={() => void transitionTrade(t.id, \"awaiting_payment\")}\r\n                        title={actionTitle(t, {\r\n                          label: \"created → awaiting_payment\",\r\n                          to: \"awaiting_payment\",\r\n                        })}\r\n                      >\r\n                        Awaiting\r\n                      </V2Button>\r\n\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          !canTransitionTrade(t.status, \"paid_marked\") ||\r\n                          scopeUserId !== t.buyer_user_id\r\n                        }\r\n                        onClick={() => void transitionTrade(t.id, \"paid_marked\")}\r\n                        title={actionTitle(t, {\r\n                          label: \"awaiting_payment → paid_marked\",\r\n                          to: \"paid_marked\",\r\n                          role: \"buyer\",\r\n                        })}\r\n                      >\r\n                        Paid\r\n                      </V2Button>\r\n\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          !canTransitionTrade(t.status, \"released\") ||\r\n                          scopeUserId !== t.seller_user_id\r\n                        }\r\n                        onClick={() => void transitionTrade(t.id, \"released\")}\r\n                        title={actionTitle(t, {\r\n                          label: \"paid_marked → released\",\r\n                          to: \"released\",\r\n                          role: \"seller\",\r\n                        })}\r\n                      >\r\n                        Release\r\n                      </V2Button>\r\n\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          !canTransitionTrade(t.status, \"resolved\")\r\n                        }\r\n                        onClick={() => void transitionTrade(t.id, \"resolved\")}\r\n                        title={actionTitle(t, { label: \"Resolve trade\", to: \"resolved\" })}\r\n                      >\r\n                        Resolve\r\n                      </V2Button>\r\n\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"danger\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          t.status === \"disputed\" ||\r\n                          !canTransitionTrade(t.status, \"canceled\")\r\n                        }\r\n                        onClick={() => void transitionTrade(t.id, \"canceled\")}\r\n                        title={actionTitle(t, { label: \"Cancel trade\", to: \"canceled\" })}\r\n                      >\r\n                        Cancel\r\n                      </V2Button>\r\n\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        disabled={\r\n                          transitioningTradeId === t.id ||\r\n                          !scopeUserId ||\r\n                          !canOpenDispute(t.status)\r\n                        }\r\n                        onClick={() => void openDispute(t.id)}\r\n                        title={actionTitle(t, { label: \"Open dispute\", kind: \"dispute\" })}\r\n                      >\r\n                        Dispute\r\n                      </V2Button>\r\n                    </div>\r\n                  </td>\r\n\r\n                  <td className=\"px-3 py-2 font-mono\">{t.created_at}</td>\r\n                  <td className=\"px-3 py-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <a className=\"text-[12px] font-semibold text-[var(--v2-accent-2)] underline\" href={proofPackHrefFor(t.id)}>\r\n                        ZIP\r\n                      </a>\r\n                      <V2Button\r\n                        size=\"sm\"\r\n                        variant=\"secondary\"\r\n                        onClick={async () => {\r\n                          try {\r\n                            const href = proofPackHrefFor(t.id);\r\n                            const absolute = new URL(href, window.location.origin).toString();\r\n                            const ok = await copyToClipboard(absolute);\r\n                            if (ok) {\r\n                              setToastKind(\"success\");\r\n                              setToastMessage(\"Proof pack link copied.\");\r\n                            } else {\r\n                              setToastKind(\"error\");\r\n                              setToastMessage(\"Copy failed.\");\r\n                            }\r\n                          } catch {\r\n                            setToastKind(\"error\");\r\n                            setToastMessage(\"Copy failed.\");\r\n                          }\r\n                        }}\r\n                      >\r\n                        Copy link\r\n                      </V2Button>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n              {trades.length === 0 ? (\r\n                <tr>\r\n                  <td className=\"px-3 py-4 text-[13px] text-[var(--v2-muted)]\" colSpan={8}>\r\n                    No trades yet.\r\n                  </td>\r\n                </tr>\r\n              ) : null}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        </V2CardBody>\r\n      </V2Card>\r\n\r\n      <section className=\"text-[12px] text-[var(--v2-muted)]\">\r\n        <div>Pro tip: after creating a trade, open it and upload evidence, then download the Proof Pack ZIP.</div>\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}