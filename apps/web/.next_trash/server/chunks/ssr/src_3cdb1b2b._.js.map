{"version":3,"sources":["../../../../src/components/v2/Button.tsx","../../../../src/components/v2/Card.tsx","../../../../src/components/v2/Skeleton.tsx","../../../../src/components/v2/Tabs.tsx","../../../../src/app/v2/orders/OrdersClient.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nexport type V2ButtonVariant = \"primary\" | \"secondary\" | \"ghost\" | \"danger\";\r\nexport type V2ButtonSize = \"sm\" | \"md\" | \"lg\";\r\n\r\nexport function v2ButtonClassName(options?: {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n}): string {\r\n  const variant: V2ButtonVariant = options?.variant ?? \"secondary\";\r\n  const size: V2ButtonSize = options?.size ?? \"md\";\r\n\r\n  const base =\r\n    \"inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55\";\r\n\r\n  const sizeClass =\r\n    size === \"lg\" ? \"h-12 px-5 text-[15px]\" : size === \"sm\" ? \"h-9 px-3 text-[13px]\" : \"h-11 px-4 text-[14px]\";\r\n\r\n  const variantClass =\r\n    variant === \"primary\"\r\n      ? \"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n      : variant === \"danger\"\r\n        ? \"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n        : variant === \"ghost\"\r\n          ? \"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]\"\r\n          : \"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]\";\r\n\r\n  const widthClass = options?.fullWidth ? \"w-full\" : \"\";\r\n  const extra = options?.className ?? \"\";\r\n\r\n  return [base, sizeClass, variantClass, widthClass, extra].filter(Boolean).join(\" \");\r\n}\r\n\r\nexport type V2ButtonProps = Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, \"className\"> & {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n};\r\n\r\nexport const V2Button = React.forwardRef<HTMLButtonElement, V2ButtonProps>(function V2Button(\r\n  { variant, size, fullWidth, className, type, ...props },\r\n  ref,\r\n) {\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      type={type ?? \"button\"}\r\n      className={v2ButtonClassName({ variant, size, fullWidth, className })}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n","import type { ReactNode } from \"react\";\r\n\r\nexport function V2Card({\r\n  children,\r\n  className = \"\",\r\n}: {\r\n  children: ReactNode;\r\n  className?: string;\r\n}) {\r\n  return (\r\n    <section\r\n      className={\r\n        \"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] \" +\r\n        className\r\n      }\r\n    >\r\n      {children}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport function V2CardHeader({\r\n  title,\r\n  subtitle,\r\n  right,\r\n}: {\r\n  title: ReactNode;\r\n  subtitle?: ReactNode;\r\n  right?: ReactNode;\r\n}) {\r\n  return (\r\n    <header className=\"flex items-start justify-between gap-3 px-4 pt-4\">\r\n      <div className=\"min-w-0\">\r\n        <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{title}</div>\r\n        {subtitle ? <div className=\"mt-0.5 text-[13px] text-[var(--v2-muted)]\">{subtitle}</div> : null}\r\n      </div>\r\n      {right ? <div className=\"shrink-0\">{right}</div> : null}\r\n    </header>\r\n  );\r\n}\r\n\r\nexport function V2CardBody({ children }: { children: ReactNode }) {\r\n  return <div className=\"px-4 pb-4 pt-3\">{children}</div>;\r\n}\r\n","export function V2Skeleton({ className = \"\" }: { className?: string }) {\r\n  return (\r\n    <div\r\n      className={\r\n        \"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] \" + className\r\n      }\r\n      aria-hidden=\"true\"\r\n    />\r\n  );\r\n}\r\n","\"use client\";\r\n\r\ntype Tab = { id: string; label: string };\r\n\r\nexport function V2Tabs({\r\n  tabs,\r\n  activeId,\r\n  onChange,\r\n}: {\r\n  tabs: Tab[];\r\n  activeId: string;\r\n  onChange: (id: string) => void;\r\n}) {\r\n  return (\r\n    <div\r\n      className=\"grid gap-1 rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] p-1 shadow-[var(--v2-shadow-sm)]\"\r\n      style={{ gridTemplateColumns: `repeat(${Math.max(1, tabs.length)}, minmax(0, 1fr))` }}\r\n      role=\"tablist\"\r\n    >\r\n      {tabs.map((t) => {\r\n        const active = t.id === activeId;\r\n        return (\r\n          <button\r\n            key={t.id}\r\n            type=\"button\"\r\n            role=\"tab\"\r\n            aria-selected={active}\r\n            className={\r\n              \"h-10 rounded-xl text-[13px] font-semibold transition \" +\r\n              (active\r\n                ? \"bg-[var(--v2-surface-2)] text-[var(--v2-text)]\"\r\n                : \"text-[var(--v2-muted)] hover:bg-[var(--v2-surface-2)]/70\")\r\n            }\r\n            onClick={() => onChange(t.id)}\r\n          >\r\n            {t.label}\r\n          </button>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\";\r\n\r\nimport { V2Button } from \"@/components/v2/Button\";\r\nimport { V2Card, V2CardBody, V2CardHeader } from \"@/components/v2/Card\";\r\nimport { V2Skeleton } from \"@/components/v2/Skeleton\";\r\nimport { V2Tabs } from \"@/components/v2/Tabs\";\r\n\r\ntype OrderRow = {\r\n  id: string;\r\n  market_id: string;\r\n  market_symbol?: string;\r\n  side: \"buy\" | \"sell\";\r\n  type: \"limit\" | \"market\";\r\n  price: string;\r\n  quantity: string;\r\n  remaining_quantity: string;\r\n  status: string;\r\n  created_at: string;\r\n  updated_at: string;\r\n  fills?: Array<{ id: string; price: string; quantity: string; created_at: string }>;\r\n};\r\n\r\ntype OpenOrdersResponse = { orders: OrderRow[] };\r\n\r\ntype HistoryResponse = { orders: OrderRow[] };\r\n\r\nfunction fmtNum(v: string | null | undefined): string {\r\n  const n = Number(String(v ?? \"\"));\r\n  if (!Number.isFinite(n)) return \"—\";\r\n  if (n === 0) return \"0\";\r\n  const abs = Math.abs(n);\r\n  const decimals = abs >= 1000 ? 2 : abs >= 1 ? 4 : abs >= 0.01 ? 6 : 8;\r\n  return n.toLocaleString(undefined, { maximumFractionDigits: decimals });\r\n}\r\n\r\nfunction fmtTime(ts: string | null | undefined): string {\r\n  if (!ts) return \"\";\r\n  try {\r\n    return new Date(ts).toLocaleString();\r\n  } catch {\r\n    return String(ts);\r\n  }\r\n}\r\n\r\nexport function OrdersClient() {\r\n  const [tab, setTab] = useState<\"open\" | \"history\" | \"fills\">(\"open\");\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [openOrders, setOpenOrders] = useState<OrderRow[]>([]);\r\n  const [history, setHistory] = useState<OrderRow[]>([]);\r\n\r\n  const [cancelingId, setCancelingId] = useState<string | null>(null);\r\n\r\n  const esRef = useRef<EventSource | null>(null);\r\n  const lastRefreshAtRef = useRef<number>(0);\r\n  const hasLoadedRef = useRef(false);\r\n  const loadSeqRef = useRef(0);\r\n  const abortRef = useRef<AbortController | null>(null);\r\n\r\n  const tabs = useMemo(\r\n    () => [\r\n      { id: \"open\", label: \"Open\" },\r\n      { id: \"history\", label: \"History\" },\r\n      { id: \"fills\", label: \"Fills\" },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const load = async () => {\r\n    const seq = ++loadSeqRef.current;\r\n    abortRef.current?.abort();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    // Only show skeletons for the very first load.\r\n    if (!hasLoadedRef.current) setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const [openRes, histRes] = await Promise.all([\r\n        fetch(\"/api/exchange/orders\", { cache: \"no-store\", credentials: \"include\", signal: controller.signal }),\r\n        fetch(\"/api/exchange/orders/history?status=all&limit=200\", { cache: \"no-store\", credentials: \"include\", signal: controller.signal }),\r\n      ]);\r\n\r\n      const openJson = (await openRes.json().catch(() => null)) as OpenOrdersResponse | null;\r\n      const histJson = (await histRes.json().catch(() => null)) as HistoryResponse | null;\r\n\r\n      if (!openRes.ok) throw new Error(typeof (openJson as any)?.error === \"string\" ? (openJson as any).error : `http_${openRes.status}`);\r\n      if (!histRes.ok) throw new Error(typeof (histJson as any)?.error === \"string\" ? (histJson as any).error : `http_${histRes.status}`);\r\n\r\n      if (seq !== loadSeqRef.current) return;\r\n      setOpenOrders(Array.isArray(openJson?.orders) ? openJson!.orders : []);\r\n      setHistory(Array.isArray(histJson?.orders) ? histJson!.orders : []);\r\n    } catch (e) {\r\n      if (e instanceof DOMException && e.name === \"AbortError\") return;\r\n      if (seq !== loadSeqRef.current) return;\r\n      // If we already have content, keep it visible and ignore transient refresh errors.\r\n      if (!hasLoadedRef.current) setError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      if (seq === loadSeqRef.current) {\r\n        setLoading(false);\r\n        hasLoadedRef.current = true;\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    void load();\r\n    const tick = () => {\r\n      if (document.visibilityState !== \"visible\") return;\r\n      void load();\r\n    };\r\n    const id = window.setInterval(tick, 12_000);\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") void load();\r\n    };\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    return () => {\r\n      window.clearInterval(id);\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  // Realtime: listen for notification events and refresh Orders immediately.\r\n  useEffect(() => {\r\n    const stop = () => {\r\n      try {\r\n        esRef.current?.close();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      esRef.current = null;\r\n    };\r\n\r\n    const shouldRefreshForType = (t: string) => {\r\n      const type = String(t || \"\");\r\n      return type === \"order_placed\"\r\n        || type === \"order_filled\"\r\n        || type === \"order_partially_filled\"\r\n        || type === \"order_canceled\"\r\n        || type === \"order_rejected\";\r\n    };\r\n\r\n    const refreshSoon = () => {\r\n      const now = Date.now();\r\n      if (now - lastRefreshAtRef.current < 800) return;\r\n      lastRefreshAtRef.current = now;\r\n      if (document.visibilityState !== \"visible\") return;\r\n      void load();\r\n    };\r\n\r\n    const start = () => {\r\n      if (document.visibilityState !== \"visible\") return;\r\n      if (typeof EventSource === \"undefined\") return;\r\n      if (esRef.current) return;\r\n      try {\r\n        const es = new EventSource(\"/api/notifications/stream\", { withCredentials: true } as any);\r\n        es.addEventListener(\"notification\", (evt) => {\r\n          try {\r\n            const data = JSON.parse(String((evt as MessageEvent).data ?? \"{}\"));\r\n            if (shouldRefreshForType(String(data?.type ?? \"\"))) refreshSoon();\r\n          } catch {\r\n            // ignore\r\n          }\r\n        });\r\n        es.addEventListener(\"ready\", () => refreshSoon());\r\n        es.onerror = () => {\r\n          // allow browser to retry automatically\r\n        };\r\n        esRef.current = es;\r\n      } catch {\r\n        stop();\r\n      }\r\n    };\r\n\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") start();\r\n      else stop();\r\n    };\r\n\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    start();\r\n    return () => {\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n      stop();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const fills = useMemo(() => {\r\n    const out: Array<{ order: OrderRow; fill: any }> = [];\r\n    for (const o of history) {\r\n      const fs = Array.isArray(o.fills) ? o.fills : [];\r\n      for (const f of fs) out.push({ order: o, fill: f });\r\n    }\r\n    out.sort((a, b) => {\r\n      const at = a.fill?.created_at ? Date.parse(String(a.fill.created_at)) : 0;\r\n      const bt = b.fill?.created_at ? Date.parse(String(b.fill.created_at)) : 0;\r\n      return bt - at;\r\n    });\r\n    return out.slice(0, 200);\r\n  }, [history]);\r\n\r\n  const cancelOrder = async (id: string) => {\r\n    if (!id || cancelingId) return;\r\n    setCancelingId(id);\r\n    setError(null);\r\n\r\n    // Optimistic: hide the canceled order immediately.\r\n    const prev = openOrders;\r\n    setOpenOrders((rows) => rows.filter((o) => o.id !== id));\r\n\r\n    try {\r\n      const res = await fetch(`/api/exchange/orders/${encodeURIComponent(id)}/cancel`, {\r\n        method: \"POST\",\r\n        credentials: \"include\",\r\n      });\r\n      const json = await res.json().catch(() => null) as any;\r\n      if (!res.ok) {\r\n        // rollback\r\n        setOpenOrders(prev);\r\n        throw new Error(typeof json?.error === \"string\" ? json.error : `http_${res.status}`);\r\n      }\r\n\r\n      // Refresh history so status updates appear.\r\n      void load();\r\n    } catch (e) {\r\n      setError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setCancelingId(null);\r\n    }\r\n  };\r\n\r\n  const renderOrderRow = (o: OrderRow, showCancel: boolean) => {\r\n    const sideColor = o.side === \"buy\" ? \"text-[var(--up)]\" : \"text-[var(--down)]\";\r\n    const status = String(o.status ?? \"\").toLowerCase();\r\n\r\n    return (\r\n      <div key={o.id} className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]\">\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <div className=\"min-w-0\">\r\n            <div className=\"flex flex-wrap items-center gap-2\">\r\n              <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{String(o.market_symbol ?? \"—\")}</div>\r\n              <span className={`text-[12px] font-semibold ${sideColor}`}>{o.side.toUpperCase()}</span>\r\n              <span className=\"rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold text-[var(--v2-muted)]\">\r\n                {o.type.toUpperCase()}\r\n              </span>\r\n              <span className=\"rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold text-[var(--v2-muted)]\">\r\n                {status.replaceAll(\"_\", \" \")}\r\n              </span>\r\n            </div>\r\n            <div className=\"mt-1 text-[12px] text-[var(--v2-muted)]\">{fmtTime(o.created_at)}</div>\r\n          </div>\r\n\r\n          {showCancel ? (\r\n            <V2Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              disabled={cancelingId === o.id}\r\n              onClick={() => void cancelOrder(o.id)}\r\n              className=\"border border-[var(--v2-border)]\"\r\n            >\r\n              {cancelingId === o.id ? \"Canceling…\" : \"Cancel\"}\r\n            </V2Button>\r\n          ) : null}\r\n        </div>\r\n\r\n        <div className=\"mt-3 grid grid-cols-3 gap-2 text-[12px]\">\r\n          <div className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n            <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">Price</div>\r\n            <div className=\"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]\">{o.type === \"market\" ? \"MKT\" : fmtNum(o.price)}</div>\r\n          </div>\r\n          <div className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n            <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">Qty</div>\r\n            <div className=\"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]\">{fmtNum(o.quantity)}</div>\r\n          </div>\r\n          <div className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n            <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">Remaining</div>\r\n            <div className=\"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]\">{fmtNum(o.remaining_quantity)}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const content = () => {\r\n    if (error) {\r\n      return (\r\n        <V2Card>\r\n          <V2CardHeader title=\"Orders unavailable\" subtitle=\"Sign in and try again.\" />\r\n          <V2CardBody>\r\n            <div className=\"text-sm text-[var(--v2-muted)]\">{String(error)}</div>\r\n            <div className=\"mt-3\">\r\n              <V2Button variant=\"primary\" fullWidth onClick={() => void load()}>\r\n                Retry\r\n              </V2Button>\r\n            </div>\r\n          </V2CardBody>\r\n        </V2Card>\r\n      );\r\n    }\r\n\r\n    if (loading) {\r\n      return (\r\n        <div className=\"grid gap-2\">\r\n          <V2Skeleton className=\"h-20\" />\r\n          <V2Skeleton className=\"h-20\" />\r\n          <V2Skeleton className=\"h-20\" />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (tab === \"open\") {\r\n      return openOrders.length === 0 ? (\r\n        <V2Card>\r\n          <V2CardHeader title=\"No open orders\" subtitle=\"Your active orders will appear here.\" />\r\n          <V2CardBody>\r\n            <div className=\"text-sm text-[var(--v2-muted)]\">Place an order from Trade to get started.</div>\r\n          </V2CardBody>\r\n        </V2Card>\r\n      ) : (\r\n        <div className=\"grid gap-2\">{openOrders.map((o) => renderOrderRow(o, true))}</div>\r\n      );\r\n    }\r\n\r\n    if (tab === \"history\") {\r\n      return history.length === 0 ? (\r\n        <V2Card>\r\n          <V2CardHeader title=\"No history\" subtitle=\"Your completed orders will show here.\" />\r\n          <V2CardBody>\r\n            <div className=\"text-sm text-[var(--v2-muted)]\">Once you trade, you’ll see filled/canceled orders.</div>\r\n          </V2CardBody>\r\n        </V2Card>\r\n      ) : (\r\n        <div className=\"grid gap-2\">{history.slice(0, 80).map((o) => renderOrderRow(o, false))}</div>\r\n      );\r\n    }\r\n\r\n    // fills\r\n    return fills.length === 0 ? (\r\n      <V2Card>\r\n        <V2CardHeader title=\"No fills\" subtitle=\"Trades (fills) will show here.\" />\r\n        <V2CardBody>\r\n          <div className=\"text-sm text-[var(--v2-muted)]\">When an order matches, fills appear with price/qty.</div>\r\n        </V2CardBody>\r\n      </V2Card>\r\n    ) : (\r\n      <div className=\"grid gap-2\">\r\n        {fills.slice(0, 120).map(({ order, fill }) => {\r\n          const sideColor = order.side === \"buy\" ? \"text-[var(--up)]\" : \"text-[var(--down)]\";\r\n          return (\r\n            <div key={String(fill.id)} className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]\">\r\n              <div className=\"flex items-start justify-between gap-3\">\r\n                <div>\r\n                  <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{String(order.market_symbol ?? \"—\")}</div>\r\n                  <div className={`mt-0.5 text-[12px] font-semibold ${sideColor}`}>{order.side.toUpperCase()}</div>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <div className=\"font-mono text-[13px] font-semibold text-[var(--v2-text)]\">{fmtNum(fill.price)}</div>\r\n                  <div className=\"font-mono text-[12px] text-[var(--v2-muted)]\">{fmtNum(fill.quantity)}</div>\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-2 text-[12px] text-[var(--v2-muted)]\">{fmtTime(fill.created_at)}</div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <main className=\"space-y-4\">\r\n      <header className=\"space-y-2\">\r\n        <div className=\"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]\">Orders</div>\r\n        <h1 className=\"text-2xl font-extrabold tracking-tight\">Your activity</h1>\r\n        <p className=\"text-sm text-[var(--v2-muted)]\">Open orders, history, and fills — built for mobile.</p>\r\n      </header>\r\n\r\n      <V2Tabs tabs={tabs} activeId={tab} onChange={(id) => setTab(id as any)} />\r\n\r\n      {content()}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}