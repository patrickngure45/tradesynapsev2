{"version":3,"sources":["../../../../src/components/v2/Input.tsx","../../../../src/components/v2/Button.tsx","../../../../src/components/v2/Card.tsx","../../../../src/components/v2/Skeleton.tsx","../../../../src/app/v2/p2p/orders/%5Bid%5D/P2POrderClient.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nexport type V2InputProps = Omit<React.InputHTMLAttributes<HTMLInputElement>, \"className\"> & {\r\n  className?: string;\r\n};\r\n\r\nexport const V2Input = React.forwardRef<HTMLInputElement, V2InputProps>(function V2Input(\r\n  { className = \"\", type = \"text\", ...props },\r\n  ref,\r\n) {\r\n  return (\r\n    <input\r\n      ref={ref}\r\n      type={type}\r\n      className={\r\n        \"h-11 w-full rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 text-[14px] text-[var(--v2-text)] shadow-[var(--v2-shadow-sm)] outline-none placeholder:text-[color-mix(in_srgb,var(--v2-muted)_70%,transparent)] focus:ring-2 focus:ring-[var(--v2-ring)] \" +\r\n        className\r\n      }\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n","import * as React from \"react\";\r\n\r\nexport type V2ButtonVariant = \"primary\" | \"secondary\" | \"ghost\" | \"danger\";\r\nexport type V2ButtonSize = \"sm\" | \"md\" | \"lg\";\r\n\r\nexport function v2ButtonClassName(options?: {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n}): string {\r\n  const variant: V2ButtonVariant = options?.variant ?? \"secondary\";\r\n  const size: V2ButtonSize = options?.size ?? \"md\";\r\n\r\n  const base =\r\n    \"inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55\";\r\n\r\n  const sizeClass =\r\n    size === \"lg\" ? \"h-12 px-5 text-[15px]\" : size === \"sm\" ? \"h-9 px-3 text-[13px]\" : \"h-11 px-4 text-[14px]\";\r\n\r\n  const variantClass =\r\n    variant === \"primary\"\r\n      ? \"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n      : variant === \"danger\"\r\n        ? \"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105\"\r\n        : variant === \"ghost\"\r\n          ? \"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]\"\r\n          : \"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]\";\r\n\r\n  const widthClass = options?.fullWidth ? \"w-full\" : \"\";\r\n  const extra = options?.className ?? \"\";\r\n\r\n  return [base, sizeClass, variantClass, widthClass, extra].filter(Boolean).join(\" \");\r\n}\r\n\r\nexport type V2ButtonProps = Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, \"className\"> & {\r\n  variant?: V2ButtonVariant;\r\n  size?: V2ButtonSize;\r\n  fullWidth?: boolean;\r\n  className?: string;\r\n};\r\n\r\nexport const V2Button = React.forwardRef<HTMLButtonElement, V2ButtonProps>(function V2Button(\r\n  { variant, size, fullWidth, className, type, ...props },\r\n  ref,\r\n) {\r\n  return (\r\n    <button\r\n      ref={ref}\r\n      type={type ?? \"button\"}\r\n      className={v2ButtonClassName({ variant, size, fullWidth, className })}\r\n      {...props}\r\n    />\r\n  );\r\n});\r\n","import type { ReactNode } from \"react\";\r\n\r\nexport function V2Card({\r\n  children,\r\n  className = \"\",\r\n}: {\r\n  children: ReactNode;\r\n  className?: string;\r\n}) {\r\n  return (\r\n    <section\r\n      className={\r\n        \"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] \" +\r\n        className\r\n      }\r\n    >\r\n      {children}\r\n    </section>\r\n  );\r\n}\r\n\r\nexport function V2CardHeader({\r\n  title,\r\n  subtitle,\r\n  right,\r\n}: {\r\n  title: ReactNode;\r\n  subtitle?: ReactNode;\r\n  right?: ReactNode;\r\n}) {\r\n  return (\r\n    <header className=\"flex items-start justify-between gap-3 px-4 pt-4\">\r\n      <div className=\"min-w-0\">\r\n        <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{title}</div>\r\n        {subtitle ? <div className=\"mt-0.5 text-[13px] text-[var(--v2-muted)]\">{subtitle}</div> : null}\r\n      </div>\r\n      {right ? <div className=\"shrink-0\">{right}</div> : null}\r\n    </header>\r\n  );\r\n}\r\n\r\nexport function V2CardBody({ children }: { children: ReactNode }) {\r\n  return <div className=\"px-4 pb-4 pt-3\">{children}</div>;\r\n}\r\n","export function V2Skeleton({ className = \"\" }: { className?: string }) {\r\n  return (\r\n    <div\r\n      className={\r\n        \"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] \" + className\r\n      }\r\n      aria-hidden=\"true\"\r\n    />\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { useParams } from \"next/navigation\";\r\nimport { useEffect, useMemo, useRef, useState } from \"react\";\r\n\r\nimport { V2Button } from \"@/components/v2/Button\";\r\nimport { V2Card, V2CardBody, V2CardHeader } from \"@/components/v2/Card\";\r\nimport { V2Input } from \"@/components/v2/Input\";\r\nimport { V2Skeleton } from \"@/components/v2/Skeleton\";\r\n\r\ntype PaymentSnapshotRow = {\r\n  id?: string;\r\n  identifier: string;\r\n  name: string;\r\n  details: Record<string, unknown> | null;\r\n};\r\n\r\ntype Order = {\r\n  id: string;\r\n  status: string;\r\n  amount_fiat: string;\r\n  fiat_currency: string;\r\n  amount_asset: string;\r\n  price: string;\r\n  created_at: string;\r\n  paid_at?: string | null;\r\n  completed_at?: string | null;\r\n  cancelled_at?: string | null;\r\n  expires_at?: string | null;\r\n\r\n  buyer_id: string;\r\n  seller_id: string;\r\n  buyer_email?: string;\r\n  seller_email?: string;\r\n\r\n  asset_symbol: string;\r\n  asset_decimals?: number;\r\n\r\n  ad_terms?: string | null;\r\n  payment_window_minutes?: number;\r\n\r\n  payment_method_snapshot?: PaymentSnapshotRow[];\r\n  payment_details_ready?: boolean;\r\n};\r\n\r\ntype Message = {\r\n  id: string;\r\n  sender_id: string | null;\r\n  content: string;\r\n  created_at: string;\r\n  sender_email?: string | null;\r\n  is_image?: boolean;\r\n};\r\n\r\ntype OrderResponse = { order?: Order; messages?: Message[]; error?: string };\r\n\r\ntype WhoamiResponse = { user?: { id: string } | null };\r\n\r\ntype ActionResponse = { ok?: boolean; order?: any; error?: string; message?: string };\r\n\r\ntype Action = \"PAY_CONFIRMED\" | \"RELEASE\" | \"CANCEL\";\r\n\r\nfunction fmtTime(ts: string | null | undefined): string {\r\n  if (!ts) return \"\";\r\n  try {\r\n    return new Date(ts).toLocaleString();\r\n  } catch {\r\n    return String(ts);\r\n  }\r\n}\r\n\r\nfunction toNum(v: unknown): number | null {\r\n  const n = typeof v === \"number\" ? v : Number(String(v));\r\n  return Number.isFinite(n) ? n : null;\r\n}\r\n\r\nfunction fmtNum(v: string | null | undefined): string {\r\n  const n = toNum(v);\r\n  if (n == null) return \"—\";\r\n  if (n === 0) return \"0\";\r\n  const abs = Math.abs(n);\r\n  const decimals = abs >= 1000 ? 2 : abs >= 1 ? 4 : abs >= 0.01 ? 6 : 8;\r\n  return n.toLocaleString(undefined, { maximumFractionDigits: decimals });\r\n}\r\n\r\nfunction fmtMoney(v: string | null | undefined, fiat: string): string {\r\n  const n = toNum(v);\r\n  if (n == null) return \"—\";\r\n  try {\r\n    return new Intl.NumberFormat(undefined, {\r\n      style: \"currency\",\r\n      currency: fiat,\r\n      currencyDisplay: \"code\",\r\n      maximumFractionDigits: 2,\r\n    }).format(n);\r\n  } catch {\r\n    return `${n.toLocaleString()} ${fiat}`;\r\n  }\r\n}\r\n\r\nexport function P2POrderClient() {\r\n  const params = useParams() as { id: string };\r\n  const id = String(params?.id ?? \"\");\r\n\r\n  const [me, setMe] = useState<string | null>(null);\r\n\r\n  const [order, setOrder] = useState<Order | null>(null);\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const [chat, setChat] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n  const [chatError, setChatError] = useState<string | null>(null);\r\n\r\n  const [acting, setActing] = useState<Action | null>(null);\r\n  const [actionError, setActionError] = useState<string | null>(null);\r\n\r\n  const loadSeqRef = useRef(0);\r\n  const abortRef = useRef<AbortController | null>(null);\r\n  const hasLoadedRef = useRef(false);\r\n  const orderStatusRef = useRef<string>(\"\");\r\n\r\n  const notifEsRef = useRef<EventSource | null>(null);\r\n  const lastNotifRefreshAtRef = useRef<number>(0);\r\n\r\n  useEffect(() => {\r\n    orderStatusRef.current = String(order?.status ?? \"\").toLowerCase();\r\n  }, [order?.status]);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    fetch(\"/api/whoami\", { cache: \"no-store\" })\r\n      .then((r) => (r.ok ? r.json() : null))\r\n      .then((json: WhoamiResponse | null) => {\r\n        if (cancelled) return;\r\n        const uid = typeof json?.user?.id === \"string\" ? json.user.id : null;\r\n        setMe(uid);\r\n      })\r\n      .catch(() => {\r\n        if (!cancelled) setMe(null);\r\n      });\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, []);\r\n\r\n  const load = async () => {\r\n    if (!id) return;\r\n    const seq = ++loadSeqRef.current;\r\n    abortRef.current?.abort();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    setError(null);\r\n    if (!hasLoadedRef.current) setLoading(true);\r\n\r\n    try {\r\n      const res = await fetch(`/api/p2p/orders/${encodeURIComponent(id)}`, { cache: \"no-store\", signal: controller.signal });\r\n      const json = (await res.json().catch(() => null)) as OrderResponse | null;\r\n      if (!res.ok) {\r\n        const code = typeof (json as any)?.error === \"string\" ? (json as any).error : `http_${res.status}`;\r\n        throw new Error(code);\r\n      }\r\n      if (seq !== loadSeqRef.current) return;\r\n      setOrder(json?.order ?? null);\r\n      setMessages(Array.isArray(json?.messages) ? (json!.messages as any) : []);\r\n      hasLoadedRef.current = true;\r\n    } catch (e) {\r\n      if (e instanceof DOMException && e.name === \"AbortError\") return;\r\n      if (seq !== loadSeqRef.current) return;\r\n      if (!hasLoadedRef.current) setError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      if (seq === loadSeqRef.current) setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    void load();\r\n    let timeoutId: number | null = null;\r\n\r\n    const stopTimer = () => {\r\n      if (!timeoutId) return;\r\n      window.clearTimeout(timeoutId);\r\n      timeoutId = null;\r\n    };\r\n\r\n    const schedule = () => {\r\n      stopTimer();\r\n      const status = orderStatusRef.current;\r\n      const isTerminal = status === \"completed\" || status === \"cancelled\";\r\n      const delayMs = notifEsRef.current\r\n        ? (isTerminal ? 45_000 : 15_000)\r\n        : (isTerminal ? 20_000 : 4_000);\r\n      timeoutId = window.setTimeout(() => {\r\n        timeoutId = null;\r\n        if (document.visibilityState === \"visible\") void load();\r\n        schedule();\r\n      }, delayMs);\r\n    };\r\n\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") {\r\n        void load();\r\n        schedule();\r\n      } else {\r\n        stopTimer();\r\n      }\r\n    };\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    schedule();\r\n    return () => {\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n      stopTimer();\r\n      abortRef.current?.abort();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  // Realtime: refresh this order when relevant p2p_* notifications arrive.\r\n  useEffect(() => {\r\n    if (!id) return;\r\n\r\n    const stop = () => {\r\n      try {\r\n        notifEsRef.current?.close();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      notifEsRef.current = null;\r\n    };\r\n\r\n    const refreshSoon = () => {\r\n      const now = Date.now();\r\n      if (now - lastNotifRefreshAtRef.current < 700) return;\r\n      lastNotifRefreshAtRef.current = now;\r\n      if (document.visibilityState !== \"visible\") return;\r\n      void load();\r\n    };\r\n\r\n    const shouldRefresh = (data: any) => {\r\n      const type = String(data?.type ?? \"\");\r\n      if (!type.startsWith(\"p2p_\")) return false;\r\n      const orderId = String(data?.metadata?.order_id ?? \"\");\r\n      return orderId ? orderId === id : true;\r\n    };\r\n\r\n    const start = () => {\r\n      if (document.visibilityState !== \"visible\") return;\r\n      if (typeof EventSource === \"undefined\") return;\r\n      if (notifEsRef.current) return;\r\n      try {\r\n        const es = new EventSource(\"/api/notifications/stream\", { withCredentials: true } as any);\r\n        es.addEventListener(\"notification\", (evt) => {\r\n          try {\r\n            const data = JSON.parse(String((evt as MessageEvent).data ?? \"{}\"));\r\n            if (shouldRefresh(data)) refreshSoon();\r\n          } catch {\r\n            // ignore\r\n          }\r\n        });\r\n        es.addEventListener(\"ready\", () => refreshSoon());\r\n        es.onerror = () => {\r\n          // allow browser to retry automatically\r\n        };\r\n        notifEsRef.current = es;\r\n      } catch {\r\n        stop();\r\n      }\r\n    };\r\n\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") start();\r\n      else stop();\r\n    };\r\n\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    start();\r\n    return () => {\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n      stop();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  const role = useMemo(() => {\r\n    if (!order || !me) return null;\r\n    if (String(order.buyer_id) === String(me)) return \"buyer\" as const;\r\n    if (String(order.seller_id) === String(me)) return \"seller\" as const;\r\n    return null;\r\n  }, [order, me]);\r\n\r\n  const canPay = role === \"buyer\" && String(order?.status) === \"created\";\r\n  const canRelease = role === \"seller\" && String(order?.status) === \"paid_confirmed\";\r\n  const canCancel = String(order?.status) === \"created\";\r\n\r\n  const doAction = async (action: Action) => {\r\n    if (!id || acting) return;\r\n    setActing(action);\r\n    setActionError(null);\r\n\r\n    try {\r\n      const res = await fetch(`/api/p2p/orders/${encodeURIComponent(id)}/action`, {\r\n        method: \"POST\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        credentials: \"include\",\r\n        body: JSON.stringify({ action }),\r\n      });\r\n      const json = (await res.json().catch(() => null)) as ActionResponse | null;\r\n      if (!res.ok) {\r\n        const code = typeof (json as any)?.error === \"string\" ? (json as any).error : `http_${res.status}`;\r\n        throw new Error(code);\r\n      }\r\n      void load();\r\n    } catch (e) {\r\n      setActionError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setActing(null);\r\n    }\r\n  };\r\n\r\n  const sendChat = async () => {\r\n    if (!id || sending) return;\r\n    const content = chat.trim();\r\n    if (!content) return;\r\n\r\n    setSending(true);\r\n    setChatError(null);\r\n    try {\r\n      const res = await fetch(`/api/p2p/orders/${encodeURIComponent(id)}/chat`, {\r\n        method: \"POST\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        credentials: \"include\",\r\n        body: JSON.stringify({ content }),\r\n      });\r\n      const json = (await res.json().catch(() => null)) as any;\r\n      if (!res.ok) {\r\n        const code = typeof json?.error === \"string\" ? json.error : `http_${res.status}`;\r\n        throw new Error(code);\r\n      }\r\n      setChat(\"\");\r\n      void load();\r\n    } catch (e) {\r\n      setChatError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  const snapshot = Array.isArray(order?.payment_method_snapshot) ? (order!.payment_method_snapshot as PaymentSnapshotRow[]) : [];\r\n\r\n  const header = (\r\n    <header className=\"space-y-2\">\r\n      <div className=\"flex items-center justify-between gap-2\">\r\n        <div>\r\n          <div className=\"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]\">P2P</div>\r\n          <h1 className=\"text-2xl font-extrabold tracking-tight\">Order</h1>\r\n        </div>\r\n        <Link\r\n          href=\"/v2/p2p/orders\"\r\n          className=\"rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-2 text-[12px] font-semibold text-[var(--v2-text)]\"\r\n        >\r\n          Back\r\n        </Link>\r\n      </div>\r\n      <p className=\"text-sm text-[var(--v2-muted)]\">Chat, payment details, and actions.</p>\r\n    </header>\r\n  );\r\n\r\n  if (error && !order) {\r\n    return (\r\n      <main className=\"space-y-4\">\r\n        {header}\r\n        <V2Card>\r\n          <V2CardHeader title=\"Order unavailable\" subtitle=\"Sign in and try again.\" />\r\n          <V2CardBody>\r\n            <div className=\"text-sm text-[var(--v2-muted)]\">{String(error)}</div>\r\n            <div className=\"mt-3\">\r\n              <V2Button variant=\"primary\" fullWidth onClick={() => void load()}>\r\n                Retry\r\n              </V2Button>\r\n            </div>\r\n          </V2CardBody>\r\n        </V2Card>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  if (loading && !order) {\r\n    return (\r\n      <main className=\"space-y-4\">\r\n        {header}\r\n        <div className=\"grid gap-2\">\r\n          <V2Skeleton className=\"h-24\" />\r\n          <V2Skeleton className=\"h-24\" />\r\n          <V2Skeleton className=\"h-24\" />\r\n        </div>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  if (!order) {\r\n    return (\r\n      <main className=\"space-y-4\">\r\n        {header}\r\n        <V2Card>\r\n          <V2CardHeader title=\"Not found\" subtitle=\"This order doesn’t exist or you don’t have access.\" />\r\n        </V2Card>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  const status = String(order.status || \"\").toLowerCase();\r\n\r\n  return (\r\n    <main className=\"space-y-4\">\r\n      {header}\r\n\r\n      <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]\">\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <div>\r\n            <div className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Status</div>\r\n            <div className=\"mt-0.5 text-[15px] font-semibold text-[var(--v2-text)]\">{status.replaceAll(\"_\", \" \") || \"—\"}</div>\r\n            <div className=\"mt-2 text-[12px] text-[var(--v2-muted)]\">Created {fmtTime(order.created_at)}</div>\r\n          </div>\r\n          <div className=\"text-right\">\r\n            <div className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">You</div>\r\n            <div className=\"mt-0.5 text-[13px] font-semibold text-[var(--v2-text)]\">{role ? role.toUpperCase() : \"—\"}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-3 grid grid-cols-2 gap-2\">\r\n          <div className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n            <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">Amount</div>\r\n            <div className=\"mt-0.5 font-mono text-[13px] font-semibold text-[var(--v2-text)]\">\r\n              {fmtNum(order.amount_asset)} {String(order.asset_symbol || \"—\")}\r\n            </div>\r\n            <div className=\"mt-0.5 text-[12px] text-[var(--v2-muted)]\">≈ {fmtMoney(order.amount_fiat, String(order.fiat_currency || \"USD\"))}</div>\r\n          </div>\r\n          <div className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n            <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">Price</div>\r\n            <div className=\"mt-0.5 font-mono text-[13px] font-semibold text-[var(--v2-text)]\">\r\n              {fmtMoney(order.price, String(order.fiat_currency || \"USD\"))}\r\n            </div>\r\n            <div className=\"mt-0.5 text-[12px] text-[var(--v2-muted)]\">Window: {String(order.payment_window_minutes ?? \"—\")} min</div>\r\n          </div>\r\n        </div>\r\n\r\n        {actionError ? <div className=\"mt-3 text-sm text-[var(--down)]\">{actionError}</div> : null}\r\n\r\n        <div className=\"mt-3 grid gap-2\">\r\n          {canPay ? (\r\n            <V2Button variant=\"primary\" fullWidth disabled={acting !== null} onClick={() => void doAction(\"PAY_CONFIRMED\")}>\r\n              {acting === \"PAY_CONFIRMED\" ? \"Marking…\" : \"I have paid\"}\r\n            </V2Button>\r\n          ) : null}\r\n          {canRelease ? (\r\n            <V2Button variant=\"primary\" fullWidth disabled={acting !== null} onClick={() => void doAction(\"RELEASE\")}>\r\n              {acting === \"RELEASE\" ? \"Releasing…\" : \"Release crypto\"}\r\n            </V2Button>\r\n          ) : null}\r\n          {canCancel ? (\r\n            <V2Button variant=\"ghost\" fullWidth disabled={acting !== null} onClick={() => void doAction(\"CANCEL\")}>\r\n              {acting === \"CANCEL\" ? \"Canceling…\" : \"Cancel order\"}\r\n            </V2Button>\r\n          ) : null}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]\">\r\n        <div className=\"text-[13px] font-semibold text-[var(--v2-text)]\">Payment details</div>\r\n        {snapshot.length === 0 ? (\r\n          <div className=\"mt-2 text-[12px] text-[var(--v2-muted)]\">No payment details available.</div>\r\n        ) : (\r\n          <div className=\"mt-2 grid gap-2\">\r\n            {snapshot.map((m, idx) => (\r\n              <div key={String(m.id || idx)} className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n                <div className=\"text-[12px] font-semibold text-[var(--v2-text)]\">{String(m.name || m.identifier)}</div>\r\n                <div className=\"mt-0.5 text-[11px] text-[var(--v2-muted)]\">{String(m.identifier)}</div>\r\n                {m.details ? (\r\n                  <pre className=\"mt-2 max-h-32 overflow-auto whitespace-pre-wrap break-words rounded-lg border border-[var(--v2-border)] bg-[var(--v2-surface)] p-2 text-[11px] text-[var(--v2-muted)]\">\r\n                    {JSON.stringify(m.details, null, 2)}\r\n                  </pre>\r\n                ) : null}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {order.ad_terms ? (\r\n          <div className=\"mt-3\">\r\n            <div className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Terms</div>\r\n            <div className=\"mt-1 whitespace-pre-wrap text-[12px] text-[var(--v2-text)]\">{String(order.ad_terms)}</div>\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n\r\n      <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"text-[13px] font-semibold text-[var(--v2-text)]\">Chat</div>\r\n          <div className=\"text-[12px] text-[var(--v2-muted)]\">{messages.length}</div>\r\n        </div>\r\n\r\n        <div className=\"mt-3 grid gap-2\">\r\n          {messages.length === 0 ? (\r\n            <div className=\"text-[12px] text-[var(--v2-muted)]\">No messages yet.</div>\r\n          ) : (\r\n            messages.slice(-60).map((m) => {\r\n              const isSystem = m.sender_id == null;\r\n              return (\r\n                <div key={String(m.id)} className=\"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2\">\r\n                  <div className=\"flex items-center justify-between gap-2\">\r\n                    <div className=\"text-[11px] font-semibold text-[var(--v2-muted)]\">\r\n                      {isSystem ? \"System\" : String(m.sender_email || \"User\")}\r\n                    </div>\r\n                    <div className=\"text-[11px] text-[var(--v2-muted)]\">{fmtTime(m.created_at)}</div>\r\n                  </div>\r\n                  <div className=\"mt-1 whitespace-pre-wrap text-[12px] text-[var(--v2-text)]\">{String(m.content || \"\")}</div>\r\n                </div>\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"mt-3 grid gap-2\">\r\n          <V2Input value={chat} onChange={(e) => setChat(e.target.value)} placeholder=\"Message…\" />\r\n          {chatError ? <div className=\"text-sm text-[var(--down)]\">{chatError}</div> : null}\r\n          <V2Button variant=\"primary\" fullWidth disabled={sending} onClick={() => void sendChat()}>\r\n            {sending ? \"Sending…\" : \"Send\"}\r\n          </V2Button>\r\n        </div>\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}