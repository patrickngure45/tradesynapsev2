module.exports=[556836,a=>{"use strict";var b=a.i(187924);function c(a){let b=a?.variant??"secondary",c=a?.size??"md";return["inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55","lg"===c?"h-12 px-5 text-[15px]":"sm"===c?"h-9 px-3 text-[13px]":"h-11 px-4 text-[14px]","primary"===b?"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"danger"===b?"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"ghost"===b?"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]":"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]",a?.fullWidth?"w-full":"",a?.className??""].filter(Boolean).join(" ")}let d=a.i(572131).forwardRef(function({variant:a,size:d,fullWidth:e,className:f,type:g,...h},i){return(0,b.jsx)("button",{ref:i,type:g??"button",className:c({variant:a,size:d,fullWidth:e,className:f}),...h})});a.s(["V2Button",0,d,"v2ButtonClassName",()=>c])},214373,a=>{"use strict";var b=a.i(187924);function c({children:a,className:c=""}){return(0,b.jsx)("section",{className:"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] "+c,children:a})}function d({title:a,subtitle:c,right:d}){return(0,b.jsxs)("header",{className:"flex items-start justify-between gap-3 px-4 pt-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:a}),c?(0,b.jsx)("div",{className:"mt-0.5 text-[13px] text-[var(--v2-muted)]",children:c}):null]}),d?(0,b.jsx)("div",{className:"shrink-0",children:d}):null]})}function e({children:a}){return(0,b.jsx)("div",{className:"px-4 pb-4 pt-3",children:a})}a.s(["V2Card",()=>c,"V2CardBody",()=>e,"V2CardHeader",()=>d])},782691,a=>{"use strict";var b=a.i(187924);function c({className:a=""}){return(0,b.jsx)("div",{className:"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] "+a,"aria-hidden":"true"})}a.s(["V2Skeleton",()=>c])},152608,a=>{"use strict";var b=a.i(187924);function c({tabs:a,activeId:c,onChange:d}){return(0,b.jsx)("div",{className:"grid gap-1 rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] p-1 shadow-[var(--v2-shadow-sm)]",style:{gridTemplateColumns:`repeat(${Math.max(1,a.length)}, minmax(0, 1fr))`},role:"tablist",children:a.map(a=>{let e=a.id===c;return(0,b.jsx)("button",{type:"button",role:"tab","aria-selected":e,className:"h-10 rounded-xl text-[13px] font-semibold transition "+(e?"bg-[var(--v2-surface-2)] text-[var(--v2-text)]":"text-[var(--v2-muted)] hover:bg-[var(--v2-surface-2)]/70"),onClick:()=>d(a.id),children:a.label},a.id)})})}a.s(["V2Tabs",()=>c])},662045,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(556836),e=a.i(214373),f=a.i(782691),g=a.i(152608);function h(a){let b=Number(String(a??""));if(!Number.isFinite(b))return"—";if(0===b)return"0";let c=Math.abs(b);return b.toLocaleString(void 0,{maximumFractionDigits:c>=1e3?2:c>=1?4:c>=.01?6:8})}function i(a){if(!a)return"";try{return new Date(a).toLocaleString()}catch{return String(a)}}function j(){let[a,j]=(0,c.useState)("open"),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(null),u=(0,c.useRef)(null),v=(0,c.useRef)(0),w=(0,c.useRef)(!1),x=(0,c.useRef)(0),y=(0,c.useRef)(null),z=(0,c.useMemo)(()=>[{id:"open",label:"Open"},{id:"history",label:"History"},{id:"fills",label:"Fills"}],[]),A=async()=>{let a=++x.current;y.current?.abort();let b=new AbortController;y.current=b,w.current||l(!0),n(null);try{let[c,d]=await Promise.all([fetch("/api/exchange/orders",{cache:"no-store",credentials:"include",signal:b.signal}),fetch("/api/exchange/orders/history?status=all&limit=200",{cache:"no-store",credentials:"include",signal:b.signal})]),e=await c.json().catch(()=>null),f=await d.json().catch(()=>null);if(!c.ok)throw Error("string"==typeof e?.error?e.error:`http_${c.status}`);if(!d.ok)throw Error("string"==typeof f?.error?f.error:`http_${d.status}`);if(a!==x.current)return;p(Array.isArray(e?.orders)?e.orders:[]),r(Array.isArray(f?.orders)?f.orders:[])}catch(b){if(b instanceof DOMException&&"AbortError"===b.name||a!==x.current)return;w.current||n(b instanceof Error?b.message:String(b))}finally{a===x.current&&(l(!1),w.current=!0)}};(0,c.useEffect)(()=>{A();let a=window.setInterval(()=>{"visible"===document.visibilityState&&A()},12e3),b=()=>{"visible"===document.visibilityState&&A()};return document.addEventListener("visibilitychange",b),()=>{window.clearInterval(a),document.removeEventListener("visibilitychange",b)}},[]),(0,c.useEffect)(()=>{let a=()=>{try{u.current?.close()}catch{}u.current=null},b=()=>{let a=Date.now();a-v.current<800||(v.current=a,"visible"===document.visibilityState&&A())},c=()=>{if(!("visible"!==document.visibilityState||"u"<typeof EventSource)&&!u.current)try{let a=new EventSource("/api/notifications/stream",{withCredentials:!0});a.addEventListener("notification",a=>{try{var c;let d,e=JSON.parse(String(a.data??"{}"));c=String(e?.type??""),d=String(c||""),("order_placed"===d||"order_filled"===d||"order_partially_filled"===d||"order_canceled"===d||"order_rejected"===d)&&b()}catch{}}),a.addEventListener("ready",()=>b()),a.onerror=()=>{},u.current=a}catch{a()}},d=()=>{"visible"===document.visibilityState?c():a()};return document.addEventListener("visibilitychange",d),c(),()=>{document.removeEventListener("visibilitychange",d),a()}},[]);let B=(0,c.useMemo)(()=>{let a=[];for(let b of q)for(let c of Array.isArray(b.fills)?b.fills:[])a.push({order:b,fill:c});return a.sort((a,b)=>{let c=a.fill?.created_at?Date.parse(String(a.fill.created_at)):0;return(b.fill?.created_at?Date.parse(String(b.fill.created_at)):0)-c}),a.slice(0,200)},[q]),C=async a=>{if(a&&!s){t(a),n(null),p(b=>b.filter(b=>b.id!==a));try{let b=await fetch(`/api/exchange/orders/${encodeURIComponent(a)}/cancel`,{method:"POST",credentials:"include"}),c=await b.json().catch(()=>null);if(!b.ok)throw p(o),Error("string"==typeof c?.error?c.error:`http_${b.status}`);A()}catch(a){n(a instanceof Error?a.message:String(a))}finally{t(null)}}},D=(a,c)=>{let e="buy"===a.side?"text-[var(--up)]":"text-[var(--down)]",f=String(a.status??"").toLowerCase();return(0,b.jsxs)("div",{className:"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:String(a.market_symbol??"—")}),(0,b.jsx)("span",{className:`text-[12px] font-semibold ${e}`,children:a.side.toUpperCase()}),(0,b.jsx)("span",{className:"rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold text-[var(--v2-muted)]",children:a.type.toUpperCase()}),(0,b.jsx)("span",{className:"rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold text-[var(--v2-muted)]",children:f.replaceAll("_"," ")})]}),(0,b.jsx)("div",{className:"mt-1 text-[12px] text-[var(--v2-muted)]",children:i(a.created_at)})]}),c?(0,b.jsx)(d.V2Button,{variant:"ghost",size:"sm",disabled:s===a.id,onClick:()=>void C(a.id),className:"border border-[var(--v2-border)]",children:s===a.id?"Canceling…":"Cancel"}):null]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-3 gap-2 text-[12px]",children:[(0,b.jsxs)("div",{className:"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2",children:[(0,b.jsx)("div",{className:"text-[11px] font-semibold text-[var(--v2-muted)]",children:"Price"}),(0,b.jsx)("div",{className:"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]",children:"market"===a.type?"MKT":h(a.price)})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2",children:[(0,b.jsx)("div",{className:"text-[11px] font-semibold text-[var(--v2-muted)]",children:"Qty"}),(0,b.jsx)("div",{className:"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]",children:h(a.quantity)})]}),(0,b.jsxs)("div",{className:"rounded-xl bg-[var(--v2-surface-2)] px-2 py-2",children:[(0,b.jsx)("div",{className:"text-[11px] font-semibold text-[var(--v2-muted)]",children:"Remaining"}),(0,b.jsx)("div",{className:"mt-0.5 font-mono text-[12px] text-[var(--v2-text)]",children:h(a.remaining_quantity)})]})]})]},a.id)};return(0,b.jsxs)("main",{className:"space-y-4",children:[(0,b.jsxs)("header",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]",children:"Orders"}),(0,b.jsx)("h1",{className:"text-2xl font-extrabold tracking-tight",children:"Your activity"}),(0,b.jsx)("p",{className:"text-sm text-[var(--v2-muted)]",children:"Open orders, history, and fills — built for mobile."})]}),(0,b.jsx)(g.V2Tabs,{tabs:z,activeId:a,onChange:a=>j(a)}),m?(0,b.jsxs)(e.V2Card,{children:[(0,b.jsx)(e.V2CardHeader,{title:"Orders unavailable",subtitle:"Sign in and try again."}),(0,b.jsxs)(e.V2CardBody,{children:[(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:String(m)}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)(d.V2Button,{variant:"primary",fullWidth:!0,onClick:()=>void A(),children:"Retry"})})]})]}):k?(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(f.V2Skeleton,{className:"h-20"}),(0,b.jsx)(f.V2Skeleton,{className:"h-20"}),(0,b.jsx)(f.V2Skeleton,{className:"h-20"})]}):"open"===a?0===o.length?(0,b.jsxs)(e.V2Card,{children:[(0,b.jsx)(e.V2CardHeader,{title:"No open orders",subtitle:"Your active orders will appear here."}),(0,b.jsx)(e.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Place an order from Trade to get started."})})]}):(0,b.jsx)("div",{className:"grid gap-2",children:o.map(a=>D(a,!0))}):"history"===a?0===q.length?(0,b.jsxs)(e.V2Card,{children:[(0,b.jsx)(e.V2CardHeader,{title:"No history",subtitle:"Your completed orders will show here."}),(0,b.jsx)(e.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Once you trade, you’ll see filled/canceled orders."})})]}):(0,b.jsx)("div",{className:"grid gap-2",children:q.slice(0,80).map(a=>D(a,!1))}):0===B.length?(0,b.jsxs)(e.V2Card,{children:[(0,b.jsx)(e.V2CardHeader,{title:"No fills",subtitle:"Trades (fills) will show here."}),(0,b.jsx)(e.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"When an order matches, fills appear with price/qty."})})]}):(0,b.jsx)("div",{className:"grid gap-2",children:B.slice(0,120).map(({order:a,fill:c})=>{let d="buy"===a.side?"text-[var(--up)]":"text-[var(--down)]";return(0,b.jsxs)("div",{className:"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:String(a.market_symbol??"—")}),(0,b.jsx)("div",{className:`mt-0.5 text-[12px] font-semibold ${d}`,children:a.side.toUpperCase()})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"font-mono text-[13px] font-semibold text-[var(--v2-text)]",children:h(c.price)}),(0,b.jsx)("div",{className:"font-mono text-[12px] text-[var(--v2-muted)]",children:h(c.quantity)})]})]}),(0,b.jsx)("div",{className:"mt-2 text-[12px] text-[var(--v2-muted)]",children:i(c.created_at)})]},String(c.id))})})]})}a.s(["OrdersClient",()=>j])}];

//# sourceMappingURL=src_3cdb1b2b._.js.map