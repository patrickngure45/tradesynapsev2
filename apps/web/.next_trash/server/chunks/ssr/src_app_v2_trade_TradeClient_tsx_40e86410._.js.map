{"version":3,"sources":["../../../../src/app/v2/trade/TradeClient.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { useSearchParams } from \"next/navigation\";\r\n\r\nimport { V2Button } from \"@/components/v2/Button\";\r\nimport { V2Card, V2CardBody, V2CardHeader } from \"@/components/v2/Card\";\r\nimport { V2Input } from \"@/components/v2/Input\";\r\nimport { V2Sheet } from \"@/components/v2/Sheet\";\r\nimport { V2Skeleton } from \"@/components/v2/Skeleton\";\r\nimport { V2Tabs } from \"@/components/v2/Tabs\";\r\n\r\ntype Pair = { base: string; quote: string };\r\n\r\ntype MarketOverviewRow = {\r\n  id: string;\r\n  symbol: string;\r\n  is_halted: boolean;\r\n  base_symbol: string;\r\n  quote_symbol: string;\r\n  stats: null | {\r\n    open: string;\r\n    last: string;\r\n    high?: string | null;\r\n    low?: string | null;\r\n    volume?: string | null;\r\n    quote_volume: string;\r\n    trade_count?: number;\r\n  };\r\n};\r\n\r\ntype MarketsOverviewResponse = {\r\n  markets: MarketOverviewRow[];\r\n};\r\n\r\ntype DepthResponse = {\r\n  depth: {\r\n    bids: Array<{ price: string; quantity: string; order_count: number }>;\r\n    asks: Array<{ price: string; quantity: string; order_count: number }>;\r\n  };\r\n  ts: string;\r\n};\r\n\r\ntype TradesResponse = {\r\n  trades: Array<{ id: string; price: string; quantity: string; created_at: string }>;\r\n};\r\n\r\ntype CandlesResponse = {\r\n  market: { id: string; chain: string; symbol: string; status: string };\r\n  interval: \"1m\";\r\n  candles: Array<{ ts: string; open: string; high: string; low: string; close: string; volume: string; trade_count: number }>;\r\n};\r\n\r\nfunction toNum(v: unknown): number | null {\r\n  const n = typeof v === \"number\" ? v : Number(String(v));\r\n  return Number.isFinite(n) ? n : null;\r\n}\r\n\r\nfunction pctChange(open: string | null | undefined, last: string | null | undefined): number | null {\r\n  const o = toNum(open);\r\n  const l = toNum(last);\r\n  if (o == null || l == null) return null;\r\n  if (o <= 0) return null;\r\n  return ((l - o) / o) * 100;\r\n}\r\n\r\nfunction fmtPrice(v: string | null | undefined): string {\r\n  const n = toNum(v);\r\n  if (n == null) return \"—\";\r\n  if (n === 0) return \"0\";\r\n  const abs = Math.abs(n);\r\n  const decimals = abs >= 1000 ? 2 : abs >= 1 ? 4 : abs >= 0.01 ? 6 : 8;\r\n  return n.toLocaleString(undefined, { maximumFractionDigits: decimals });\r\n}\r\n\r\nconst defaultPair: Pair = { base: \"BTC\", quote: \"USDT\" };\r\n\r\nexport function TradeClient() {\r\n  const sp = useSearchParams();\r\n  const initial = (() => {\r\n    const base = String(sp?.get(\"base\") ?? \"\").trim().toUpperCase();\r\n    const quote = String(sp?.get(\"quote\") ?? \"\").trim().toUpperCase();\r\n    if (base && quote) return { base, quote } as Pair;\r\n    return defaultPair;\r\n  })();\r\n\r\n  const [pair, setPair] = useState<Pair>(initial);\r\n  const [sheetOpen, setSheetOpen] = useState(false);\r\n  const [segment, setSegment] = useState<\"chart\" | \"book\" | \"trades\">(\"chart\");\r\n  const [marketLoading, setMarketLoading] = useState(true);\r\n  const [marketError, setMarketError] = useState<string | null>(null);\r\n  const [markets, setMarkets] = useState<MarketOverviewRow[]>([]);\r\n  const [pairSearch, setPairSearch] = useState(\"\");\r\n\r\n  const [depthLoading, setDepthLoading] = useState(false);\r\n  const [depthError, setDepthError] = useState<string | null>(null);\r\n  const [depth, setDepth] = useState<DepthResponse | null>(null);\r\n\r\n  const [tradesLoading, setTradesLoading] = useState(false);\r\n  const [tradesError, setTradesError] = useState<string | null>(null);\r\n  const [trades, setTrades] = useState<TradesResponse | null>(null);\r\n\r\n  const [candleRange, setCandleRange] = useState<\"1h\" | \"6h\" | \"8h\">(\"1h\");\r\n  const [candlesLoading, setCandlesLoading] = useState(false);\r\n  const [candlesError, setCandlesError] = useState<string | null>(null);\r\n  const [candles, setCandles] = useState<CandlesResponse | null>(null);\r\n\r\n  const [side, setSide] = useState<\"buy\" | \"sell\">(\"buy\");\r\n  const [orderType, setOrderType] = useState<\"market\" | \"limit\">(\"market\");\r\n  const [quantity, setQuantity] = useState<string>(\"\");\r\n  const [limitPrice, setLimitPrice] = useState<string>(\"\");\r\n  const [placeStatus, setPlaceStatus] = useState<{ kind: \"idle\" | \"placing\" | \"ok\" | \"error\"; message?: string }>(\r\n    { kind: \"idle\" },\r\n  );\r\n\r\n  const lastPlacedAtRef = useRef<number>(0);\r\n  const esRef = useRef<EventSource | null>(null);\r\n\r\n  const pairLabel = `${pair.base}/${pair.quote}`;\r\n\r\n  // Remember last traded pair for default launch behavior (/v2).\r\n  useEffect(() => {\r\n    try {\r\n      localStorage.setItem(\"cw:v2:lastPair\", JSON.stringify({ base: pair.base, quote: pair.quote }));\r\n    } catch {\r\n      // ignore storage errors\r\n    }\r\n  }, [pair.base, pair.quote]);\r\n\r\n  // If the user navigates from Markets with a new pair, keep state in sync.\r\n  useEffect(() => {\r\n    const base = String(sp?.get(\"base\") ?? \"\").trim().toUpperCase();\r\n    const quote = String(sp?.get(\"quote\") ?? \"\").trim().toUpperCase();\r\n    if (!base || !quote) return;\r\n    if (base === pair.base && quote === pair.quote) return;\r\n    setPair({ base, quote });\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [sp]);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    const load = async () => {\r\n      setMarketError(null);\r\n      try {\r\n        const res = await fetch(\"/api/exchange/markets/overview?fiat=USD\", { cache: \"no-store\" });\r\n        const json = (await res.json().catch(() => null)) as MarketsOverviewResponse | null;\r\n        if (!res.ok) throw new Error(\"markets_unavailable\");\r\n        const rows = Array.isArray(json?.markets) ? json!.markets : [];\r\n        const usdt = rows.filter((m) => String(m.quote_symbol).toUpperCase() === \"USDT\");\r\n        if (!cancelled) setMarkets(usdt);\r\n      } catch (e) {\r\n        if (!cancelled) setMarketError(e instanceof Error ? e.message : String(e));\r\n      } finally {\r\n        if (!cancelled) setMarketLoading(false);\r\n      }\r\n    };\r\n\r\n    void load();\r\n    const id = window.setInterval(() => void load(), 15_000);\r\n    return () => {\r\n      cancelled = true;\r\n      window.clearInterval(id);\r\n    };\r\n  }, []);\r\n\r\n  const market = useMemo(() => {\r\n    const base = pair.base.toUpperCase();\r\n    const quote = pair.quote.toUpperCase();\r\n    return markets.find((m) => String(m.base_symbol).toUpperCase() === base && String(m.quote_symbol).toUpperCase() === quote) ?? null;\r\n  }, [markets, pair.base, pair.quote]);\r\n\r\n  const marketId = market?.id ?? null;\r\n\r\n  const last = market?.stats?.last ?? null;\r\n  const change = pctChange(market?.stats?.open ?? null, market?.stats?.last ?? null);\r\n  const changeText = change == null ? \"—\" : `${change >= 0 ? \"+\" : \"\"}${change.toFixed(2)}%`;\r\n  const changeClass = change == null ? \"text-[var(--v2-muted)]\" : change >= 0 ? \"text-[var(--up)]\" : \"text-[var(--down)]\";\r\n\r\n  const high24h = market?.stats && (market.stats as any).high ? String((market.stats as any).high) : null;\r\n  const low24h = market?.stats && (market.stats as any).low ? String((market.stats as any).low) : null;\r\n  const volQuote = market?.stats?.quote_volume ?? null;\r\n\r\n  const tabs = useMemo(\r\n    () => [\r\n      { id: \"chart\", label: \"Chart\" },\r\n      { id: \"book\", label: \"Book\" },\r\n      { id: \"trades\", label: \"Trades\" },\r\n    ],\r\n    [],\r\n  );\r\n\r\n  const loadDepth = async (id: string, signal?: AbortSignal) => {\r\n    setDepthError(null);\r\n    setDepthLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/exchange/marketdata/depth?market_id=${encodeURIComponent(id)}&levels=12`, {\r\n        cache: \"no-store\",\r\n        signal,\r\n      });\r\n      const json = (await res.json().catch(() => null)) as DepthResponse | null;\r\n      if (!res.ok) throw new Error(\"depth_unavailable\");\r\n      setDepth(json);\r\n    } catch (e) {\r\n      if (e instanceof DOMException && e.name === \"AbortError\") return;\r\n      setDepthError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setDepthLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadTrades = async (id: string, signal?: AbortSignal) => {\r\n    setTradesError(null);\r\n    setTradesLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/exchange/marketdata/trades?market_id=${encodeURIComponent(id)}&limit=30`, {\r\n        cache: \"no-store\",\r\n        signal,\r\n      });\r\n      const json = (await res.json().catch(() => null)) as TradesResponse | null;\r\n      if (!res.ok) throw new Error(\"trades_unavailable\");\r\n      setTrades(json);\r\n    } catch (e) {\r\n      if (e instanceof DOMException && e.name === \"AbortError\") return;\r\n      setTradesError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setTradesLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadCandles = async (id: string, limit: number, signal?: AbortSignal) => {\r\n    setCandlesError(null);\r\n    setCandlesLoading(true);\r\n    try {\r\n      const res = await fetch(\r\n        `/api/exchange/marketdata/candles?market_id=${encodeURIComponent(id)}&interval=1m&limit=${encodeURIComponent(String(limit))}`,\r\n        { cache: \"no-store\", signal },\r\n      );\r\n      const json = (await res.json().catch(() => null)) as CandlesResponse | null;\r\n      if (!res.ok) throw new Error(\"candles_unavailable\");\r\n      setCandles(json);\r\n    } catch (e) {\r\n      if (e instanceof DOMException && e.name === \"AbortError\") return;\r\n      setCandlesError(e instanceof Error ? e.message : String(e));\r\n    } finally {\r\n      setCandlesLoading(false);\r\n    }\r\n  };\r\n\r\n  // Live updates: prefer SSE stream; fall back to fetch polling.\r\n  useEffect(() => {\r\n    if (!marketId) return;\r\n    const controller = new AbortController();\r\n    let interval: number | null = null;\r\n    let retryTimeout: number | null = null;\r\n\r\n    const stopSse = () => {\r\n      try {\r\n        esRef.current?.close();\r\n      } catch {\r\n        // ignore\r\n      }\r\n      esRef.current = null;\r\n    };\r\n\r\n    const stopPolling = () => {\r\n      if (!interval) return;\r\n      window.clearInterval(interval);\r\n      interval = null;\r\n    };\r\n\r\n    const stopRetry = () => {\r\n      if (!retryTimeout) return;\r\n      window.clearTimeout(retryTimeout);\r\n      retryTimeout = null;\r\n    };\r\n\r\n    const visible = () => document.visibilityState === \"visible\";\r\n\r\n    const startFallbackPolling = () => {\r\n      if (segment === \"book\") {\r\n        if (visible()) void loadDepth(marketId, controller.signal);\r\n        interval = window.setInterval(() => {\r\n          if (!visible()) return;\r\n          void loadDepth(marketId, controller.signal);\r\n        }, 2200);\r\n      } else if (segment === \"trades\") {\r\n        if (visible()) void loadTrades(marketId, controller.signal);\r\n        interval = window.setInterval(() => {\r\n          if (!visible()) return;\r\n          void loadTrades(marketId, controller.signal);\r\n        }, 2800);\r\n      }\r\n    };\r\n\r\n    const scheduleSseRetry = (delayMs: number) => {\r\n      if (!visible()) return;\r\n      if (segment !== \"book\" && segment !== \"trades\") return;\r\n      if (typeof EventSource === \"undefined\") return;\r\n      if (esRef.current) return;\r\n      if (retryTimeout) return;\r\n\r\n      retryTimeout = window.setTimeout(() => {\r\n        retryTimeout = null;\r\n        if (!visible()) return;\r\n        if (segment === \"book\") startBookSse();\r\n        else if (segment === \"trades\") startTradesSse();\r\n      }, delayMs);\r\n    };\r\n\r\n    const ensureFallbackPolling = () => {\r\n      if (!visible()) return;\r\n      if (interval) return;\r\n      startFallbackPolling();\r\n    };\r\n\r\n    const startBookSse = () => {\r\n      if (!visible()) return;\r\n      stopSse();\r\n      stopRetry();\r\n      stopPolling();\r\n      setDepthError(null);\r\n      setDepthLoading(true);\r\n      try {\r\n        const url = `/api/exchange/marketdata/stream?market_id=${encodeURIComponent(marketId)}&topics=depth&levels=12&poll_ms=1000&heartbeat_ms=15000`;\r\n        const es = new EventSource(url);\r\n        es.addEventListener(\"depth\", (evt) => {\r\n          try {\r\n            const data = JSON.parse(String((evt as MessageEvent).data ?? \"{}\"));\r\n            setDepth(data as any);\r\n          } catch {\r\n            // ignore\r\n          } finally {\r\n            setDepthLoading(false);\r\n          }\r\n        });\r\n        es.onerror = () => {\r\n          // Keep UI usable: stop SSE, fall back to polling.\r\n          stopSse();\r\n          setDepthLoading(false);\r\n          ensureFallbackPolling();\r\n          scheduleSseRetry(4500);\r\n        };\r\n        esRef.current = es;\r\n      } catch {\r\n        stopSse();\r\n        setDepthLoading(false);\r\n        ensureFallbackPolling();\r\n        scheduleSseRetry(4500);\r\n      }\r\n    };\r\n\r\n    const startTradesSse = () => {\r\n      if (!visible()) return;\r\n      stopSse();\r\n      stopRetry();\r\n      stopPolling();\r\n      setTradesError(null);\r\n      setTradesLoading(true);\r\n      try {\r\n        const url = `/api/exchange/marketdata/stream?market_id=${encodeURIComponent(marketId)}&topics=trades&trades_limit=30&trades_delta=1&poll_ms=1200&heartbeat_ms=15000`;\r\n        const es = new EventSource(url);\r\n        es.addEventListener(\"trades\", (evt) => {\r\n          try {\r\n            const data = JSON.parse(String((evt as MessageEvent).data ?? \"{}\")) as any;\r\n            const incoming = Array.isArray(data?.trades) ? data.trades : [];\r\n            const mode = String(data?.mode ?? \"snapshot\");\r\n            if (mode === \"delta\") {\r\n              setTrades((prev) => {\r\n                const prevRows = prev?.trades ?? [];\r\n                const combined = [...incoming, ...prevRows];\r\n                const seen = new Set<string>();\r\n                const out = [] as any[];\r\n                for (const t of combined) {\r\n                  const id = String(t?.id ?? \"\");\r\n                  if (!id || seen.has(id)) continue;\r\n                  seen.add(id);\r\n                  out.push(t);\r\n                  if (out.length >= 30) break;\r\n                }\r\n                return { trades: out } as any;\r\n              });\r\n            } else {\r\n              setTrades({ trades: incoming } as any);\r\n            }\r\n          } catch {\r\n            // ignore\r\n          } finally {\r\n            setTradesLoading(false);\r\n          }\r\n        });\r\n        es.onerror = () => {\r\n          stopSse();\r\n          setTradesLoading(false);\r\n          ensureFallbackPolling();\r\n          scheduleSseRetry(4500);\r\n        };\r\n        esRef.current = es;\r\n      } catch {\r\n        stopSse();\r\n        setTradesLoading(false);\r\n        ensureFallbackPolling();\r\n        scheduleSseRetry(4500);\r\n      }\r\n    };\r\n\r\n    const startChartPolling = () => {\r\n      const limit = candleRange === \"6h\" ? 360 : candleRange === \"8h\" ? 500 : 60;\r\n      if (visible()) void loadCandles(marketId, limit, controller.signal);\r\n      interval = window.setInterval(() => {\r\n        if (!visible()) return;\r\n        void loadCandles(marketId, limit, controller.signal);\r\n      }, 15_000);\r\n    };\r\n\r\n    const connect = () => {\r\n      if (!visible()) return;\r\n      if (segment === \"book\") {\r\n        if (typeof EventSource !== \"undefined\") startBookSse();\r\n        else startFallbackPolling();\r\n      } else if (segment === \"trades\") {\r\n        if (typeof EventSource !== \"undefined\") startTradesSse();\r\n        else startFallbackPolling();\r\n      } else if (segment === \"chart\") {\r\n        stopSse();\r\n        stopRetry();\r\n        startChartPolling();\r\n      } else {\r\n        stopSse();\r\n        stopRetry();\r\n      }\r\n    };\r\n\r\n    const disconnect = () => {\r\n      stopSse();\r\n      stopRetry();\r\n      stopPolling();\r\n    };\r\n\r\n    const onVis = () => {\r\n      if (document.visibilityState === \"visible\") {\r\n        disconnect();\r\n        connect();\r\n      } else {\r\n        disconnect();\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"visibilitychange\", onVis);\r\n    connect();\r\n\r\n    return () => {\r\n      document.removeEventListener(\"visibilitychange\", onVis);\r\n      disconnect();\r\n      controller.abort();\r\n    };\r\n  }, [marketId, segment, candleRange]);\r\n\r\n  // When switching pairs, clear panel state (avoids showing stale book/trades briefly).\r\n  useEffect(() => {\r\n    setDepth(null);\r\n    setTrades(null);\r\n    setCandles(null);\r\n    setDepthError(null);\r\n    setTradesError(null);\r\n    setCandlesError(null);\r\n  }, [marketId]);\r\n\r\n  const closeSeries = useMemo(() => {\r\n    const rows = candles?.candles ?? [];\r\n    const pts = rows\r\n      .map((c) => toNum(c.close))\r\n      .filter((n): n is number => typeof n === \"number\" && Number.isFinite(n));\r\n    return pts;\r\n  }, [candles]);\r\n\r\n  const spark = useMemo(() => {\r\n    const pts = closeSeries;\r\n    if (pts.length < 2) return null;\r\n    const min = Math.min(...pts);\r\n    const max = Math.max(...pts);\r\n    const span = max - min || 1;\r\n    const w = 100;\r\n    const h = 40;\r\n    const step = w / (pts.length - 1);\r\n\r\n    const d = pts\r\n      .map((v, i) => {\r\n        const x = i * step;\r\n        const y = h - ((v - min) / span) * h;\r\n        return `${i === 0 ? \"M\" : \"L\"}${x.toFixed(2)} ${y.toFixed(2)}`;\r\n      })\r\n      .join(\" \");\r\n\r\n    const up = pts[pts.length - 1]! >= pts[0]!;\r\n    return {\r\n      d,\r\n      up,\r\n      min,\r\n      max,\r\n      first: pts[0]!,\r\n      last: pts[pts.length - 1]!,\r\n    };\r\n  }, [closeSeries]);\r\n\r\n  const placeOrder = async () => {\r\n    if (!marketId) {\r\n      setPlaceStatus({ kind: \"error\", message: \"Market not available.\" });\r\n      return;\r\n    }\r\n    if (market?.is_halted) {\r\n      setPlaceStatus({ kind: \"error\", message: \"This market is halted.\" });\r\n      return;\r\n    }\r\n\r\n    const qty = quantity.trim();\r\n    if (!qty) {\r\n      setPlaceStatus({ kind: \"error\", message: \"Enter an amount.\" });\r\n      return;\r\n    }\r\n    if (orderType === \"limit\") {\r\n      const p = limitPrice.trim();\r\n      if (!p) {\r\n        setPlaceStatus({ kind: \"error\", message: \"Enter a limit price.\" });\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Prevent accidental double-taps.\r\n    const now = Date.now();\r\n    if (now - lastPlacedAtRef.current < 900) return;\r\n    lastPlacedAtRef.current = now;\r\n\r\n    setPlaceStatus({ kind: \"placing\" });\r\n    try {\r\n      const body =\r\n        orderType === \"limit\"\r\n          ? {\r\n              market_id: marketId,\r\n              side,\r\n              type: \"limit\",\r\n              price: limitPrice.trim(),\r\n              quantity: qty,\r\n            }\r\n          : {\r\n              market_id: marketId,\r\n              side,\r\n              type: \"market\",\r\n              quantity: qty,\r\n            };\r\n\r\n      const res = await fetch(\"/api/exchange/orders\", {\r\n        method: \"POST\",\r\n        credentials: \"include\",\r\n        headers: { \"content-type\": \"application/json\" },\r\n        body: JSON.stringify(body),\r\n      });\r\n      const text = await res.text();\r\n      let json: any = null;\r\n      try {\r\n        json = JSON.parse(text);\r\n      } catch {\r\n        json = { _raw: text };\r\n      }\r\n\r\n      if (!res.ok) {\r\n        const msg = typeof json?.error === \"string\" ? json.error : `http_${res.status}`;\r\n        setPlaceStatus({ kind: \"error\", message: msg });\r\n        return;\r\n      }\r\n\r\n      setPlaceStatus({ kind: \"ok\", message: \"Order placed\" });\r\n      setQuantity(\"\");\r\n      // Keep limit price for rapid re-entry.\r\n    } catch (e) {\r\n      setPlaceStatus({ kind: \"error\", message: e instanceof Error ? e.message : String(e) });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"space-y-4\">\r\n      <header className=\"space-y-2\">\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <div className=\"min-w-0\">\r\n            <div className=\"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]\">Trade</div>\r\n            <div className=\"mt-0.5 flex items-center gap-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setSheetOpen(true)}\r\n                className=\"truncate rounded-xl bg-[var(--v2-surface)] px-2 py-1 text-xl font-extrabold tracking-tight shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]\"\r\n                title=\"Change pair\"\r\n              >\r\n                {pairLabel}\r\n              </button>\r\n              <span className=\"rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface)] px-2 py-1 text-[12px] font-semibold text-[var(--v2-muted)]\">\r\n                Spot\r\n              </span>\r\n            </div>\r\n            <div className=\"mt-1 flex flex-wrap items-center gap-3 text-[13px]\">\r\n              <span className=\"font-semibold text-[var(--v2-text)]\">\r\n                {marketLoading ? \"…\" : fmtPrice(last)}\r\n              </span>\r\n              <span className={`font-semibold ${changeClass}`}>{marketLoading ? \"…\" : changeText}</span>\r\n              {market?.is_halted ? (\r\n                <span className=\"rounded-full border border-[var(--v2-border)] bg-[var(--warn-bg)] px-2 py-0.5 text-[11px] font-semibold text-[var(--warn)]\">\r\n                  Halted\r\n                </span>\r\n              ) : null}\r\n              {marketError ? <span className=\"text-[12px] text-[var(--down)]\">Live data unavailable</span> : null}\r\n            </div>\r\n\r\n            <div className=\"mt-2 flex flex-wrap items-center gap-3 text-[12px] text-[var(--v2-muted)]\">\r\n              <span>24h H {marketLoading ? \"…\" : fmtPrice(high24h)}</span>\r\n              <span>24h L {marketLoading ? \"…\" : fmtPrice(low24h)}</span>\r\n              <span>Vol {marketLoading ? \"…\" : fmtPrice(volQuote)} {String(pair.quote).toUpperCase()}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <V2Button variant=\"primary\" size=\"sm\" onClick={() => setSheetOpen(true)}>\r\n            Pairs\r\n          </V2Button>\r\n        </div>\r\n      </header>\r\n\r\n      <V2Tabs tabs={tabs} activeId={segment} onChange={(id) => setSegment(id as any)} />\r\n\r\n      <V2Card>\r\n        <V2CardHeader\r\n          title={segment === \"chart\" ? \"Chart\" : segment === \"book\" ? \"Order book\" : \"Recent trades\"}\r\n          subtitle={segment === \"chart\" ? \"Price action\" : segment === \"book\" ? \"Liquidity\" : \"Latest fills\"}\r\n        />\r\n        <V2CardBody>\r\n          {segment === \"chart\" ? (\r\n            candlesError ? (\r\n              <div className=\"text-sm text-[var(--down)]\">Chart unavailable.</div>\r\n            ) : candlesLoading && !candles ? (\r\n              <V2Skeleton className=\"h-48 w-full\" />\r\n            ) : spark ? (\r\n              <div className=\"space-y-3\">\r\n                <div className=\"grid grid-cols-3 gap-2\">\r\n                  {([\r\n                    { id: \"1h\", label: \"1H\" },\r\n                    { id: \"6h\", label: \"6H\" },\r\n                    { id: \"8h\", label: \"8H\" },\r\n                  ] as const).map((r) => {\r\n                    const active = candleRange === r.id;\r\n                    return (\r\n                      <button\r\n                        key={r.id}\r\n                        type=\"button\"\r\n                        onClick={() => setCandleRange(r.id)}\r\n                        className={\r\n                          \"h-10 rounded-xl border px-3 text-[13px] font-semibold shadow-[var(--v2-shadow-sm)] \" +\r\n                          (active\r\n                            ? \"border-[var(--v2-border)] bg-[var(--v2-surface-2)] text-[var(--v2-text)]\"\r\n                            : \"border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-muted)] hover:bg-[var(--v2-surface-2)]\")\r\n                        }\r\n                      >\r\n                        {r.label}\r\n                      </button>\r\n                    );\r\n                  })}\r\n                </div>\r\n\r\n                <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] p-3\">\r\n                  <svg viewBox=\"0 0 100 40\" width=\"100%\" height=\"180\" preserveAspectRatio=\"none\" aria-label=\"Price chart\">\r\n                    <path\r\n                      d={spark.d}\r\n                      fill=\"none\"\r\n                      stroke={spark.up ? \"var(--up)\" : \"var(--down)\"}\r\n                      strokeWidth=\"2\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeLinecap=\"round\"\r\n                    />\r\n                  </svg>\r\n                  <div className=\"mt-2 flex items-center justify-between gap-3 text-[12px]\">\r\n                    <div className=\"text-[var(--v2-muted)]\">min {fmtPrice(String(spark.min))}</div>\r\n                    <div className={`font-semibold ${spark.up ? \"text-[var(--up)]\" : \"text-[var(--down)]\"}`}>last {fmtPrice(String(spark.last))}</div>\r\n                    <div className=\"text-[var(--v2-muted)]\">max {fmtPrice(String(spark.max))}</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-[12px] text-[var(--v2-muted)]\">No trades yet.</div>\r\n            )\r\n          ) : segment === \"book\" ? (\r\n            depthError ? (\r\n              <div className=\"text-sm text-[var(--down)]\">Order book unavailable.</div>\r\n            ) : depthLoading && !depth ? (\r\n              <V2Skeleton className=\"h-48 w-full\" />\r\n            ) : (\r\n              <div className=\"grid grid-cols-2 gap-3\">\r\n                <div>\r\n                  <div className=\"mb-2 text-[12px] font-semibold text-[var(--v2-muted)]\">Bids</div>\r\n                  <div className=\"grid gap-1\">\r\n                    {(depth?.depth?.bids ?? []).slice(0, 12).map((r, i) => (\r\n                      <div key={`b:${i}`} className=\"flex items-center justify-between gap-2 rounded-xl bg-[var(--v2-surface-2)] px-2 py-1\">\r\n                        <div className=\"font-mono text-[12px] font-semibold text-[var(--up)]\">{fmtPrice(r.price)}</div>\r\n                        <div className=\"font-mono text-[12px] text-[var(--v2-text)]\">{fmtPrice(r.quantity)}</div>\r\n                      </div>\r\n                    ))}\r\n                    {(depth?.depth?.bids ?? []).length === 0 ? (\r\n                      <div className=\"text-[12px] text-[var(--v2-muted)]\">No bids.</div>\r\n                    ) : null}\r\n                  </div>\r\n                </div>\r\n                <div>\r\n                  <div className=\"mb-2 text-[12px] font-semibold text-[var(--v2-muted)]\">Asks</div>\r\n                  <div className=\"grid gap-1\">\r\n                    {(depth?.depth?.asks ?? []).slice(0, 12).map((r, i) => (\r\n                      <div key={`a:${i}`} className=\"flex items-center justify-between gap-2 rounded-xl bg-[var(--v2-surface-2)] px-2 py-1\">\r\n                        <div className=\"font-mono text-[12px] font-semibold text-[var(--down)]\">{fmtPrice(r.price)}</div>\r\n                        <div className=\"font-mono text-[12px] text-[var(--v2-text)]\">{fmtPrice(r.quantity)}</div>\r\n                      </div>\r\n                    ))}\r\n                    {(depth?.depth?.asks ?? []).length === 0 ? (\r\n                      <div className=\"text-[12px] text-[var(--v2-muted)]\">No asks.</div>\r\n                    ) : null}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )\r\n          ) : (\r\n            tradesError ? (\r\n              <div className=\"text-sm text-[var(--down)]\">Trades unavailable.</div>\r\n            ) : tradesLoading && !trades ? (\r\n              <V2Skeleton className=\"h-48 w-full\" />\r\n            ) : (\r\n              <div className=\"grid gap-1\">\r\n                {(trades?.trades ?? []).slice(0, 30).map((t) => {\r\n                  const time = t.created_at ? new Date(t.created_at).toLocaleTimeString() : \"\";\r\n                  return (\r\n                    <div key={t.id} className=\"flex items-center justify-between gap-2 rounded-xl bg-[var(--v2-surface-2)] px-2 py-1\">\r\n                      <div className=\"font-mono text-[12px] text-[var(--v2-muted)]\">{time}</div>\r\n                      <div className=\"font-mono text-[12px] font-semibold text-[var(--v2-text)]\">{fmtPrice(t.price)}</div>\r\n                      <div className=\"font-mono text-[12px] text-[var(--v2-text)]\">{fmtPrice(t.quantity)}</div>\r\n                    </div>\r\n                  );\r\n                })}\r\n                {(trades?.trades ?? []).length === 0 ? (\r\n                  <div className=\"text-[12px] text-[var(--v2-muted)]\">No trades yet.</div>\r\n                ) : null}\r\n              </div>\r\n            )\r\n          )}\r\n        </V2CardBody>\r\n      </V2Card>\r\n\r\n      <V2Card>\r\n        <V2CardHeader title=\"Place order\" subtitle={market?.is_halted ? \"Market halted\" : \"Market / Limit\"} />\r\n        <V2CardBody>\r\n          <div className=\"grid gap-3\">\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              <V2Button variant={side === \"buy\" ? \"primary\" : \"secondary\"} fullWidth onClick={() => setSide(\"buy\")}>\r\n                Buy\r\n              </V2Button>\r\n              <V2Button variant={side === \"sell\" ? \"danger\" : \"secondary\"} fullWidth onClick={() => setSide(\"sell\")}>\r\n                Sell\r\n              </V2Button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              <V2Button variant={orderType === \"market\" ? \"primary\" : \"secondary\"} fullWidth onClick={() => setOrderType(\"market\")}>\r\n                Market\r\n              </V2Button>\r\n              <V2Button variant={orderType === \"limit\" ? \"primary\" : \"secondary\"} fullWidth onClick={() => setOrderType(\"limit\")}>\r\n                Limit\r\n              </V2Button>\r\n            </div>\r\n\r\n            {orderType === \"limit\" ? (\r\n              <div className=\"grid gap-2\">\r\n                <div className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Limit price ({pair.quote})</div>\r\n                <V2Input inputMode=\"decimal\" placeholder={`0.00 ${pair.quote}`} value={limitPrice} onChange={(e) => setLimitPrice(e.target.value)} />\r\n              </div>\r\n            ) : null}\r\n\r\n            <div className=\"grid gap-2\">\r\n              <div className=\"text-[12px] font-semibold text-[var(--v2-muted)]\">Amount</div>\r\n              <V2Input inputMode=\"decimal\" placeholder={`0.00 ${pair.base}`} value={quantity} onChange={(e) => setQuantity(e.target.value)} />\r\n            </div>\r\n\r\n            <V2Button\r\n              variant={side === \"buy\" ? \"primary\" : \"danger\"}\r\n              size=\"lg\"\r\n              fullWidth\r\n              disabled={placeStatus.kind === \"placing\" || !marketId || Boolean(market?.is_halted)}\r\n              onClick={() => void placeOrder()}\r\n            >\r\n              {placeStatus.kind === \"placing\" ? \"Placing…\" : side === \"buy\" ? \"Buy\" : \"Sell\"}\r\n            </V2Button>\r\n\r\n            {placeStatus.kind === \"ok\" ? (\r\n              <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--up-bg)] px-3 py-2 text-[13px] font-semibold text-[var(--up)]\">\r\n                {placeStatus.message ?? \"Order placed\"}\r\n              </div>\r\n            ) : placeStatus.kind === \"error\" ? (\r\n              <div className=\"rounded-2xl border border-[var(--v2-border)] bg-[var(--down-bg)] px-3 py-2 text-[13px] font-semibold text-[var(--down)]\">\r\n                {placeStatus.message ?? \"Order failed\"}\r\n              </div>\r\n            ) : null}\r\n\r\n            <div className=\"text-[12px] text-[var(--v2-muted)]\">\r\n              Next: fee preview, balance checks, and one-tap confirm.\r\n            </div>\r\n          </div>\r\n        </V2CardBody>\r\n      </V2Card>\r\n\r\n      <V2Sheet open={sheetOpen} title=\"Select a pair\" onClose={() => setSheetOpen(false)}>\r\n        <div className=\"grid gap-3\">\r\n          <V2Input value={pairSearch} onChange={(e) => setPairSearch(e.target.value)} placeholder=\"Search BTC, ETH…\" />\r\n\r\n          <div className=\"grid gap-2\">\r\n            {(markets.length ? markets : [{\r\n              id: \"fallback\",\r\n              symbol: \"BTC/USDT\",\r\n              is_halted: false,\r\n              base_symbol: pair.base,\r\n              quote_symbol: pair.quote,\r\n              stats: null,\r\n            } as any]).filter((m) => {\r\n              const q = pairSearch.trim().toUpperCase();\r\n              if (!q) return true;\r\n              const label = `${String(m.base_symbol).toUpperCase()}/${String(m.quote_symbol).toUpperCase()}`;\r\n              return label.includes(q) || String(m.symbol).toUpperCase().includes(q);\r\n            }).slice(0, 60).map((m) => {\r\n              const p = { base: String(m.base_symbol).toUpperCase(), quote: String(m.quote_symbol).toUpperCase() };\r\n              const label = `${p.base}/${p.quote}`;\r\n              const active = p.base === pair.base && p.quote === pair.quote;\r\n              const last = m.stats?.last ?? null;\r\n              const chg = pctChange(m.stats?.open ?? null, m.stats?.last ?? null);\r\n              const chgText = chg == null ? \"—\" : `${chg >= 0 ? \"+\" : \"\"}${chg.toFixed(2)}%`;\r\n              const chgClass = chg == null ? \"text-[var(--v2-muted)]\" : chg >= 0 ? \"text-[var(--up)]\" : \"text-[var(--down)]\";\r\n              return (\r\n                <button\r\n                  key={label}\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setPair(p);\r\n                    setSheetOpen(false);\r\n                  }}\r\n                  className={\r\n                    \"flex h-12 items-center justify-between rounded-2xl border px-4 text-left shadow-[var(--v2-shadow-sm)] transition \" +\r\n                    (active\r\n                      ? \"border-[color-mix(in_srgb,var(--v2-accent)_55%,transparent)] bg-[color-mix(in_srgb,var(--v2-accent)_10%,transparent)]\"\r\n                      : \"border-[var(--v2-border)] bg-[var(--v2-surface)] hover:bg-[var(--v2-surface-2)]\")\r\n                  }\r\n                >\r\n                  <div className=\"text-[15px] font-semibold text-[var(--v2-text)]\">{label}</div>\r\n                  <div className=\"text-right\">\r\n                    <div className=\"text-[12px] font-semibold text-[var(--v2-text)]\">{marketLoading ? \"…\" : fmtPrice(last)}</div>\r\n                    <div className={`text-[11px] font-semibold ${chgClass}`}>{marketLoading ? \"…\" : chgText}</div>\r\n                  </div>\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </V2Sheet>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}