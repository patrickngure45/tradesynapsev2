module.exports=[556836,a=>{"use strict";var b=a.i(187924);function c(a){let b=a?.variant??"secondary",c=a?.size??"md";return["inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55","lg"===c?"h-12 px-5 text-[15px]":"sm"===c?"h-9 px-3 text-[13px]":"h-11 px-4 text-[14px]","primary"===b?"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"danger"===b?"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"ghost"===b?"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]":"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]",a?.fullWidth?"w-full":"",a?.className??""].filter(Boolean).join(" ")}let d=a.i(572131).forwardRef(function({variant:a,size:d,fullWidth:e,className:f,type:g,...h},i){return(0,b.jsx)("button",{ref:i,type:g??"button",className:c({variant:a,size:d,fullWidth:e,className:f}),...h})});a.s(["V2Button",0,d,"v2ButtonClassName",()=>c])},214373,a=>{"use strict";var b=a.i(187924);function c({children:a,className:c=""}){return(0,b.jsx)("section",{className:"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] "+c,children:a})}function d({title:a,subtitle:c,right:d}){return(0,b.jsxs)("header",{className:"flex items-start justify-between gap-3 px-4 pt-4",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:a}),c?(0,b.jsx)("div",{className:"mt-0.5 text-[13px] text-[var(--v2-muted)]",children:c}):null]}),d?(0,b.jsx)("div",{className:"shrink-0",children:d}):null]})}function e({children:a}){return(0,b.jsx)("div",{className:"px-4 pb-4 pt-3",children:a})}a.s(["V2Card",()=>c,"V2CardBody",()=>e,"V2CardHeader",()=>d])},782691,a=>{"use strict";var b=a.i(187924);function c({className:a=""}){return(0,b.jsx)("div",{className:"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] "+a,"aria-hidden":"true"})}a.s(["V2Skeleton",()=>c])},246435,a=>{"use strict";var b=a.i(187924),c=a.i(238246),d=a.i(572131),e=a.i(556836),f=a.i(214373),g=a.i(782691);function h(a){let b=Number(String(a??""));if(!Number.isFinite(b))return"—";if(0===b)return"0";let c=Math.abs(b);return b.toLocaleString(void 0,{maximumFractionDigits:c>=1e3?2:c>=1?4:c>=.01?6:8})}function i(){let[a,i]=(0,d.useState)([]),[j,k]=(0,d.useState)(!0),[l,m]=(0,d.useState)(null),n=(0,d.useRef)(!1),o=(0,d.useRef)(null),p=(0,d.useRef)(0),q=(0,d.useRef)(!1),r=(0,d.useRef)(0),s=(0,d.useRef)(null),t=async()=>{let a=++r.current;s.current?.abort();let b=new AbortController;s.current=b,m(null),n.current||k(!0);try{let c=await fetch("/api/p2p/orders",{cache:"no-store",credentials:"include",signal:b.signal}),d=await c.json().catch(()=>null);if(!c.ok){let a="string"==typeof d?.error?d.error:`http_${c.status}`;throw Error(a)}if(a!==r.current)return;i(Array.isArray(d?.orders)?d.orders:[]),n.current=!0}catch(b){if(b instanceof DOMException&&"AbortError"===b.name||a!==r.current)return;n.current||m(b instanceof Error?b.message:String(b))}finally{a===r.current&&k(!1)}};(0,d.useEffect)(()=>{q.current=a.some(a=>{let b=String(a.status||"").toLowerCase();return"created"===b||"paid_confirmed"===b||"disputed"===b})},[a]),(0,d.useEffect)(()=>{t();let a=null,b=()=>{a&&(window.clearTimeout(a),a=null)},c=()=>{b();let d=o.current?q.current?25e3:45e3:15e3;a=window.setTimeout(()=>{a=null,"visible"===document.visibilityState&&t(),c()},d)},d=()=>{"visible"===document.visibilityState?(t(),c()):b()};return document.addEventListener("visibilitychange",d),c(),()=>{document.removeEventListener("visibilitychange",d),b(),s.current?.abort()}},[]),(0,d.useEffect)(()=>{let a=()=>{try{o.current?.close()}catch{}o.current=null},b=()=>{let a=Date.now();a-p.current<900||(p.current=a,"visible"===document.visibilityState&&t())},c=()=>{if(!("visible"!==document.visibilityState||"u"<typeof EventSource)&&!o.current)try{let a=new EventSource("/api/notifications/stream",{withCredentials:!0});a.addEventListener("notification",a=>{try{var c;let d=JSON.parse(String(a.data??"{}"));c=String(d?.type??""),String(c||"").startsWith("p2p_")&&b()}catch{}}),a.addEventListener("ready",()=>b()),a.onerror=()=>{},o.current=a}catch{a()}},d=()=>{"visible"===document.visibilityState?c():a()};return document.addEventListener("visibilitychange",d),c(),()=>{document.removeEventListener("visibilitychange",d),a()}},[]);let{active:u,history:v,missingDetailsCount:w}=(0,d.useMemo)(()=>{let b=a.filter(a=>["created","paid_confirmed","disputed"].includes(String(a.status))),c=a.filter(a=>!["created","paid_confirmed","disputed"].includes(String(a.status))),d=b.filter(a=>!1===a.payment_details_ready).length;return{active:b,history:c,missingDetailsCount:d}},[a]),x=a=>(0,b.jsx)("div",{className:"grid gap-2",children:a.map(a=>{let d,e,f="BUY"===a.my_side?"text-[var(--up)]":"text-[var(--down)]";return(0,b.jsx)(c.default,{href:`/v2/p2p/orders/${encodeURIComponent(a.id)}`,className:"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("div",{className:`text-[12px] font-bold ${f}`,children:a.my_side}),(0,b.jsxs)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:[h(a.amount_asset)," ",String(a.asset_symbol||"—")]}),(e="created"===(d=String(a.status||"").toLowerCase())?"text-[var(--v2-accent)]":"paid_confirmed"===d?"text-[var(--warn)]":"completed"===d?"text-[var(--up)]":"disputed"===d?"text-[var(--down)]":"text-[var(--v2-muted)]",(0,b.jsx)("span",{className:`rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold ${e}`,children:d.replaceAll("_"," ")||"—"}))]}),(0,b.jsxs)("div",{className:"mt-1 text-[12px] text-[var(--v2-muted)]",children:["≈ ",h(a.amount_fiat)," ",String(a.fiat_currency||"")]}),(0,b.jsx)("div",{className:"mt-1 text-[12px] text-[var(--v2-muted)]",children:function(a){if(!a)return"";try{return new Date(a).toLocaleString()}catch{return String(a)}}(a.created_at)})]}),!1===a.payment_details_ready?(0,b.jsx)("span",{className:"shrink-0 rounded-full border border-[var(--v2-border)] bg-[color-mix(in_srgb,var(--warn)_10%,transparent)] px-2 py-0.5 text-[11px] font-semibold text-[var(--warn)]",children:"Payment details missing"}):null]})},a.id)})});return(0,b.jsxs)("main",{className:"space-y-4",children:[(0,b.jsxs)("header",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]",children:"P2P"}),(0,b.jsx)("h1",{className:"text-2xl font-extrabold tracking-tight",children:"My orders"})]}),(0,b.jsx)(c.default,{href:"/v2/p2p",className:"rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-2 text-[12px] font-semibold text-[var(--v2-text)]",children:"Marketplace"})]}),(0,b.jsx)("p",{className:"text-sm text-[var(--v2-muted)]",children:"Active orders first, then history."})]}),w>0?(0,b.jsxs)("div",{className:"rounded-2xl border border-[var(--v2-border)] bg-[color-mix(in_srgb,var(--warn)_10%,transparent)] px-3 py-3 text-[12px] text-[var(--v2-text)]",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Action needed:"})," ",w," active ",1===w?"order is":"orders are"," missing seller payment details."]}):null,l&&0===a.length?(0,b.jsxs)(f.V2Card,{children:[(0,b.jsx)(f.V2CardHeader,{title:"Orders unavailable",subtitle:"Sign in and try again."}),(0,b.jsxs)(f.V2CardBody,{children:[(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:String(l)}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)(e.V2Button,{variant:"primary",fullWidth:!0,onClick:()=>void t(),children:"Retry"})})]})]}):j&&0===a.length?(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(g.V2Skeleton,{className:"h-20"}),(0,b.jsx)(g.V2Skeleton,{className:"h-20"}),(0,b.jsx)(g.V2Skeleton,{className:"h-20"})]}):0===a.length?(0,b.jsxs)(f.V2Card,{children:[(0,b.jsx)(f.V2CardHeader,{title:"No P2P orders",subtitle:"Your P2P activity will appear here."}),(0,b.jsx)(f.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Start from the marketplace to create an order."})})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-[13px] font-semibold text-[var(--v2-text)]",children:"Active"}),(0,b.jsx)("div",{className:"text-[12px] text-[var(--v2-muted)]",children:u.length})]}),0===u.length?(0,b.jsxs)(f.V2Card,{children:[(0,b.jsx)(f.V2CardHeader,{title:"No active orders",subtitle:"You’re all caught up."}),(0,b.jsx)(f.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Completed/canceled orders are in history."})})]}):x(u)]}),(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-[13px] font-semibold text-[var(--v2-text)]",children:"History"}),(0,b.jsx)("div",{className:"text-[12px] text-[var(--v2-muted)]",children:v.length})]}),0===v.length?(0,b.jsxs)(f.V2Card,{children:[(0,b.jsx)(f.V2CardHeader,{title:"No history",subtitle:"No completed P2P orders yet."}),(0,b.jsx)(f.V2CardBody,{children:(0,b.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Once you finish a trade, it’ll appear here."})})]}):x(v.slice(0,30))]})]})]})}a.s(["P2POrdersClient",()=>i])}];

//# sourceMappingURL=src_e948f1be._.js.map