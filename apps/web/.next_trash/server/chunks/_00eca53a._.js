module.exports=[289064,(e,t,r)=>{var i,n;n=i||(i={}),function(t){var r="object"==typeof globalThis?globalThis:e.g,i=o(n);function o(e,t){return function(r,i){Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0!==r.Reflect&&(i=o(r.Reflect,i)),t(i,r),void 0===r.Reflect&&(r.Reflect=n)}(function(e,t){var r,i=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,l=({__proto__:[]})instanceof Array,c=!a&&!l,u={create:a?function(){return j(Object.create(null))}:l?function(){return j({__proto__:null})}:function(){return j({})},has:c?function(e,t){return i.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return i.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},p=Object.getPrototypeOf(Function),h="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:function(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function i(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(i.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),i.prototype.has=function(e){return this._find(e,!1)>=0},i.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},i.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},i.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,O(t,this._cacheKey)&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},i.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},i.prototype.keys=function(){return new r(this._keys,this._values,n)},i.prototype.values=function(){return new r(this._keys,this._values,o)},i.prototype.entries=function(){return new r(this._keys,this._values,a)},i.prototype["@@iterator"]=function(){return this.entries()},i.prototype[s]=function(){return this.entries()},i.prototype._find=function(e,t){if(!O(this._cacheKey,e)){this._cacheIndex=-1;for(var r=0;r<this._keys.length;r++)if(O(this._keys[r],e)){this._cacheIndex=r;break}}return this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},i;function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}(),f="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.keys()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}(),d="function"==typeof WeakMap?WeakMap:function(){var e=u.create(),t=n();function r(){this._key=n()}return r.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&u.has(t,this._key)},r.prototype.get=function(e){var t=o(e,!1);return void 0!==t?u.get(t,this._key):void 0},r.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},r.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},r.prototype.clear=function(){this._key=n()},r;function n(){var t;do t="@@WeakMap@@"+function(){var e=function(e){if("function"==typeof Uint8Array){var t=new Uint8Array(16);return"u">typeof crypto?crypto.getRandomValues(t):"u">typeof msCrypto?msCrypto.getRandomValues(t):s(t,16),t}return s(Array(16),16)}(0);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",r=0;r<16;++r){var i=e[r];(4===r||6===r||8===r)&&(t+="-"),i<16&&(t+="0"),t+=i.toString(16).toLowerCase()}return t}();while(u.has(e,t))return e[t]=!0,t}function o(e,r){if(!i.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function s(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}}(),y=n?Symbol.for("@reflect-metadata:registry"):void 0,g=(!E(y)&&x(t.Reflect)&&Object.isExtensible(t.Reflect)&&(r=t.Reflect[y]),E(r)&&(r=function(){E(y)||void 0===t.Reflect||y in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(r=(e=t.Reflect).defineMetadata,i=e.hasOwnMetadata,n=e.getOwnMetadata,o=e.getOwnMetadataKeys,s=e.deleteMetadata,a=new d,l={isProviderFor:function(e,t){var r=a.get(e);return!!(!E(r)&&r.has(t))||!!o(e,t).length&&(E(r)&&(r=new f,a.set(e,r)),r.add(t),!0)},OrdinaryDefineOwnMetadata:r,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:s});var e,r,i,n,o,s,a,l,c,u,p,g=new d,v={registerProvider:function(e){if(!Object.isExtensible(v))throw Error("Cannot add provider to a frozen registry.");switch(!0){case l===e:break;case E(c):c=e;break;case c===e:break;case E(u):u=e;break;case u===e:break;default:void 0===p&&(p=new f),p.add(e)}},getProvider:m,setProvider:function(e,t,r){if(!function(e){if(E(e))throw TypeError();return c===e||u===e||!E(p)&&p.has(e)}(r))throw Error("Metadata provider not registered.");var i=m(e,t);if(i!==r){if(!E(i))return!1;var n=g.get(e);E(n)&&(n=new h,g.set(e,n)),n.set(t,r)}return!0}};return v;function m(e,t){var r,i=g.get(e);return E(i)||(r=i.get(t)),E(r)&&(r=function(e,t){if(!E(c)){if(c.isProviderFor(e,t))return c;if(!E(u)){if(u.isProviderFor(e,t))return c;if(!E(p))for(var r=M(p);;){var i=U(r);if(!i)return;var n=i.value;if(n.isProviderFor(e,t))return P(r),n}}}if(!E(l)&&l.isProviderFor(e,t))return l}(e,t),E(r)||(E(i)&&(i=new h,g.set(e,i)),i.set(t,r))),r}}()),!E(y)&&x(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,y,{enumerable:!1,configurable:!1,writable:!1,value:r}),r),v=function(e){var t=new d,r={isProviderFor:function(e,r){var i=t.get(e);return!E(i)&&i.has(r)},OrdinaryDefineOwnMetadata:function(e,t,r,n){i(r,n,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,r){var n=i(t,r,!1);return!E(n)&&!!n.has(e)},OrdinaryGetOwnMetadata:function(e,t,r){var n=i(t,r,!1);if(!E(n))return n.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var r=[],n=i(e,t,!1);if(E(n))return r;for(var o=M(n.keys()),s=0;;){var a=U(o);if(!a)return r.length=s,r;var l=a.value;try{r[s]=l}catch(e){try{P(o)}finally{throw e}}s++}},OrdinaryDeleteMetadata:function(e,r,n){var o=i(r,n,!1);if(E(o)||!o.delete(e))return!1;if(0===o.size){var s=t.get(r);E(s)||(s.delete(n),0===s.size&&t.delete(s))}return!0}};return g.registerProvider(r),r;function i(i,n,o){var s=t.get(i),a=!1;if(E(s)){if(!o)return;s=new h,t.set(i,s),a=!0}var l=s.get(n);if(E(l)){if(!o)return;if(l=new h,s.set(n,l),!e.setProvider(i,n,r))throw s.delete(n),a&&t.delete(i),Error("Wrong provider for target.")}return l}}(g);function m(e,t,r){var i=R(t,r,!1);return!E(i)&&!!i.OrdinaryHasOwnMetadata(e,t,r)}function w(e,t,r){var i=R(t,r,!1);if(!E(i))return i.OrdinaryGetOwnMetadata(e,t,r)}function A(e,t,r,i){R(r,i,!0).OrdinaryDefineOwnMetadata(e,t,r,i)}function b(e,t){var r=R(e,t,!1);return r?r.OrdinaryOwnMetadataKeys(e,t):[]}function S(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function E(e){return void 0===e}function B(e){return null===e}function x(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,r,i){if(E(r)){if(!k(e)||!T(t))throw TypeError();for(var n=e,o=t,s=n.length-1;s>=0;--s){var a=(0,n[s])(o);if(!E(a)&&!B(a)){if(!T(a))throw TypeError();o=a}}return o}if(!k(e)||!x(t)||!x(i)&&!E(i)&&!B(i))throw TypeError();return B(i)&&(i=void 0),function(e,t,r,i){for(var n=e.length-1;n>=0;--n){var o=(0,e[n])(t,r,i);if(!E(o)&&!B(o)){if(!x(o))throw TypeError();i=o}}return i}(e,t,r=C(r),i)}),e("metadata",function(e,t){return function(r,i){if(!x(r)||!E(i)&&!function(e){switch(S(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();A(e,t,r,i)}}),e("defineMetadata",function(e,t,r,i){if(!x(r))throw TypeError();return E(i)||(i=C(i)),A(e,t,r,i)}),e("hasMetadata",function(e,t,r){if(!x(t))throw TypeError();return E(r)||(r=C(r)),function e(t,r,i){if(m(t,r,i))return!0;var n=D(r);return!B(n)&&e(t,n,i)}(e,t,r)}),e("hasOwnMetadata",function(e,t,r){if(!x(t))throw TypeError();return E(r)||(r=C(r)),m(e,t,r)}),e("getMetadata",function(e,t,r){if(!x(t))throw TypeError();return E(r)||(r=C(r)),function e(t,r,i){if(m(t,r,i))return w(t,r,i);var n=D(r);if(!B(n))return e(t,n,i)}(e,t,r)}),e("getOwnMetadata",function(e,t,r){if(!x(t))throw TypeError();return E(r)||(r=C(r)),w(e,t,r)}),e("getMetadataKeys",function(e,t){if(!x(e))throw TypeError();return E(t)||(t=C(t)),function e(t,r){var i=b(t,r),n=D(t);if(null===n)return i;var o=e(n,r);if(o.length<=0)return i;if(i.length<=0)return o;for(var s=new f,a=[],l=0;l<i.length;l++){var c=i[l],u=s.has(c);u||(s.add(c),a.push(c))}for(var p=0;p<o.length;p++){var c=o[p],u=s.has(c);u||(s.add(c),a.push(c))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!x(e))throw TypeError();return E(t)||(t=C(t)),b(e,t)}),e("deleteMetadata",function(e,t,r){if(!x(t)||(E(r)||(r=C(r)),!x(t)))throw TypeError();E(r)||(r=C(r));var i=R(t,r,!1);return!E(i)&&i.OrdinaryDeleteMetadata(e,t,r)});function C(e){var t=function(e,t){switch(S(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r="string",i=N(e,o);if(void 0!==i){var n=i.call(e,r);if(x(n))throw TypeError();return n}return function(e,t){if("string"===t){var r=e.toString;if(I(r)){var i=r.call(e);if(!x(i))return i}var n=e.valueOf;if(I(n)){var i=n.call(e);if(!x(i))return i}}else{var n=e.valueOf;if(I(n)){var i=n.call(e);if(!x(i))return i}var o=e.toString;if(I(o)){var i=o.call(e);if(!x(i))return i}}throw TypeError()}(e,r)}(e,0);return"symbol"==typeof t?t:""+t}function k(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function I(e){return"function"==typeof e}function T(e){return"function"==typeof e}function O(e,t){return e===t||e!=e&&t!=t}function N(e,t){var r=e[t];if(null!=r){if(!I(r))throw TypeError();return r}}function M(e){var t=N(e,s);if(!I(t))throw TypeError();var r=t.call(e);if(!x(r))throw TypeError();return r}function U(e){var t=e.next();return!t.done&&t}function P(e){var t=e.return;t&&t.call(e)}function D(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===p||t!==p)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function R(e,t,r){var i=g.getProvider(e,t);if(!E(i))return i;if(r){if(g.setProvider(e,t,v))return v;throw Error("Illegal state.")}}function j(e){return e.__=void 0,delete e.__,e}})},558504,e=>{"use strict";let t;e.s([],643130);let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",n=e=>{let t="u"<typeof Uint8Array?[]:new Uint8Array(256),i=r.length;for(let r=0;r<i;r++)t[e.charCodeAt(r)]=r;return t},o=n(r),s=n(i),a=/^[-A-Za-z0-9\-_]*$/,l=/^[-A-Za-z0-9+/]*={0,3}$/,c={};function u(e,t="base64url"){return new Uint8Array(c.toArrayBuffer(e,"base64url"===t))}function p(e,t="base64url"){let r=new Uint8Array(e);return c.fromArrayBuffer(r.buffer,"base64url"===t)}function h(e){let t=c.toArrayBuffer(e,!0);return c.fromArrayBuffer(t)}function f(e){return c.fromString(e,!0)}function d(e){return c.toString(e,!0)}function y(e){return c.validate(e,!1)}function g(e){return e=v(e),c.validate(e,!0)}function v(e){return e.replace(/=/g,"")}function m(e,t,r){let i;if(t<24)return[t,1];let n=e.byteLength-r-1,o=new DataView(e.buffer,r+1),s=0;switch(t){case 24:n>0&&(i=o.getUint8(0),s=2);break;case 25:n>1&&(i=o.getUint16(0,!1),s=3);break;case 26:n>3&&(i=o.getUint32(0,!1),s=5);break;case 27:if(n>7){let e=o.getBigUint64(0,!1);if(e>=24n&&e<=Number.MAX_SAFE_INTEGER)return[Number(e),9]}}if(i&&i>=24)return[i,s];throw Error("Length not supported or not well formed")}function w(e,t){let r,i=e<<5;if(t<0)throw Error("CBOR Data Item argument must not be negative");if("number"==typeof t){if(!Number.isInteger(t))throw Error("CBOR Data Item argument must be an integer");r=BigInt(t)}else r=t;if(1==e){if(0n==r)throw Error("CBOR Data Item argument cannot be zero when negative");r-=1n}if(r>0xffffffffffffffffn)throw Error("CBOR number out of range");let n=new Uint8Array(8);return(new DataView(n.buffer).setBigUint64(0,r,!1),r<=23)?[i|n[7]]:r<=255?[24|i,n[7]]:r<=65535?[25|i,...n.slice(6)]:r<=0xffffffff?[26|i,...n.slice(4)]:[27|i,...n]}c.toArrayBuffer=(e,t)=>{let r=e.length,i=.75*e.length,n,a=0,l,c,u,p;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);let h=new ArrayBuffer(i),f=new Uint8Array(h),d=t?s:o;for(n=0;n<r;n+=4)l=d[e.charCodeAt(n)],c=d[e.charCodeAt(n+1)],u=d[e.charCodeAt(n+2)],p=d[e.charCodeAt(n+3)],f[a++]=l<<2|c>>4,f[a++]=(15&c)<<4|u>>2,f[a++]=(3&u)<<6|63&p;return h},c.fromArrayBuffer=(e,t)=>{let n=new Uint8Array(e),o,s="",a=n.length,l=t?i:r;for(o=0;o<a;o+=3)s+=l[n[o]>>2],s+=l[(3&n[o])<<4|n[o+1]>>4],s+=l[(15&n[o+1])<<2|n[o+2]>>6],s+=l[63&n[o+2]];let c=a%3;return 2===c?s=s.substring(0,s.length-1)+(t?"":"="):1===c&&(s=s.substring(0,s.length-2)+(t?"":"==")),s},c.toString=(e,t)=>new TextDecoder().decode(c.toArrayBuffer(e,t)),c.fromString=(e,t)=>c.fromArrayBuffer(new TextEncoder().encode(e),t),c.validate=(e,t)=>{if(!("string"==typeof e||e instanceof String))return!1;try{return t?a.test(e):l.test(e)}catch(e){return!1}},c.base64=c,e.s(["fromBuffer",()=>p,"fromUTF8String",()=>f,"isBase64",()=>y,"isBase64URL",()=>g,"toBase64",()=>h,"toBuffer",()=>u,"toUTF8String",()=>d,"trimPadding",()=>v],905089);class A{constructor(e,t){Object.defineProperty(this,"tagId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tagValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tagId=e,this.tagValue=t}get tag(){return this.tagId}get value(){return this.tagValue}}function b(e,t,r){let[i,n]=m(e,t,r),o=r+n;return[new Uint8Array(e.buffer.slice(o,o+i)),n+i]}let S=new TextDecoder,E="Map is not supported or well formed";function B(e,t){if(t>=e.byteLength)throw Error("CBOR stream ended before tag value");let r=e.getUint8(t),i=31&r;switch(r>>5){case 0:return m(e,i,t);case 1:return function(e,t,r){let[i,n]=m(e,t,r);return[-i-1,n]}(e,i,t);case 2:return b(e,i,t);case 3:return function(e,t,r){let[i,n]=b(e,t,r);return[S.decode(i),n]}(e,i,t);case 4:return function(e,t,r){if(0===t)return[[],1];let[i,n]=m(e,t,r),o=n,s=[];for(let t=0;t<i;t++){if(e.byteLength-r-o<=0)throw Error("array is not supported or well formed");let[t,i]=B(e,r+o);s.push(t),o+=i}return[s,o]}(e,i,t);case 5:return function(e,t,r){if(0===t)return[new Map,1];let[i,n]=m(e,t,r),o=n,s=new Map;for(let t=0;t<i;t++){let t=e.byteLength-r-o;if(t<=0)throw Error(E);let[i,n]=B(e,r+o);if(o+=n,(t-=n)<=0||"string"!=typeof i&&"number"!=typeof i||s.has(i))throw Error(E);let[a,l]=B(e,r+o);o+=l,s.set(i,a)}return[s,o]}(e,i,t);case 6:return function(e,t,r){let[i,n]=m(e,t,r),[o,s]=B(e,r+n);return[new A(i,o),n+s]}(e,i,t);case 7:switch(i){case 20:return[!1,1];case 21:return[!0,1];case 22:return[null,1];case 23:return[void 0,1];case 25:if(t+3>e.byteLength)throw Error("CBOR stream ended before end of Float 16");let n=e.getUint16(t+1,!1);if(31744==n)return[1/0,3];if(32256==n)return[NaN,3];if(64512==n)return[-1/0,3];throw Error("Float16 data is unsupported");case 26:if(t+5>e.byteLength)throw Error("CBOR stream ended before end of Float 32");return[e.getFloat32(t+1,!1),5];case 27:if(t+9>e.byteLength)throw Error("CBOR stream ended before end of Float 64");return[e.getFloat64(t+1,!1),9]}}throw Error(`Unsupported or not well formed at ${t}`)}let x=new TextEncoder;function C(e){let[t]=function(e,t){if(0===e.byteLength||e.byteLength<=0)throw Error("No data");return e instanceof Uint8Array?B(new DataView(e.buffer),0):e instanceof ArrayBuffer?B(new DataView(e),0):B(e,0)}(new Uint8Array(e),0);return t}function k(e){let t=[];!function e(t,r){if("boolean"==typeof t||null===t||void 0==t){var i;return void r.push(!0===(i=t)?245:!1===i?244:null===i?246:247)}if("number"==typeof t||"bigint"==typeof t)return void r.push(...function(e){if("number"==typeof e){if(Number.isSafeInteger(e))if(e<0)return w(1,Math.abs(e));else return w(0,e);return[function(e){if(Math.fround(e)==e||!Number.isFinite(e)||Number.isNaN(e)){let t=new Uint8Array(5);return t[0]=250,new DataView(t.buffer).setFloat32(1,e,!1),t}{let t=new Uint8Array(9);return t[0]=251,new DataView(t.buffer).setFloat64(1,e,!1),t}}(e)]}return e<0n?w(1,-(1n*e)):w(0,e)}(t));if("string"==typeof t)return void(r.push(...w(3,t.length)),r.push(x.encode(t)));if(t instanceof Uint8Array)return void(r.push(...w(2,t.length)),r.push(t));if(Array.isArray(t))return void function(t,r){for(let i of(r.push(...w(4,t.length)),t))e(i,r)}(t,r);if(t instanceof Map)return void function(t,r){for(let[i,n]of(r.push(new Uint8Array(w(5,t.size))),t.entries()))e(i,r),e(n,r)}(t,r);if(t instanceof A)return void(r.push(...w(6,t.tag)),e(t.value,r));throw Error("Not implemented")}(e,t);let r=0;for(let e of t)"number"==typeof e?r+=1:r+=e.length;let i=new Uint8Array(r),n=0;for(let e of t)"number"==typeof e?(i[n]=e,n+=1):(i.set(e,n),n+=e.length);return i}function I(e){let t=e.get(eu.kty);return O(t)&&t===ep.EC2}function T(e){let t=e.get(eu.kty);return O(t)&&t===ep.RSA}function O(e){return Object.values(ep).indexOf(e)>=0}function N(e){return Object.values(ef).indexOf(e)>=0}function M(e){if([ef.RS1].indexOf(e)>=0)return"SHA-1";if([ef.ES256,ef.PS256,ef.RS256].indexOf(e)>=0)return"SHA-256";if([ef.ES384,ef.PS384,ef.RS384].indexOf(e)>=0)return"SHA-384";if([ef.ES512,ef.PS512,ef.RS512,ef.EdDSA].indexOf(e)>=0)return"SHA-512";throw Error(`Could not map COSE alg value of ${e} to a WebCrypto alg`)}function U(){return new Promise((e,r)=>{if(t)return e(t);let i=D.stubThisGlobalThisCrypto();return i?e(t=i):r(new P)})}e.s(["decodeFirst",()=>C,"encode",()=>k],405114),e.s([],643006),(es=eu||(eu={}))[es.kty=1]="kty",es[es.alg=3]="alg",es[es.crv=-1]="crv",es[es.x=-2]="x",es[es.y=-3]="y",es[es.n=-1]="n",es[es.e=-2]="e",(ea=ep||(ep={}))[ea.OKP=1]="OKP",ea[ea.EC2=2]="EC2",ea[ea.RSA=3]="RSA",(el=eh||(eh={}))[el.P256=1]="P256",el[el.P384=2]="P384",el[el.P521=3]="P521",el[el.ED25519=6]="ED25519",el[el.SECP256K1=8]="SECP256K1",(ec=ef||(ef={}))[ec.ES256=-7]="ES256",ec[ec.EdDSA=-8]="EdDSA",ec[ec.ES384=-35]="ES384",ec[ec.ES512=-36]="ES512",ec[ec.PS256=-37]="PS256",ec[ec.PS384=-38]="PS384",ec[ec.PS512=-39]="PS512",ec[ec.ES256K=-47]="ES256K",ec[ec.RS256=-257]="RS256",ec[ec.RS384=-258]="RS384",ec[ec.RS512=-259]="RS512",ec[ec.RS1=-65535]="RS1";class P extends Error{constructor(){super("An instance of the Crypto API could not be located"),this.name="MissingWebCrypto"}}let D={stubThisGlobalThisCrypto:()=>globalThis.crypto};async function R(e,t){let r=await U(),i=M(t);return new Uint8Array(await r.subtle.digest(i,e))}async function j(e){return(await U()).getRandomValues(e),e}async function L(e){let t=await U(),{keyData:r,algorithm:i}=e;return t.subtle.importKey("jwk",r,i,!1,["verify"])}var V,H,_,F,G,K,$,W,q,z,Q,J,Y,X,Z,ee,et,er,ei,en,eo,es,ea,el,ec,eu,ep,eh,ef,ed,ey,eg,ev,em,ew,eA,eb,eS,eE,eB,ex,eC,ek,eI,eT,eO,eN,eM,eU,eP,eD,eR,ej,eL,eV,eH,e_,eF,eG,eK,e$,eW,eq,ez,eQ,eJ,eY,eX,eZ,e0,e1,e2,e4,e8,e5,e3,e6,e7,e9,te,tt,tr,ti,tn,to,ts,ta,tl,tc,tu,tp,th,tf,td,ty,tg,tv,tm,tw,tA,tb,tS,tE,tB,tx,tC,tk,tI,tT,tO,tN,tM,tU,tP,tD,tR,tj,tL,tV=e.i(905089),tV=tV;async function tH(e){let t,{cosePublicKey:r,signature:i,data:n,shaHashOverride:o}=e,s=await U(),a=r.get(eu.alg),l=r.get(eu.crv),c=r.get(eu.x),u=r.get(eu.y);if(!a)throw Error("Public key was missing alg (EC2)");if(!l)throw Error("Public key was missing crv (EC2)");if(!c)throw Error("Public key was missing x (EC2)");if(!u)throw Error("Public key was missing y (EC2)");if(l===eh.P256)t="P-256";else if(l===eh.P384)t="P-384";else if(l===eh.P521)t="P-521";else throw Error(`Unexpected COSE crv value of ${l} (EC2)`);let p={kty:"EC",crv:t,x:tV.fromBuffer(c),y:tV.fromBuffer(u),ext:!1},h={name:"ECDSA",namedCurve:t},f=await L({keyData:p,algorithm:h}),d=M(a);o&&(d=M(o));let y={name:"ECDSA",hash:{name:d}};return s.subtle.verify(y,f,i,n)}var tV=tV;function t_(e){if([ef.EdDSA].indexOf(e)>=0)return"Ed25519";if([ef.ES256,ef.ES384,ef.ES512,ef.ES256K].indexOf(e)>=0)return"ECDSA";if([ef.RS256,ef.RS384,ef.RS512,ef.RS1].indexOf(e)>=0)return"RSASSA-PKCS1-v1_5";if([ef.PS256,ef.PS384,ef.PS512].indexOf(e)>=0)return"RSA-PSS";throw Error(`Could not map COSE alg value of ${e} to a WebCrypto key alg name`)}async function tF(e){let{cosePublicKey:t,signature:r,data:i,shaHashOverride:n}=e,o=await U(),s=t.get(eu.alg),a=t.get(eu.n),l=t.get(eu.e);if(!s)throw Error("Public key was missing alg (RSA)");if(!N(s))throw Error(`Public key had invalid alg ${s} (RSA)`);if(!a)throw Error("Public key was missing n (RSA)");if(!l)throw Error("Public key was missing e (RSA)");let c={kty:"RSA",alg:"",n:tV.fromBuffer(a),e:tV.fromBuffer(l),ext:!1},u={name:t_(s),hash:{name:M(s)}},p={name:t_(s)};if(n&&(u.hash.name=M(n)),"RSASSA-PKCS1-v1_5"===u.name)"SHA-256"===u.hash.name?c.alg="RS256":"SHA-384"===u.hash.name?c.alg="RS384":"SHA-512"===u.hash.name?c.alg="RS512":"SHA-1"===u.hash.name&&(c.alg="RS1");else if("RSA-PSS"===u.name){let e=0;"SHA-256"===u.hash.name?(c.alg="PS256",e=32):"SHA-384"===u.hash.name?(c.alg="PS384",e=48):"SHA-512"===u.hash.name&&(c.alg="PS512",e=64),p.saltLength=e}else throw Error(`Unexpected RSA key algorithm ${s} (${u.name})`);let h=await L({keyData:c,algorithm:u});return o.subtle.verify(p,h,r,i)}function tG(e,t){return e.length==t.length&&e.every((e,r)=>e===t[r])}function tK(e){return Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}function t$(e){if(!e)return Uint8Array.from([]);if(!(0!==e.length&&e.length%2==0&&!/[^a-fA-F0-9]/u.test(e)))throw Error("Invalid hex string");let t=e.match(/.{1,2}/g)??[];return Uint8Array.from(t.map(e=>parseInt(e,16)))}function tW(e){let t=0,r=new Uint8Array(e.reduce((e,t)=>e+t.length,0));return e.forEach(e=>{r.set(e,t),t+=e.length}),r}function tq(e){return new globalThis.TextDecoder("utf-8").decode(e)}function tz(e){return new globalThis.TextEncoder().encode(e)}function tQ(e){return Uint8Array.from(e.split("").map(e=>e.charCodeAt(0)))}function tJ(e){return new DataView(e.buffer,e.byteOffset,e.length)}e.s(["areEqual",()=>tG,"concat",()=>tW,"fromASCIIString",()=>tQ,"fromHex",()=>t$,"fromUTF8String",()=>tz,"toDataView",()=>tJ,"toHex",()=>tK,"toUTF8String",()=>tq],654420);var tY=e.i(654420),tY=tY;function tX(e){let t=tY.toHex(e);return[t.slice(0,8),t.slice(8,12),t.slice(12,16),t.slice(16,20),t.slice(20,32)].join("-")}var tV=tV;function tZ(e){let t;if("string"==typeof e)if(tV.isBase64URL(e))t=tV.toBase64(e);else if(tV.isBase64(e))t=e;else throw Error("Certificate is not a valid base64 or base64url string");else t=tV.fromBuffer(e,"base64");let r="";for(let e=0;e<Math.ceil(t.length/64);e+=1){let i=64*e;r+=`${t.substr(i,64)}
`}return`-----BEGIN CERTIFICATE-----
${r}-----END CERTIFICATE-----
`}var t0=e.i(405114),t0=t0,tY=tY;function t1(e){let t=t0.decodeFirst(e),r=Uint8Array.from([4]),i=t.get(eu.x),n=t.get(eu.y);if(!i)throw Error("COSE public key was missing x");return n?tY.concat([r,i,n]):tY.concat([r,i])}var t0=t0;let t2=e=>e;var tV=tV;function t4(e){let t=JSON.parse(tV.toUTF8String(e));return t8.stubThis(t)}let t8={stubThis:e=>e};var t0=t0;function t5(e){return t3.stubThis(t0.decodeFirst(e))}let t3={stubThis:e=>e};e.s(["digest",()=>R,"getRandomValues",()=>j,"verify",()=>um],134722),e.i(643006);var t6=e.i(134722),t6=t6;async function t7(){let e=new Uint8Array(32);return await t6.getRandomValues(e),t9.stubThis(e)}let t9={stubThis:e=>e};class re{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){let r=re.toUint8Array(e),i=re.toUint8Array(t);if(r.length!==i.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}static concat(...e){let t;t=!Array.isArray(e[0])||e[1]instanceof Function?Array.isArray(e[0])&&e[1]instanceof Function?e[0]:e[e.length-1]instanceof Function?e.slice(0,e.length-1):e:e[0];let r=0;for(let e of t)r+=e.byteLength;let i=new Uint8Array(r),n=0;for(let e of t){let t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[e.length-1]instanceof Function?this.toView(i,e[e.length-1]):i.buffer}}let rt="string",rr=/^[0-9a-f\s]+$/i,ri=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,rn=/^[a-zA-Z0-9-_]+$/;class ro{static fromString(e){let t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){let t=re.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class rs{static toString(e,t=!1){let r=re.toArrayBuffer(e),i=new DataView(r),n="";for(let e=0;e<r.byteLength;e+=2)n+=String.fromCharCode(i.getUint16(e,t));return n}static fromString(e,t=!1){let r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class ra{static isHex(e){return typeof e===rt&&rr.test(e)}static isBase64(e){return typeof e===rt&&ri.test(e)}static isBase64Url(e){return typeof e===rt&&rn.test(e)}static ToString(e,t="utf8"){let r=re.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return rs.toString(r,!0);case"utf16":case"utf16be":return rs.toString(r);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return rs.fromString(e,!0);case"utf16":case"utf16be":return rs.fromString(e);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){let t=re.toUint8Array(e);return"u">typeof btoa?btoa(this.ToString(t,"binary")):Buffer.from(t).toString("base64")}static FromBase64(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ra.isBase64(t))throw TypeError("Argument 'base64Text' is not Base64 encoded");return"u">typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ra.isBase64Url(t))throw TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=ra.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return ro.fromString(e);case"utf16":case"utf16be":return rs.fromString(e);case"utf16le":case"usc2":return rs.fromString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=ra.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return ro.toString(e);case"utf16":case"utf16be":return rs.toString(e);case"utf16le":case"usc2":return rs.toString(e,!0);default:throw Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){let t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){let t=re.toUint8Array(e),r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){let t=re.toUint8Array(e),r="",i=t.length;for(let e=0;e<i;e++){let i=t[e];i<16&&(r+="0"),r+=i.toString(16)}return r}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!ra.isHex(t))throw TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){let i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return rs.toString(e,t)}static FromUtf16String(e,t=!1){return rs.fromString(e,t)}static Base64Padding(e){let t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function rl(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}function rc(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function ru(e,t,r=-1){let i=e,n=0,o=Math.pow(2,t);for(let s=1;s<8;s++){if(e<o){let e;if(r<0)e=new ArrayBuffer(s),n=s;else{if(r<s)return new ArrayBuffer(0);e=new ArrayBuffer(r),n=r}let o=new Uint8Array(e);for(let e=s-1;e>=0;e--){let r=Math.pow(2,e*t);o[n-e-1]=Math.floor(i/r),i-=o[n-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function rp(...e){let t=0,r=0;for(let r of e)t+=r.length;let i=new Uint8Array(new ArrayBuffer(t));for(let t of e)i.set(t,r),r+=t.length;return i}function rh(){let e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){let t=255===e[0]&&128&e[1],r=0===e[0]&&(128&e[1])==0;(t||r)&&this.warnings.push("Needlessly long format")}let t=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let e=0;e<this.valueHex.byteLength;e++)t[e]=0;t[0]=128&e[0];let r=rc(t,8),i=new Uint8Array(new ArrayBuffer(this.valueHex.byteLength));for(let t=0;t<this.valueHex.byteLength;t++)i[t]=e[t];return i[0]&=127,rc(i,8)-r}function rf(e,t){let r=e.toString(10);if(t<r.length)return"";let i=t-r.length,n=Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}function rd(){if("u"<typeof BigInt)throw Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function ry(e){let t=0,r=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let i=new Uint8Array(t);for(let t=0;t<e.length;t++){let n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function rg(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}ra.DEFAULT_UTF8_ENCODING="utf8";class rv{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return ry(this.items)}}let rm=[new Uint8Array([1])],rw="0123456789",rA="name",rb="valueHexView",rS=new ArrayBuffer(0),rE=new Uint8Array(0),rB="EndOfContent",rx="OCTET STRING",rC="BIT STRING";function rk(e){var t;return(t=class extends e{get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!=(t=r.isHexOnly)&&t,this.valueHexView=r.valueHex?re.toUint8Array(r.valueHex):rE}fromBER(e,t,r){let i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!rg(this,i,t,r))return -1;let n=t+r;return(this.valueHexView=i.subarray(t,n),this.valueHexView.length)?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",rS)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ra.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class rI{static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:i=rE}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=re.toUint8Array(i)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ra.ToHex(this.valueBeforeDecodeView)}}}rI.NAME="baseBlock";class rT extends rI{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}rT.NAME="valueBlock";class rO extends rk(rI){constructor({idBlock:e={}}={}){var t,r,i,n;super(),e?(this.isHexOnly=null!=(t=e.isHexOnly)&&t,this.valueHexView=e.valueHex?re.toUint8Array(e.valueHex):rE,this.tagClass=null!=(r=e.tagClass)?r:-1,this.tagNumber=null!=(i=e.tagNumber)?i:-1,this.isConstructed=null!=(n=e.isConstructed)&&n):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",rS}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){let r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){let r=ru(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,o=new Uint8Array(n+1);if(o[0]=31|t,!e){for(let e=0;e<n-1;e++)o[e+1]=128|i[e];o[n]=i[n-1]}return o.buffer}let r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){let e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){let i=re.toUint8Array(e);if(!rg(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(32&n[0])==32,this.isHexOnly=!1;let o=31&n[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&n[e];){if(t[e-1]=127&n[e],++e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){let e=new Uint8Array(r+=255);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&n[e];let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];(t=this.valueHexView=new Uint8Array(e)).set(i),this.blockLength<=9?this.tagNumber=rc(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}rO.NAME="identificationBlock";class rN extends rI{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!=(t=e.isIndefiniteForm)&&t,this.longFormUsed=null!=(r=e.longFormUsed)&&r,this.length=null!=(i=e.length)?i:0}fromBER(e,t,r){let i=re.toUint8Array(e);if(!rg(this,i,t,r))return -1;let n=i.subarray(t,t+r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;let o=127&n[0];if(o>8)return this.error="Too big integer",-1;if(o+1>n.length)return this.error="End of input reached before message was fully decoded",-1;let s=t+1,a=i.subarray(s,s+o);return 0===a[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=rc(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(this.longFormUsed){let i=ru(this.length,8);if(i.byteLength>127)return this.error="Too big length",rS;if(t=new ArrayBuffer(i.byteLength+1),e)return t;let n=new Uint8Array(i);(r=new Uint8Array(t))[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}rN.NAME="lengthBlock";let rM={};class rU extends rI{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new rO(i),this.lenBlock=new rN(i),this.valueBlock=n?new n(i):new rT(i)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}toBER(e,t){let r=t||new rv;t||function e(t){var r;if(t instanceof rM.Constructed)for(let r of t.valueBlock.value)e(r)&&(t.lenBlock.isIndefiniteForm=!0);return!!(null==(r=t.lenBlock)?void 0:r.isIndefiniteForm)}(this);let i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{let t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;let i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?rS:r.final()}toJSON(){let e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():ra.ToHex(this.toBER())}onAsciiEncoding(){let e=this.constructor.NAME,t=ra.ToHex(this.valueBlock.valueBeforeDecodeView);return`${e} : ${t}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;let t=this.toBER(),r=e.toBER();if(t.byteLength!==r.byteLength)return!1;let i=new Uint8Array(t),n=new Uint8Array(r);for(let e=0;e<i.length;e++)if(i[e]!==n[e])return!1;return!0}}rU.NAME="BaseBlock";class rP extends rU{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}fromBER(e,t,r){let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}rP.NAME="BaseStringBlock";class rD extends rk(rT){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}rD.NAME="PrimitiveValueBlock";class rR extends rU{constructor(e={}){super(e,rD),this.idBlock.isConstructed=!1}}function rj(e,t=0,r=e.length){let i=t,n=new rU({},rT),o=new rI;if(!rg(o,e,t,r))return n.error=o.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let s=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===s)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=s,r-=n.idBlock.blockLength,s=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===s)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=s,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=rU;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=rM.EndOfContent;break;case 1:a=rM.Boolean;break;case 2:a=rM.Integer;break;case 3:a=rM.BitString;break;case 4:a=rM.OctetString;break;case 5:a=rM.Null;break;case 6:a=rM.ObjectIdentifier;break;case 10:a=rM.Enumerated;break;case 12:a=rM.Utf8String;break;case 13:a=rM.RelativeObjectIdentifier;break;case 14:a=rM.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=rM.Sequence;break;case 17:a=rM.Set;break;case 18:a=rM.NumericString;break;case 19:a=rM.PrintableString;break;case 20:a=rM.TeletexString;break;case 21:a=rM.VideotexString;break;case 22:a=rM.IA5String;break;case 23:a=rM.UTCTime;break;case 24:a=rM.GeneralizedTime;break;case 25:a=rM.GraphicString;break;case 26:a=rM.VisibleString;break;case 27:a=rM.GeneralString;break;case 28:a=rM.UniversalString;break;case 29:a=rM.CharacterString;break;case 30:a=rM.BmpString;break;case 31:a=rM.DATE;break;case 32:a=rM.TimeOfDay;break;case 33:a=rM.DateTime;break;case 34:a=rM.Duration;break;default:{let e=n.idBlock.isConstructed?new rM.Constructed:new rM.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?rM.Constructed:rM.Primitive;return s=(n=function(e,t){if(e instanceof t)return e;let r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a)).fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:s,result:n}}function rL(e){if(!e.byteLength){let e=new rU({},rT);return e.error="Input buffer has zero length",{offset:-1,result:e}}return rj(re.toUint8Array(e).slice(),0,e.byteLength)}rM.Primitive=rR,rR.NAME="PRIMITIVE";class rV extends rT{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){var i,n;let o=re.toUint8Array(e);if(!rg(this,o,t,r))return -1;if(this.valueBeforeDecodeView=o.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;i=this.isIndefiniteForm,n=r,(i?1:n)>0;){let e=rj(o,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===rB)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===rB?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){let r=t||new rv;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?rS:r.final()}toJSON(){let e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(let t of this.value)e.value.push(t.toJSON());return e}}rV.NAME="ConstructedValueBlock";class rH extends rU{constructor(e={}){super(e,rV),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;let i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return -1===i?this.error=this.valueBlock.error:(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength)),i}onAsciiEncoding(){let e=[];for(let t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map(e=>`  ${e}`).join("\n"));let t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :
${e.join("\n")}`:`${t} :`}}rM.Constructed=rH,rH.NAME="CONSTRUCTED";class r_ extends rT{fromBER(e,t,r){return t}toBER(e){return rS}}r_.override="EndOfContentValueBlock";class rF extends rU{constructor(e={}){super(e,r_),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}rM.EndOfContent=rF,rF.NAME=rB;class rG extends rU{constructor(e={}){super(e,rT),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return(this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength)?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){let r=new ArrayBuffer(2);if(!e){let e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}rM.Null=rG,rG.NAME="NULL";class rK extends rk(rT){get value(){for(let e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=255*!!e}constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=re.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}fromBER(e,t,r){let i=re.toUint8Array(e);return rg(this,i,t,r)?(this.valueHexView=i.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,rh.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}rK.NAME="BooleanValueBlock";class r$ extends rU{getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}constructor(e={}){super(e,rK),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}rM.Boolean=r$,r$.NAME="BOOLEAN";class rW extends rk(rV){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,-1===(i=rV.prototype.fromBER.call(this,e,t,r)))return i;for(let e=0;e<this.value.length;e++){let t=this.value[e].constructor.NAME;if(t===rB)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1;else break;if(t!==rx)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?rV.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}rW.NAME="OctetStringValueBlock";class rq extends rU{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},rW),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){let i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){let e=rj(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch{}}return super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return rH.prototype.onAsciiEncoding.call(this);let e=this.constructor.NAME,t=ra.ToHex(this.valueBlock.valueHexView);return`${e} : ${t}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;let e=[];for(let t of this.valueBlock.value)t instanceof ed&&e.push(t.valueBlock.valueHexView);return re.concat(e)}}rM.OctetString=ed=rq,rq.NAME=rx;class rz extends rk(rV){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let i=-1;if(this.isConstructed){if(-1===(i=rV.prototype.fromBER.call(this,e,t,r)))return i;for(let e of this.value){let t=e.constructor.NAME;if(t===rB)if(!this.isIndefiniteForm)return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1;else break;if(t!==rC)return this.error="BIT STRING may consists of BIT STRINGs only",-1;let r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return i}let n=re.toUint8Array(e);if(!rg(this,n,t,r))return -1;let o=n.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){let e=o.subarray(1);try{if(e.byteLength){let t=rj(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return rV.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength){let e=new Uint8Array(1);return e[0]=0,e.buffer}let r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}rz.NAME="BitStringValueBlock";class rQ extends rU{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i;null!=r.isConstructed||(r.isConstructed=!!(null==(i=r.value)?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},rz),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return rH.prototype.onAsciiEncoding.call(this);{let e=[];for(let t of this.valueBlock.valueHexView)e.push(t.toString(2).padStart(8,"0"));let t=e.join(""),r=this.constructor.NAME,i=t.substring(0,t.length-this.valueBlock.unusedBits);return`${r} : ${i}`}}}function rJ(e){if(e>=rm.length)for(let t=rm.length;t<=e;t++){let e=new Uint8Array([0]),r=rm[t-1].slice(0);for(let t=r.length-1;t>=0;t--){let i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=rp(e,r)),rm.push(r)}return rm[e]}rM.BitString=rQ,rQ.NAME=rC;class rY extends rk(rT){setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=rh.call(this)))}constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){let t=e<0?-1*e:e,r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){let e=ru(r-t,8,i),n=new Uint8Array(e);return n[0]|=128,e}let n=ru(t,8,i),o=new Uint8Array(n);if(128&o[0]){let e=n.slice(0),t=new Uint8Array(e);o=new Uint8Array(n=new ArrayBuffer(n.byteLength+1));for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return n}r*=256}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){let n=this.fromBER(e,t,r);if(-1===n)return n;let o=this.valueHexView;return 0===o[0]&&(128&o[1])!=0?this.valueHexView=o.subarray(1):0!==i&&o.length<i&&(i-o.length>1&&(i=o.length+1),this.valueHexView=o.subarray(i-o.length)),n}toDER(e=!1){let t=this.valueHexView;switch(!0){case(128&t[0])!=0:{let e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&(128&t[1])==0:this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){let i=super.fromBER(e,t,r);return -1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){let e,t=8*this.valueHexView.length-1,r=new Uint8Array(8*this.valueHexView.length/3),i=0,n=this.valueHexView,o="",s=!1;for(let s=n.byteLength-1;s>=0;s--){e=n[s];for(let n=0;n<8;n++)(1&e)==1&&(i===t?(r=function(e,t){let r,i=0,n=new Uint8Array(e),o=new Uint8Array(t),s=n.slice(0),a=s.length-1,l=o.slice(0),c=l.length-1,u=0;for(let e=c;e>=0;e--,u++)!0==(r=s[a-u]-l[c-u]-i)<0?(i=1,s[a-u]=r+10):(i=0,s[a-u]=r);if(i>0)for(let e=a-c+1;e>=0;e--,u++)if((r=s[a-u]-i)<0)i=1,s[a-u]=r+10;else{i=0,s[a-u]=r;break}return s.slice()}(rJ(i),r),o="-"):r=function(e,t){let r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t),o=i.slice(0),s=o.length-1,a=n.slice(0),l=a.length-1,c=0,u=l<s?s:l,p=0;for(let e=u;e>=0;e--,p++)c=!0==p<a.length?o[s-p]+a[l-p]+r[0]:o[s-p]+r[0],r[0]=c/10,!0==p>=o.length?o=rp(new Uint8Array([c%10]),o):o[s-p]=c%10;return r[0]>0&&(o=rp(r,o)),o}(r,rJ(i))),i++,e>>=1}for(let e=0;e<r.length;e++)r[e]&&(s=!0),s&&(o+=rw.charAt(r[e]));return!1===s&&(o+=rw.charAt(0)),o}}rY.NAME="IntegerValueBlock",Object.defineProperty(rY.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class rX extends rU{constructor(e={}){super(e,rY),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return rd(),BigInt(this.valueBlock.toString())}static fromBigInt(e){rd();let t=BigInt(e),r=new rv,i=t.toString(16).replace(/^-/,""),n=new Uint8Array(ra.FromHex(i));if(t<0){let e=new Uint8Array(n.length+(128&n[0]?1:0));e[0]|=128;let i=BigInt(`0x${ra.ToHex(e)}`)+t,o=re.toUint8Array(ra.FromHex(i.toString(16)));o[0]|=128,r.write(o)}else 128&n[0]&&r.write(new Uint8Array([0])),r.write(n);return new ey({valueHex:r.final()})}convertToDER(){let e=new ey({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new ey({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}rM.Integer=ey=rX,rX.NAME="INTEGER";class rZ extends rX{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}rM.Enumerated=rZ,rZ.NAME="ENUMERATED";class r0 extends rk(rT){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;let i=re.toUint8Array(e);if(!rg(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=rc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){rd();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;let r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+128*(e+1<r.length);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=ru(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",rS;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=ra.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}r0.NAME="sidBlock";class r1 extends rT{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new r0;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){let t=[];for(let r=0;r<this.value.length;r++){let i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,rS;t.push(i)}return ry(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do if(i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1,n){let e=this.value[0],t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:this.value=[];return}let r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{let e=new r0;if(i>Number.MAX_SAFE_INTEGER)rd(),e.valueBigInt=BigInt(i);else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}r1.NAME="ObjectIdentifierValueBlock";class r2 extends rU{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,r1),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}rM.ObjectIdentifier=r2,r2.NAME="OBJECT IDENTIFIER";class r4 extends rk(rI){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;let i=re.toUint8Array(e);if(!rg(this,i,t,r))return -1;let n=i.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&n[e],this.blockLength++,(128&n[e])!=0);e++);let o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return(this.valueHexView=o,(128&n[this.blockLength-1])!=0)?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=rc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);let t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}let t=ru(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",rS;let r=new Uint8Array(t.byteLength);if(!e){let e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){return this.isHexOnly?ra.ToHex(this.valueHexView):this.valueDec.toString()}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}r4.NAME="relativeSidBlock";class r8 extends rT{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){let t=new r4;if(-1===(i=t.fromBER(e,i,r))){this.blockLength=0,this.error=t.error;break}this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){let r=[];for(let t=0;t<this.value.length;t++){let i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,rS;r.push(i)}return ry(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{i=-1===(r=e.indexOf(".",t))?e.substring(t):e.substring(t,r),t=r+1;let n=new r4;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))break;this.value.push(n)}while(-1!==r)return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?e+=i=`{${i}}`:e+=i}return e}toJSON(){let e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}r8.NAME="RelativeObjectIdentifierValueBlock";class r5 extends rU{getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}constructor(e={}){super(e,r8),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}rM.RelativeObjectIdentifier=r5,r5.NAME="RelativeObjectIdentifier";class r3 extends rH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}rM.Sequence=r3,r3.NAME="SEQUENCE";class r6 extends rH{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}rM.Set=r6,r6.NAME="SET";class r7 extends rk(rT){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=""}toJSON(){return{...super.toJSON(),value:this.value}}}r7.NAME="StringValueBlock";class r9 extends r7{}r9.NAME="SimpleStringValueBlock";class ie extends rP{constructor({...e}={}){super(e,r9)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,re.toUint8Array(e))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}ie.NAME="SIMPLE STRING";class it extends ie{fromBuffer(e){this.valueBlock.valueHexView=re.toUint8Array(e);try{this.valueBlock.value=ra.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=ra.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ra.FromUtf8String(e)),this.valueBlock.value=e}}it.NAME="Utf8StringValueBlock";class ir extends it{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}rM.Utf8String=ir,ir.NAME="UTF8String";class ii extends ie{fromBuffer(e){this.valueBlock.value=ra.ToUtf16String(e),this.valueBlock.valueHexView=re.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ra.FromUtf16String(e))}}ii.NAME="BmpStringValueBlock";class io extends ii{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}rM.BmpString=io,io.NAME="BMPString";class is extends ie{fromBuffer(e){let t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){let t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){let t=new Uint8Array(ru(e.charCodeAt(i),8));if(t.length>4)continue;let n=4-t.length;for(let e=t.length-1;e>=0;e--)r[4*i+e+n]=t[e]}this.valueBlock.value=e}}is.NAME="UniversalStringValueBlock";class ia extends is{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}rM.UniversalString=ia,ia.NAME="UniversalString";class il extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}rM.NumericString=il,il.NAME="NumericString";class ic extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}rM.PrintableString=ic,ic.NAME="PrintableString";class iu extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}rM.TeletexString=iu,iu.NAME="TeletexString";class ip extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}rM.VideotexString=ip,ip.NAME="VideotexString";class ih extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}rM.IA5String=ih,ih.NAME="IA5String";class id extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}rM.GraphicString=id,id.NAME="GraphicString";class iy extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}rM.VisibleString=iy,iy.NAME="VisibleString";class ig extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}rM.GeneralString=ig,ig.NAME="GeneralString";class iv extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}rM.CharacterString=iv,iv.NAME="CharacterString";class im extends iy{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,re.toUint8Array(e)))}toBuffer(){let e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){let t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(null===t){this.error="Wrong input string for conversion";return}let r=parseInt(t[1],10);r>=50?this.year=1900+r:this.year=2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){let e=Array(7);return e[0]=rf(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=rf(this.month,2),e[2]=rf(this.day,2),e[3]=rf(this.hour,2),e[4]=rf(this.minute,2),e[5]=rf(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}rM.UTCTime=im,im.NAME="UTCTime";class iw extends im{constructor(e={}){super(e),null!=this.millisecond||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",n="",o=0,s=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{if(isNaN(new Number(e[e.length-1]).valueOf()))throw Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+")||-1!==i.indexOf("-"))throw Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw Error("Wrong input string for conversion");if(s=e*n,4===r.length){if(isNaN((n=parseInt(r.substring(2,4),10)).valueOf()))throw Error("Wrong input string for conversion");a=e*n}}}let l=i.indexOf(".");if(-1===l&&(l=i.indexOf(",")),-1!==l){let e=new Number(`0${i.substring(l)}`);if(isNaN(e.valueOf()))throw Error("Wrong input string for conversion");o=e.valueOf(),n=i.substring(0,l)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/ig,-1!==l)throw Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=60*o;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,-1!==l){let e=1e3*o;this.millisecond=Math.floor(e)}break;default:throw Error("Wrong input string for conversion")}let c=t.exec(n);if(null===c)throw Error("Wrong input string for conversion");for(let e=1;e<c.length;e++)switch(e){case 1:this.year=parseInt(c[e],10);break;case 2:this.month=parseInt(c[e],10);break;case 3:this.day=parseInt(c[e],10);break;case 4:this.hour=parseInt(c[e],10)+s;break;case 5:this.minute=parseInt(c[e],10)+a;break;case 6:this.second=parseInt(c[e],10);break;default:throw Error("Wrong input string for conversion")}if(!1===r){let e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){let e=[];return e.push(rf(this.year,4)),e.push(rf(this.month,2)),e.push(rf(this.day,2)),e.push(rf(this.hour,2)),e.push(rf(this.minute,2)),e.push(rf(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(rf(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}rM.GeneralizedTime=iw,iw.NAME="GeneralizedTime";class iA extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}rM.DATE=iA,iA.NAME="DATE";class ib extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}rM.TimeOfDay=ib,ib.NAME="TimeOfDay";class iS extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}rM.DateTime=iS,iS.NAME="DateTime";class iE extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}rM.Duration=iE,iE.NAME="Duration";class iB extends ir{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}rM.TIME=iB,iB.NAME="TIME";class ix{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class iC extends ix{constructor({value:e=[],...t}={}){super(t),this.value=e}}class ik extends ix{constructor({value:e=new ix,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class iI{get data(){return this.dataView.slice().buffer}set data(e){this.dataView=re.toUint8Array(e)}constructor({data:e=rE}={}){this.dataView=re.toUint8Array(e)}fromBER(e,t,r){let i=t+r;return this.dataView=re.toUint8Array(e).subarray(t,i),i}toBER(e){return this.dataView.slice().buffer}}function iT(e,t,r){if(r instanceof iC){for(let i of r.value)if(iT(e,t,i).verified)return{verified:!0,result:e};{let e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(rA)&&(e.name=r.name),e}}if(r instanceof ix)return r.hasOwnProperty(rA)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1||"idBlock"in r==!1||"fromBER"in r.idBlock==!1||"toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(rb in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};let i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(e[r.name]=t)),r instanceof rM.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},o=r.valueBlock.value.length;if(o>0&&r.valueBlock.value[0]instanceof ik&&(o=t.valueBlock.value.length),0===o)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let s=0;s<o;s++)if(s-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[s].optional){let t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof ik){if(!1===(n=iT(e,t.valueBlock.value[s],r.valueBlock.value[0].value)).verified)if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(rA in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};void 0===(i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[s])}}else if(!1===(n=iT(e,t.valueBlock.value[s-i],r.valueBlock.value[s])).verified)if(!r.valueBlock.value[s].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&delete e[r.name]),n;else i++;if(!1===n.verified){let t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&rb in t.valueBlock){let i=rj(t.valueBlock.valueHexView);if(-1===i.offset){let t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,""),r.name&&(delete e[r.name],t.name=r.name)),t}return iT(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}function iO(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};let r=rj(re.toUint8Array(e));return -1===r.offset?{verified:!1,result:r.result}:iT(r.result,r.result,t)}e.s(["Any",()=>ix,"BaseBlock",()=>rU,"BaseStringBlock",()=>rP,"BitString",()=>rQ,"BmpString",()=>io,"Boolean",()=>r$,"CharacterString",()=>iv,"Choice",()=>iC,"Constructed",()=>rH,"DATE",()=>iA,"DateTime",()=>iS,"Duration",()=>iE,"EndOfContent",()=>rF,"Enumerated",()=>rZ,"GeneralString",()=>ig,"GeneralizedTime",()=>iw,"GraphicString",()=>id,"HexBlock",()=>rk,"IA5String",()=>ih,"Integer",()=>rX,"Null",()=>rG,"NumericString",()=>il,"ObjectIdentifier",()=>r2,"OctetString",()=>rq,"Primitive",()=>rR,"PrintableString",()=>ic,"RawData",()=>iI,"RelativeObjectIdentifier",()=>r5,"Repeated",()=>ik,"Sequence",()=>r3,"Set",()=>r6,"TIME",()=>iB,"TeletexString",()=>iu,"TimeOfDay",()=>ib,"UTCTime",()=>im,"UniversalString",()=>ia,"Utf8String",()=>ir,"ValueBlock",()=>rT,"VideotexString",()=>ip,"ViewWriter",()=>rv,"VisibleString",()=>iy,"compareSchema",()=>iT,"fromBER",()=>rL,"verifySchema",()=>iO],323577),(V=eg||(eg={}))[V.Sequence=0]="Sequence",V[V.Set=1]="Set",V[V.Choice=2]="Choice",(H=ev||(ev={}))[H.Any=1]="Any",H[H.Boolean=2]="Boolean",H[H.OctetString=3]="OctetString",H[H.BitString=4]="BitString",H[H.Integer=5]="Integer",H[H.Enumerated=6]="Enumerated",H[H.ObjectIdentifier=7]="ObjectIdentifier",H[H.Utf8String=8]="Utf8String",H[H.BmpString=9]="BmpString",H[H.UniversalString=10]="UniversalString",H[H.NumericString=11]="NumericString",H[H.PrintableString=12]="PrintableString",H[H.TeletexString=13]="TeletexString",H[H.VideotexString=14]="VideotexString",H[H.IA5String=15]="IA5String",H[H.GraphicString=16]="GraphicString",H[H.VisibleString=17]="VisibleString",H[H.GeneralString=18]="GeneralString",H[H.CharacterString=19]="CharacterString",H[H.UTCTime=20]="UTCTime",H[H.GeneralizedTime=21]="GeneralizedTime",H[H.DATE=22]="DATE",H[H.TimeOfDay=23]="TimeOfDay",H[H.DateTime=24]="DateTime",H[H.Duration=25]="Duration",H[H.TIME=26]="TIME",H[H.Null=27]="Null";class iN{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else if(re.isBufferSource(e))this.unusedBits=t,this.value=re.toArrayBuffer(e);else throw TypeError("Unsupported type of 'params' argument for BitString")}fromASN(e){if(!(e instanceof rQ))throw TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new rQ({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new rQ({name:e})}toNumber(){let e="";for(let t of new Uint8Array(this.value))e+=t.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2),r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;let i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let n=0;for(;n<r;)i[n]=parseInt(t.slice(n<<3,(n<<3)+8),2),n++;this.value=i.buffer}}class iM{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):re.isBufferSource(e)?this.buffer=re.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}fromASN(e){if(!(e instanceof rq))throw TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new rq({valueHex:this.buffer})}toSchema(e){return new rq({name:e})}}let iU={fromASN:e=>e instanceof rG?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new rG;let t=rL(e);if(t.result.error)throw Error(t.result.error);return t.result}},iP={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new rX({value:+e})},iD={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new rZ({value:e})},iR={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new rX({valueHex:e})},ij={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new rQ({valueHex:e})},iL={fromASN:e=>e.valueBlock.toString(),toASN:e=>new r2({value:e})},iV={fromASN:e=>e.valueBlock.value,toASN:e=>new r$({value:e})},iH={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new rq({valueHex:e})};function i_(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}let iF=i_(ir),iG=i_(io),iK=i_(ia),i$=i_(il),iW=i_(ic),iq=i_(iu),iz=i_(ip),iQ=i_(ih),iJ=i_(id),iY=i_(iy),iX=i_(ig),iZ=i_(iv),i0={fromASN:e=>e.toDate(),toASN:e=>new im({valueDate:e})},i1={fromASN:e=>e.toDate(),toASN:e=>new iw({valueDate:e})},i2={fromASN:()=>null,toASN:()=>new rG};function i4(e){switch(e){case ev.Any:return iU;case ev.BitString:return ij;case ev.BmpString:return iG;case ev.Boolean:return iV;case ev.CharacterString:return iZ;case ev.Enumerated:return iD;case ev.GeneralString:return iX;case ev.GeneralizedTime:return i1;case ev.GraphicString:return iJ;case ev.IA5String:return iQ;case ev.Integer:return iP;case ev.Null:return i2;case ev.NumericString:return i$;case ev.ObjectIdentifier:return iL;case ev.OctetString:return iH;case ev.PrintableString:return iW;case ev.TeletexString:return iq;case ev.UTCTime:return i0;case ev.UniversalString:return iK;case ev.Utf8String:return iF;case ev.VideotexString:return iz;case ev.VisibleString:return iY;default:return null}}var i8=e.i(323577);function i5(e){return"function"==typeof e&&e.prototype?!!e.prototype.toASN&&!!e.prototype.fromASN||i5(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}let i3=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){let r=this.items.get(e);if(!r)throw Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){let t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){let t={type:eg.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){let r=this.items.get(e)||this.createDefault(e),i=[];for(let e in r.items){let n,o=r.items[e],s=t?e:"";if("number"==typeof o.type){let e=ev[o.type],t=i8[e];if(!t)throw Error(`Cannot get ASN1 class by name '${e}'`);n=new t({name:s})}else i5(o.type)?n=new o.type().toSchema(s):o.optional?this.get(o.type).type===eg.Choice?n=new i8.Any({name:s}):(n=this.create(o.type,!1)).name=s:n=new i8.Any({name:s});let a=!!o.optional||void 0!==o.defaultValue;if(o.repeated&&(n.name="",n=new("set"===o.repeated?i8.Set:i8.Sequence)({name:"",value:[new i8.Repeated({name:s,value:n})]})),null!==o.context&&void 0!==o.context)if(o.implicit)if("number"==typeof o.type||i5(o.type)){let e=o.repeated?i8.Constructed:i8.Primitive;i.push(new e({name:s,optional:a,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);let e=!!o.repeated,t=e?n:this.get(o.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new i8.Constructed({name:e?"":s,optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:t}))}else i.push(new i8.Constructed({optional:a,idBlock:{tagClass:3,tagNumber:o.context},value:[n]}));else n.optional=a,i.push(n)}switch(r.type){case eg.Sequence:return new i8.Sequence({value:i,name:""});case eg.Set:return new i8.Set({value:i,name:""});case eg.Choice:return new i8.Choice({value:i,name:""});default:throw Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){let t=Object.getPrototypeOf(e);return t?this.items.get(t)||this.findParentSchema(t):null}},i6=e=>t=>{let r;i3.has(t)?r=i3.get(t):(r=i3.createDefault(t),i3.set(t,r)),Object.assign(r,e)},i7=e=>(t,r)=>{let i;i3.has(t.constructor)?i=i3.get(t.constructor):(i=i3.createDefault(t.constructor),i3.set(t.constructor,i));let n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){let i=i4(e.type);if(!i)throw Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}n.raw=e.raw,i.items[r]=n};class i9 extends Error{constructor(){super(...arguments),this.schemas=[]}}class ne{static parse(e,t){let r=i8.fromBER(e);if(r.result.error)throw Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(e,t){try{if(i5(t))return new t().fromASN(e);let r=i3.get(t);i3.cache(t);let i=r.schema,n=this.handleChoiceTypes(e,r,t,i);if(null==n?void 0:n.result)return n.result;(null==n?void 0:n.targetSchema)&&(i=n.targetSchema);let o=this.handleSequenceTypes(e,r,t,i),s=new t;if(function e(t){var r;if(t){let i=Object.getPrototypeOf(t);return(null==(r=null==i?void 0:i.prototype)?void 0:r.constructor)===Array||e(i)}return!1}(t))return this.handleArrayTypes(e,r,t);return this.processSchemaItems(r,o,s),s}catch(e){throw e instanceof i9&&e.schemas.push(t.name),e}}static handleChoiceTypes(e,t,r,i){if(e.constructor===i8.Constructed&&t.type===eg.Choice&&3===e.idBlock.tagClass)for(let i in t.items){let n=t.items[i];if(n.context===e.idBlock.tagNumber&&n.implicit&&"function"==typeof n.type&&i3.has(n.type)){let t=i3.get(n.type);if(t&&t.type===eg.Sequence){let t=new i8.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock){t.valueBlock.value=e.valueBlock.value;let o=this.fromASN(t,n.type),s=new r;return s[i]=o,{result:s}}}}}else if(e.constructor===i8.Constructed&&t.type!==eg.Choice){let r=new i8.Constructed({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:t.schema.valueBlock.value});for(let r in t.items)delete e[r];return{targetSchema:r}}return null}static handleSequenceTypes(e,t,r,i){if(t.type===eg.Sequence){let t=i8.compareSchema({},e,i);if(!t.verified)throw new i9(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}{let t=i8.compareSchema({},e,i);if(!t.verified)throw new i9(`Data does not match to ${r.name} ASN1 schema.${t.result.error?` ${t.result.error}`:""}`);return t}}static processRepeatedField(e,t,r){let i=e.slice(t);if(1===i.length&&"Sequence"===i[0].constructor.name){let e=i[0];e.valueBlock&&e.valueBlock.value&&Array.isArray(e.valueBlock.value)&&(i=e.valueBlock.value)}if("number"!=typeof r.type)return i.filter(e=>e&&e.valueBlock).map(e=>{try{return this.fromASN(e,r.type)}catch{return}}).filter(e=>void 0!==e);{let e=i4(r.type);if(!e)throw Error(`No converter for ASN.1 type ${r.type}`);return i.filter(e=>e&&e.valueBlock).map(t=>{try{return e.fromASN(t)}catch{return}}).filter(e=>void 0!==e)}}static processPrimitiveField(e,t){let r=i4(t.type);if(!r)throw Error(`No converter for ASN.1 type ${t.type}`);return r.fromASN(e)}static isOptionalChoiceField(e){return e.optional&&"function"==typeof e.type&&i3.has(e.type)&&i3.get(e.type).type===eg.Choice}static processOptionalChoiceField(e,t){try{let r=this.fromASN(e,t.type);return{processed:!0,value:r}}catch(e){if(e instanceof i9&&/Wrong values for Choice type/.test(e.message))return{processed:!1};throw e}}static handleArrayTypes(e,t,r){if(!("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");let i=t.itemType;if("number"!=typeof i)return r.from(e.valueBlock.value,e=>this.fromASN(e,i));{let t=i4(i);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(e.valueBlock.value,e=>t.fromASN(e))}}static processSchemaItems(e,t,r){for(let i in e.items){let n,o=t.result[i];if(!o)continue;let s=e.items[i],a=s.type;(n="number"==typeof a||i5(a)?this.processPrimitiveSchemaItem(o,s,a):this.processComplexSchemaItem(o,s,a))&&"object"==typeof n&&"value"in n&&"raw"in n?(r[i]=n.value,r[`${i}Raw`]=n.raw):r[i]=n}}static processPrimitiveSchemaItem(e,t,r){var i;let n=null!=(i=t.converter)?i:i5(r)?new r:null;if(!n)throw Error("Converter is empty");return t.repeated?this.processRepeatedPrimitiveItem(e,t,n):this.processSinglePrimitiveItem(e,t,r,n)}static processRepeatedPrimitiveItem(e,t,r){if(!t.implicit)return Array.from(e,e=>r.fromASN(e));{let i=new("sequence"===t.repeated?i8.Sequence:i8.Set);i.valueBlock=e.valueBlock;let n=i8.fromBER(i.toBER(!1));if(-1===n.offset)throw Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock&&Array.isArray(n.result.valueBlock.value)))throw Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");return Array.from(n.result.valueBlock.value,e=>r.fromASN(e))}}static processSinglePrimitiveItem(e,t,r,i){let n=e;if(t.implicit){let e;if(i5(r))e=new r().toSchema("");else{let t=ev[r],i=i8[t];if(!i)throw Error(`Cannot get '${t}' class from asn1js module`);e=new i}e.valueBlock=n.valueBlock,n=i8.fromBER(e.toBER(!1)).result}return i.fromASN(n)}static processComplexSchemaItem(e,t,r){if(t.repeated){if(!Array.isArray(e))throw Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");return Array.from(e,e=>this.fromASN(e,r))}{let i=this.handleImplicitTagging(e,t,r);if(this.isOptionalChoiceField(t))try{return this.fromASN(i,r)}catch(e){if(e instanceof i9&&/Wrong values for Choice type/.test(e.message))return;throw e}{let n=this.fromASN(i,r);return t.raw?{value:n,raw:e.valueBeforeDecodeView}:n}}}static handleImplicitTagging(e,t,r){if(t.implicit&&"number"==typeof t.context){let t=i3.get(r);if(t.type===eg.Sequence){let t=new i8.Sequence;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}else if(t.type===eg.Set){let t=new i8.Set;if("value"in e.valueBlock&&Array.isArray(e.valueBlock.value)&&"value"in t.valueBlock)return t.valueBlock.value=e.valueBlock.value,t}}return e}}class nt{static serialize(e){return e instanceof rU?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){let t;if(e&&"object"==typeof e&&i5(e))return e.toASN();if(!(e&&"object"==typeof e))throw TypeError("Parameter 1 should be type of Object.");let r=e.constructor,i=i3.get(r);i3.cache(r);let n=[];if(i.itemType){if(!Array.isArray(e))throw TypeError("Parameter 1 should be type of Array.");if("number"==typeof i.itemType){let t=i4(i.itemType);if(!t)throw Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);n=e.map(e=>t.toASN(e))}else n=e.map(e=>this.toAsnItem({type:i.itemType},"[]",r,e))}else for(let t in i.items){let o=i.items[t],s=e[t];if(void 0===s||o.defaultValue===s||"object"==typeof o.defaultValue&&"object"==typeof s&&function(e,t){if(!(e&&t)||e.byteLength!==t.byteLength)return!1;let r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}(this.serialize(o.defaultValue),this.serialize(s)))continue;let a=nt.toAsnItem(o,t,r,s);if("number"==typeof o.context)if(o.implicit)if(!o.repeated&&("number"==typeof o.type||i5(o.type))){let e={};e.valueHex=a instanceof rG?a.valueBeforeDecodeView:a.valueBlock.toBER(),n.push(new rR({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},...e}))}else n.push(new rH({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:a.valueBlock.value}));else n.push(new rH({optional:o.optional,idBlock:{tagClass:3,tagNumber:o.context},value:[a]}));else o.repeated?n=n.concat(a):n.push(a)}switch(i.type){case eg.Sequence:t=new r3({value:n});break;case eg.Set:t=new r6({value:n});break;case eg.Choice:if(!n[0])throw Error(`Schema '${r.name}' has wrong data. Choice cannot be empty.`);t=n[0]}return t}static toAsnItem(e,t,r,i){let n;if("number"==typeof e.type){let o=e.converter;if(!o)throw Error(`Property '${t}' doesn't have converter for type ${ev[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>o.toASN(e));n=new("sequence"===e.repeated?r3:r6)({value:t})}else n=o.toASN(i)}else if(e.repeated){if(!Array.isArray(i))throw TypeError("Parameter 'objProp' should be type of Array.");let t=Array.from(i,e=>this.toASN(e));n=new("sequence"===e.repeated?r3:r6)({value:t})}else n=this.toASN(i);return n}}class nr extends Array{constructor(e=[]){if("number"==typeof e)super(e);else for(const t of(super(),e))this.push(t)}}class ni{static serialize(e){return nt.serialize(e)}static parse(e,t){return ne.parse(e,t)}static toString(e){let t=rL(re.isBufferSource(e)?re.toArrayBuffer(e):ni.serialize(e));if(-1===t.offset)throw Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function nn(e,t,r,i){var n,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,r,s):n(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function no(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function ns(e,t,r,i,n){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}"function"==typeof SuppressedError&&SuppressedError;class na{static isIPv4(e){return/^(\d{1,3}\.){3}\d{1,3}$/.test(e)}static parseIPv4(e){let t=e.split(".");if(4!==t.length)throw Error("Invalid IPv4 address");return t.map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0||t>255)throw Error("Invalid IPv4 address part");return t})}static parseIPv6(e){let t=this.expandIPv6(e).split(":");if(8!==t.length)throw Error("Invalid IPv6 address");return t.reduce((e,t)=>{let r=parseInt(t,16);if(isNaN(r)||r<0||r>65535)throw Error("Invalid IPv6 address part");return e.push(r>>8&255),e.push(255&r),e},[])}static expandIPv6(e){if(!e.includes("::"))return e;let t=e.split("::");if(t.length>2)throw Error("Invalid IPv6 address");let r=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],n=8-(r.length+i.length);if(n<0)throw Error("Invalid IPv6 address");return[...r,...Array(n).fill("0"),...i].join(":")}static formatIPv6(e){let t=[];for(let r=0;r<16;r+=2)t.push((e[r]<<8|e[r+1]).toString(16));return this.compressIPv6(t.join(":"))}static compressIPv6(e){let t=e.split(":"),r=-1,i=0,n=-1,o=0;for(let e=0;e<t.length;e++)"0"===t[e]?(-1===n&&(n=e),o++):(o>i&&(r=n,i=o),n=-1,o=0);if(o>i&&(r=n,i=o),i>1){let e=t.slice(0,r).join(":"),n=t.slice(r+i).join(":");return`${e}::${n}`}return e}static parseCIDR(e){let[t,r]=e.split("/"),i=parseInt(r,10);if(this.isIPv4(t)){if(i<0||i>32)throw Error("Invalid IPv4 prefix length");return[this.parseIPv4(t),i]}if(i<0||i>128)throw Error("Invalid IPv6 prefix length");return[this.parseIPv6(t),i]}static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;let t=parseInt(e.slice(8),16).toString(2).split("").reduce((e,t)=>e+ +t,0),r=e.slice(0,8).replace(/(.{2})/g,e=>`${parseInt(e,16)}.`);return r=r.slice(0,-1),`${r}/${t}`}static toString(e){let t=new Uint8Array(e);if(4===t.length)return Array.from(t).join(".");if(16===t.length)return this.formatIPv6(t);if(8===t.length||32===t.length){let e=t.length/2,r=t.slice(0,e),i=t.slice(e);if(t.every(e=>0===e))return 8===t.length?"0.0.0.0/0":"::/0";let n=i.reduce((e,t)=>e+(t.toString(2).match(/1/g)||[]).length,0);if(8===t.length){let e=Array.from(r).join(".");return`${e}/${n}`}{let e=this.formatIPv6(r);return`${e}/${n}`}}return this.decodeIP(ra.ToHex(e))}static fromString(e){if(e.includes("/")){let[t,r]=this.parseCIDR(e),i=new Uint8Array(t.length),n=r;for(let e=0;e<i.length;e++)n>=8?(i[e]=255,n-=8):n>0&&(i[e]=255<<8-n,n=0);let o=new Uint8Array(2*t.length);return o.set(t,0),o.set(i,t.length),o.buffer}return new Uint8Array(this.isIPv4(e)?this.parseIPv4(e):this.parseIPv6(e)).buffer}}let nl=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};nn([i7({type:ev.TeletexString})],nl.prototype,"teletexString",void 0),nn([i7({type:ev.PrintableString})],nl.prototype,"printableString",void 0),nn([i7({type:ev.UniversalString})],nl.prototype,"universalString",void 0),nn([i7({type:ev.Utf8String})],nl.prototype,"utf8String",void 0),nn([i7({type:ev.BmpString})],nl.prototype,"bmpString",void 0),nl=nn([i6({type:eg.Choice})],nl);let nc=class extends nl{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?ra.ToHex(this.anyValue):super.toString())}};nn([i7({type:ev.IA5String})],nc.prototype,"ia5String",void 0),nn([i7({type:ev.Any})],nc.prototype,"anyValue",void 0),nc=nn([i6({type:eg.Choice})],nc);class nu{constructor(e={}){this.type="",this.value=new nc,Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],nu.prototype,"type",void 0),nn([i7({type:nc})],nu.prototype,"value",void 0);let np=em=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,em.prototype)}};np=em=nn([i6({type:eg.Set,itemType:nu})],np);let nh=ew=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,ew.prototype)}};nh=ew=nn([i6({type:eg.Sequence,itemType:np})],nh);let nf=eA=class extends nh{constructor(e){super(e),Object.setPrototypeOf(this,eA.prototype)}};nf=eA=nn([i6({type:eg.Sequence})],nf);class nd{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],nd.prototype,"typeId",void 0),nn([i7({type:ev.Any,context:0})],nd.prototype,"value",void 0);class ny{constructor(e={}){this.partyName=new nl,Object.assign(this,e)}}nn([i7({type:nl,optional:!0,context:0,implicit:!0})],ny.prototype,"nameAssigner",void 0),nn([i7({type:nl,context:1,implicit:!0})],ny.prototype,"partyName",void 0);let ng=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:nd,context:0,implicit:!0})],ng.prototype,"otherName",void 0),nn([i7({type:ev.IA5String,context:1,implicit:!0})],ng.prototype,"rfc822Name",void 0),nn([i7({type:ev.IA5String,context:2,implicit:!0})],ng.prototype,"dNSName",void 0),nn([i7({type:ev.Any,context:3,implicit:!0})],ng.prototype,"x400Address",void 0),nn([i7({type:nf,context:4,implicit:!1})],ng.prototype,"directoryName",void 0),nn([i7({type:ny,context:5})],ng.prototype,"ediPartyName",void 0),nn([i7({type:ev.IA5String,context:6,implicit:!0})],ng.prototype,"uniformResourceIdentifier",void 0),nn([i7({type:ev.OctetString,context:7,implicit:!0,converter:{fromASN:e=>na.toString(iH.fromASN(e)),toASN:e=>iH.toASN(na.fromString(e))}})],ng.prototype,"iPAddress",void 0),nn([i7({type:ev.ObjectIdentifier,context:8,implicit:!0})],ng.prototype,"registeredID",void 0),ng=nn([i6({type:eg.Choice})],ng);let nv="1.3.6.1.5.5.7",nm=`${nv}.1`,nw=`${nv}.3`,nA=`${nv}.48`,nb=`${nA}.1`,nS=`${nA}.2`,nE=`${nA}.3`,nB=`${nA}.5`,nx="2.5.29",nC=`${nm}.1`;class nk{constructor(e={}){this.accessMethod="",this.accessLocation=new ng,Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],nk.prototype,"accessMethod",void 0),nn([i7({type:ng})],nk.prototype,"accessLocation",void 0);let nI=eb=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eb.prototype)}};nI=eb=nn([i6({type:eg.Sequence,itemType:nk})],nI);let nT=`${nx}.35`;class nO extends iM{}class nN{constructor(e={}){e&&Object.assign(this,e)}}nn([i7({type:nO,context:0,optional:!0,implicit:!0})],nN.prototype,"keyIdentifier",void 0),nn([i7({type:ng,context:1,optional:!0,implicit:!0,repeated:"sequence"})],nN.prototype,"authorityCertIssuer",void 0),nn([i7({type:ev.Integer,context:2,optional:!0,implicit:!0,converter:iR})],nN.prototype,"authorityCertSerialNumber",void 0);let nM=`${nx}.19`;class nU{constructor(e={}){this.cA=!1,Object.assign(this,e)}}nn([i7({type:ev.Boolean,defaultValue:!1})],nU.prototype,"cA",void 0),nn([i7({type:ev.Integer,optional:!0})],nU.prototype,"pathLenConstraint",void 0);let nP=eS=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eS.prototype)}};nP=eS=nn([i6({type:eg.Sequence,itemType:ng})],nP);let nD=eE=class extends nP{constructor(e){super(e),Object.setPrototypeOf(this,eE.prototype)}};nD=eE=nn([i6({type:eg.Sequence})],nD);let nR=`${nx}.32`,nj=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};nn([i7({type:ev.IA5String})],nj.prototype,"ia5String",void 0),nn([i7({type:ev.VisibleString})],nj.prototype,"visibleString",void 0),nn([i7({type:ev.BmpString})],nj.prototype,"bmpString",void 0),nn([i7({type:ev.Utf8String})],nj.prototype,"utf8String",void 0),nj=nn([i6({type:eg.Choice})],nj);class nL{constructor(e={}){this.organization=new nj,this.noticeNumbers=[],Object.assign(this,e)}}nn([i7({type:nj})],nL.prototype,"organization",void 0),nn([i7({type:ev.Integer,repeated:"sequence"})],nL.prototype,"noticeNumbers",void 0);class nV{constructor(e={}){Object.assign(this,e)}}nn([i7({type:nL,optional:!0})],nV.prototype,"noticeRef",void 0),nn([i7({type:nj,optional:!0})],nV.prototype,"explicitText",void 0);let nH=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ev.IA5String})],nH.prototype,"cPSuri",void 0),nn([i7({type:nV})],nH.prototype,"userNotice",void 0),nH=nn([i6({type:eg.Choice})],nH);class n_{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],n_.prototype,"policyQualifierId",void 0),nn([i7({type:ev.Any})],n_.prototype,"qualifier",void 0);class nF{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],nF.prototype,"policyIdentifier",void 0),nn([i7({type:n_,repeated:"sequence",optional:!0})],nF.prototype,"policyQualifiers",void 0);let nG=eB=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eB.prototype)}};nG=eB=nn([i6({type:eg.Sequence,itemType:nF})],nG);let nK=class{constructor(e=0){this.value=e}};nn([i7({type:ev.Integer})],nK.prototype,"value",void 0),nK=nn([i6({type:eg.Choice})],nK);let n$=class extends nK{};n$=nn([i6({type:eg.Choice})],n$);let nW=`${nx}.31`;(_=eC||(eC={}))[_.unused=1]="unused",_[_.keyCompromise=2]="keyCompromise",_[_.cACompromise=4]="cACompromise",_[_.affiliationChanged=8]="affiliationChanged",_[_.superseded=16]="superseded",_[_.cessationOfOperation=32]="cessationOfOperation",_[_.certificateHold=64]="certificateHold",_[_.privilegeWithdrawn=128]="privilegeWithdrawn",_[_.aACompromise=256]="aACompromise";class nq extends iN{toJSON(){let e=[],t=this.toNumber();return t&eC.aACompromise&&e.push("aACompromise"),t&eC.affiliationChanged&&e.push("affiliationChanged"),t&eC.cACompromise&&e.push("cACompromise"),t&eC.certificateHold&&e.push("certificateHold"),t&eC.cessationOfOperation&&e.push("cessationOfOperation"),t&eC.keyCompromise&&e.push("keyCompromise"),t&eC.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&eC.superseded&&e.push("superseded"),t&eC.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let nz=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ng,context:0,repeated:"sequence",implicit:!0})],nz.prototype,"fullName",void 0),nn([i7({type:np,context:1,implicit:!0})],nz.prototype,"nameRelativeToCRLIssuer",void 0),nz=nn([i6({type:eg.Choice})],nz);class nQ{constructor(e={}){Object.assign(this,e)}}nn([i7({type:nz,context:0,optional:!0})],nQ.prototype,"distributionPoint",void 0),nn([i7({type:nq,context:1,optional:!0,implicit:!0})],nQ.prototype,"reasons",void 0),nn([i7({type:ng,context:2,optional:!0,repeated:"sequence",implicit:!0})],nQ.prototype,"cRLIssuer",void 0);let nJ=ex=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,ex.prototype)}};nJ=ex=nn([i6({type:eg.Sequence,itemType:nQ})],nJ);let nY=ek=class extends nJ{constructor(e){super(e),Object.setPrototypeOf(this,ek.prototype)}};nY=ek=nn([i6({type:eg.Sequence,itemType:nQ})],nY);class nX{constructor(e={}){this.onlyContainsUserCerts=nX.ONLY,this.onlyContainsCACerts=nX.ONLY,this.indirectCRL=nX.ONLY,this.onlyContainsAttributeCerts=nX.ONLY,Object.assign(this,e)}}nX.ONLY=!1,nn([i7({type:nz,context:0,optional:!0})],nX.prototype,"distributionPoint",void 0),nn([i7({type:ev.Boolean,context:1,defaultValue:nX.ONLY,implicit:!0})],nX.prototype,"onlyContainsUserCerts",void 0),nn([i7({type:ev.Boolean,context:2,defaultValue:nX.ONLY,implicit:!0})],nX.prototype,"onlyContainsCACerts",void 0),nn([i7({type:nq,context:3,optional:!0,implicit:!0})],nX.prototype,"onlySomeReasons",void 0),nn([i7({type:ev.Boolean,context:4,defaultValue:nX.ONLY,implicit:!0})],nX.prototype,"indirectCRL",void 0),nn([i7({type:ev.Boolean,context:5,defaultValue:nX.ONLY,implicit:!0})],nX.prototype,"onlyContainsAttributeCerts",void 0);let nZ=`${nx}.21`;(F=eI||(eI={}))[F.unspecified=0]="unspecified",F[F.keyCompromise=1]="keyCompromise",F[F.cACompromise=2]="cACompromise",F[F.affiliationChanged=3]="affiliationChanged",F[F.superseded=4]="superseded",F[F.cessationOfOperation=5]="cessationOfOperation",F[F.certificateHold=6]="certificateHold",F[F.removeFromCRL=8]="removeFromCRL",F[F.privilegeWithdrawn=9]="privilegeWithdrawn",F[F.aACompromise=10]="aACompromise";let n0=class{constructor(e=eI.unspecified){this.reason=eI.unspecified,this.reason=e}toJSON(){return eI[this.reason]}toString(){return this.toJSON()}};nn([i7({type:ev.Enumerated})],n0.prototype,"reason",void 0),n0=nn([i6({type:eg.Choice})],n0);let n1=`${nx}.37`,n2=eT=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eT.prototype)}};n2=eT=nn([i6({type:eg.Sequence,itemType:ev.ObjectIdentifier})],n2);let n4=`${nw}.1`,n8=`${nw}.2`,n5=`${nw}.3`,n3=`${nw}.4`,n6=`${nw}.8`,n7=`${nw}.9`,n9=class{constructor(e=new ArrayBuffer(0)){this.value=e}};nn([i7({type:ev.Integer,converter:iR})],n9.prototype,"value",void 0),n9=nn([i6({type:eg.Choice})],n9);let oe=`${nx}.24`,ot=class{constructor(e){this.value=new Date,e&&(this.value=e)}};nn([i7({type:ev.GeneralizedTime})],ot.prototype,"value",void 0),ot=nn([i6({type:eg.Choice})],ot);let or=`${nx}.18`,oi=eO=class extends nP{constructor(e){super(e),Object.setPrototypeOf(this,eO.prototype)}};oi=eO=nn([i6({type:eg.Sequence})],oi);let on=`${nx}.15`;(G=eN||(eN={}))[G.digitalSignature=1]="digitalSignature",G[G.nonRepudiation=2]="nonRepudiation",G[G.keyEncipherment=4]="keyEncipherment",G[G.dataEncipherment=8]="dataEncipherment",G[G.keyAgreement=16]="keyAgreement",G[G.keyCertSign=32]="keyCertSign",G[G.cRLSign=64]="cRLSign",G[G.encipherOnly=128]="encipherOnly",G[G.decipherOnly=256]="decipherOnly";class oo extends iN{toJSON(){let e=this.toNumber(),t=[];return e&eN.cRLSign&&t.push("crlSign"),e&eN.dataEncipherment&&t.push("dataEncipherment"),e&eN.decipherOnly&&t.push("decipherOnly"),e&eN.digitalSignature&&t.push("digitalSignature"),e&eN.encipherOnly&&t.push("encipherOnly"),e&eN.keyAgreement&&t.push("keyAgreement"),e&eN.keyCertSign&&t.push("keyCertSign"),e&eN.keyEncipherment&&t.push("keyEncipherment"),e&eN.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class os{constructor(e={}){this.base=new ng,this.minimum=0,Object.assign(this,e)}}nn([i7({type:ng})],os.prototype,"base",void 0),nn([i7({type:ev.Integer,context:0,defaultValue:0,implicit:!0})],os.prototype,"minimum",void 0),nn([i7({type:ev.Integer,context:1,optional:!0,implicit:!0})],os.prototype,"maximum",void 0);let oa=eM=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eM.prototype)}};oa=eM=nn([i6({type:eg.Sequence,itemType:os})],oa);class ol{constructor(e={}){Object.assign(this,e)}}nn([i7({type:oa,context:0,optional:!0,implicit:!0})],ol.prototype,"permittedSubtrees",void 0),nn([i7({type:oa,context:1,optional:!0,implicit:!0})],ol.prototype,"excludedSubtrees",void 0);class oc{constructor(e={}){Object.assign(this,e)}}nn([i7({type:ev.Integer,context:0,implicit:!0,optional:!0,converter:iR})],oc.prototype,"requireExplicitPolicy",void 0),nn([i7({type:ev.Integer,context:1,implicit:!0,optional:!0,converter:iR})],oc.prototype,"inhibitPolicyMapping",void 0);class ou{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],ou.prototype,"issuerDomainPolicy",void 0),nn([i7({type:ev.ObjectIdentifier})],ou.prototype,"subjectDomainPolicy",void 0);let op=eU=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eU.prototype)}};op=eU=nn([i6({type:eg.Sequence,itemType:ou})],op);let oh=`${nx}.17`,of=eP=class extends nP{constructor(e){super(e),Object.setPrototypeOf(this,eP.prototype)}};of=eP=nn([i6({type:eg.Sequence})],of);class od{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],od.prototype,"type",void 0),nn([i7({type:ev.Any,repeated:"set"})],od.prototype,"values",void 0);let oy=eD=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eD.prototype)}};oy=eD=nn([i6({type:eg.Sequence,itemType:od})],oy);let og=`${nx}.14`;class ov extends nO{}class om{constructor(e={}){Object.assign(this,e)}}nn([i7({type:ev.GeneralizedTime,context:0,implicit:!0,optional:!0})],om.prototype,"notBefore",void 0),nn([i7({type:ev.GeneralizedTime,context:1,implicit:!0,optional:!0})],om.prototype,"notAfter",void 0),(K=eR||(eR={}))[K.keyUpdateAllowed=1]="keyUpdateAllowed",K[K.newExtensions=2]="newExtensions",K[K.pKIXCertificate=4]="pKIXCertificate";class ow extends iN{toJSON(){let e=[],t=this.toNumber();return t&eR.pKIXCertificate&&e.push("pKIXCertificate"),t&eR.newExtensions&&e.push("newExtensions"),t&eR.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class oA{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new ow,Object.assign(this,e)}}nn([i7({type:ev.GeneralString})],oA.prototype,"entrustVers",void 0),nn([i7({type:ow})],oA.prototype,"entrustInfoFlags",void 0);let ob=ej=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,ej.prototype)}};ob=ej=nn([i6({type:eg.Sequence,itemType:nk})],ob);class oS{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof oS&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&rl(e.parameters,this.parameters)||e.parameters===this.parameters)}}nn([i7({type:ev.ObjectIdentifier})],oS.prototype,"algorithm",void 0),nn([i7({type:ev.Any,optional:!0})],oS.prototype,"parameters",void 0);class oE{constructor(e={}){this.algorithm=new oS,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:oS})],oE.prototype,"algorithm",void 0),nn([i7({type:ev.BitString})],oE.prototype,"subjectPublicKey",void 0);let oB=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.setMilliseconds(0),t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){let e=this.utcTime||this.generalTime;if(!e)throw Error("Cannot get time from CHOICE object");return e}};nn([i7({type:ev.UTCTime})],oB.prototype,"utcTime",void 0),nn([i7({type:ev.GeneralizedTime})],oB.prototype,"generalTime",void 0),oB=nn([i6({type:eg.Choice})],oB);class ox{constructor(e){this.notBefore=new oB(new Date),this.notAfter=new oB(new Date),e&&(this.notBefore=new oB(e.notBefore),this.notAfter=new oB(e.notAfter))}}nn([i7({type:oB})],ox.prototype,"notBefore",void 0),nn([i7({type:oB})],ox.prototype,"notAfter",void 0);class oC{constructor(e={}){this.extnID="",this.critical=oC.CRITICAL,this.extnValue=new iM,Object.assign(this,e)}}oC.CRITICAL=!1,nn([i7({type:ev.ObjectIdentifier})],oC.prototype,"extnID",void 0),nn([i7({type:ev.Boolean,defaultValue:oC.CRITICAL})],oC.prototype,"critical",void 0),nn([i7({type:iM})],oC.prototype,"extnValue",void 0);let ok=eL=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eL.prototype)}};ok=eL=nn([i6({type:eg.Sequence,itemType:oC})],ok),($=eV||(eV={}))[$.v1=0]="v1",$[$.v2=1]="v2",$[$.v3=2]="v3";class oI{constructor(e={}){this.version=eV.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new oS,this.issuer=new nf,this.validity=new ox,this.subject=new nf,this.subjectPublicKeyInfo=new oE,Object.assign(this,e)}}nn([i7({type:ev.Integer,context:0,defaultValue:eV.v1})],oI.prototype,"version",void 0),nn([i7({type:ev.Integer,converter:iR})],oI.prototype,"serialNumber",void 0),nn([i7({type:oS})],oI.prototype,"signature",void 0),nn([i7({type:nf})],oI.prototype,"issuer",void 0),nn([i7({type:ox})],oI.prototype,"validity",void 0),nn([i7({type:nf})],oI.prototype,"subject",void 0),nn([i7({type:oE})],oI.prototype,"subjectPublicKeyInfo",void 0),nn([i7({type:ev.BitString,context:1,implicit:!0,optional:!0})],oI.prototype,"issuerUniqueID",void 0),nn([i7({type:ev.BitString,context:2,implicit:!0,optional:!0})],oI.prototype,"subjectUniqueID",void 0),nn([i7({type:ok,context:3,optional:!0})],oI.prototype,"extensions",void 0);class oT{constructor(e={}){this.tbsCertificate=new oI,this.signatureAlgorithm=new oS,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:oI,raw:!0})],oT.prototype,"tbsCertificate",void 0),nn([i7({type:oS})],oT.prototype,"signatureAlgorithm",void 0),nn([i7({type:ev.BitString})],oT.prototype,"signatureValue",void 0);class oO{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new oB,Object.assign(this,e)}}nn([i7({type:ev.Integer,converter:iR})],oO.prototype,"userCertificate",void 0),nn([i7({type:oB})],oO.prototype,"revocationDate",void 0),nn([i7({type:oC,optional:!0,repeated:"sequence"})],oO.prototype,"crlEntryExtensions",void 0);class oN{constructor(e={}){this.signature=new oS,this.issuer=new nf,this.thisUpdate=new oB,Object.assign(this,e)}}nn([i7({type:ev.Integer,optional:!0})],oN.prototype,"version",void 0),nn([i7({type:oS})],oN.prototype,"signature",void 0),nn([i7({type:nf})],oN.prototype,"issuer",void 0),nn([i7({type:oB})],oN.prototype,"thisUpdate",void 0),nn([i7({type:oB,optional:!0})],oN.prototype,"nextUpdate",void 0),nn([i7({type:oO,repeated:"sequence",optional:!0})],oN.prototype,"revokedCertificates",void 0),nn([i7({type:oC,optional:!0,context:0,repeated:"sequence"})],oN.prototype,"crlExtensions",void 0);class oM{constructor(e={}){this.tbsCertList=new oN,this.signatureAlgorithm=new oS,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:oN,raw:!0})],oM.prototype,"tbsCertList",void 0),nn([i7({type:oS})],oM.prototype,"signatureAlgorithm",void 0),nn([i7({type:ev.BitString})],oM.prototype,"signature",void 0);let oU={"2.5.4.6":"C","2.5.4.10":"O","2.5.4.11":"OU","2.5.4.3":"CN"};function oP(e){let t=ne.parse(e,oT),r=t.tbsCertificate,i={combined:""};r.issuer.forEach(([e])=>{let t=oU[e.type];t&&(i[t]=e.value.toString())}),i.combined=oD(i);let n={combined:""};r.subject.forEach(([e])=>{let t=oU[e.type];t&&(n[t]=e.value.toString())}),n.combined=oD(n);let o=!1;if(r.extensions)for(let e of r.extensions)e.extnID===nM&&(o=ne.parse(e.extnValue,nU).cA);return{issuer:i,subject:n,version:r.version,basicConstraintsCA:o,notBefore:r.validity.notBefore.getTime(),notAfter:r.validity.notAfter.getTime(),parsedCertificate:t}}function oD(e){let t=[];return e.C&&t.push(e.C),e.O&&t.push(e.O),e.OU&&t.push(e.OU),e.CN&&t.push(e.CN),t.join(" : ")}e.i(289064);class oR{constructor(e={}){this.issuer=new nf,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:nf})],oR.prototype,"issuer",void 0),nn([i7({type:ev.Integer,converter:iR})],oR.prototype,"serialNumber",void 0);let oj=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ov,context:0,implicit:!0})],oj.prototype,"subjectKeyIdentifier",void 0),nn([i7({type:oR})],oj.prototype,"issuerAndSerialNumber",void 0),oj=nn([i6({type:eg.Choice})],oj),(W=eH||(eH={}))[W.v0=0]="v0",W[W.v1=1]="v1",W[W.v2=2]="v2",W[W.v3=3]="v3",W[W.v4=4]="v4",W[W.v5=5]="v5";let oL=class extends oS{};oL=nn([i6({type:eg.Sequence})],oL);let oV=class extends oS{};oV=nn([i6({type:eg.Sequence})],oV);let oH=class extends oS{};oH=nn([i6({type:eg.Sequence})],oH);let o_=class extends oS{};o_=nn([i6({type:eg.Sequence})],o_);let oF=class extends oS{};oF=nn([i6({type:eg.Sequence})],oF);let oG=class extends oS{};oG=nn([i6({type:eg.Sequence})],oG);class oK{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],oK.prototype,"attrType",void 0),nn([i7({type:ev.Any,repeated:"set"})],oK.prototype,"attrValues",void 0);class o${constructor(e={}){this.version=eH.v0,this.sid=new oj,this.digestAlgorithm=new oL,this.signatureAlgorithm=new oV,this.signature=new iM,Object.assign(this,e)}}nn([i7({type:ev.Integer})],o$.prototype,"version",void 0),nn([i7({type:oj})],o$.prototype,"sid",void 0),nn([i7({type:oL})],o$.prototype,"digestAlgorithm",void 0),nn([i7({type:oK,repeated:"set",context:0,implicit:!0,optional:!0,raw:!0})],o$.prototype,"signedAttrs",void 0),nn([i7({type:oV})],o$.prototype,"signatureAlgorithm",void 0),nn([i7({type:iM})],o$.prototype,"signature",void 0),nn([i7({type:oK,repeated:"set",context:1,implicit:!0,optional:!0})],o$.prototype,"unsignedAttrs",void 0);let oW=e_=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e_.prototype)}};oW=e_=nn([i6({type:eg.Set,itemType:o$})],oW);let oq=class extends o${};oq=nn([i6({type:eg.Sequence})],oq);let oz=class extends oB{};oz=nn([i6({type:eg.Choice})],oz);class oQ{constructor(e={}){this.acIssuer=new ng,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}nn([i7({type:ng})],oQ.prototype,"acIssuer",void 0),nn([i7({type:ev.Integer})],oQ.prototype,"acSerial",void 0),nn([i7({type:od,repeated:"sequence"})],oQ.prototype,"attrs",void 0);let oJ=eF=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eF.prototype)}};oJ=eF=nn([i6({type:eg.Sequence,itemType:ev.ObjectIdentifier})],oJ);class oY{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}nn([i7({type:ev.Integer,optional:!0})],oY.prototype,"pathLenConstraint",void 0),nn([i7({type:oJ,implicit:!0,context:0,optional:!0})],oY.prototype,"permittedAttrs",void 0),nn([i7({type:oJ,implicit:!0,context:1,optional:!0})],oY.prototype,"excludedAttrs",void 0),nn([i7({type:ev.Boolean,defaultValue:!0})],oY.prototype,"permitUnSpecified",void 0);class oX{constructor(e={}){this.issuer=new nP,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:nP})],oX.prototype,"issuer",void 0),nn([i7({type:ev.Integer,converter:iR})],oX.prototype,"serial",void 0),nn([i7({type:ev.BitString,optional:!0})],oX.prototype,"issuerUID",void 0),(q=eG||(eG={}))[q.publicKey=0]="publicKey",q[q.publicKeyCert=1]="publicKeyCert",q[q.otherObjectTypes=2]="otherObjectTypes";class oZ{constructor(e={}){this.digestedObjectType=eG.publicKey,this.digestAlgorithm=new oS,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.Enumerated})],oZ.prototype,"digestedObjectType",void 0),nn([i7({type:ev.ObjectIdentifier,optional:!0})],oZ.prototype,"otherObjectTypeID",void 0),nn([i7({type:oS})],oZ.prototype,"digestAlgorithm",void 0),nn([i7({type:ev.BitString})],oZ.prototype,"objectDigest",void 0);class o0{constructor(e={}){Object.assign(this,e)}}nn([i7({type:nP,optional:!0})],o0.prototype,"issuerName",void 0),nn([i7({type:oX,context:0,implicit:!0,optional:!0})],o0.prototype,"baseCertificateID",void 0),nn([i7({type:oZ,context:1,implicit:!0,optional:!0})],o0.prototype,"objectDigestInfo",void 0);let o1=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ng,repeated:"sequence"})],o1.prototype,"v1Form",void 0),nn([i7({type:o0,context:0,implicit:!0})],o1.prototype,"v2Form",void 0),o1=nn([i6({type:eg.Choice})],o1);class o2{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}nn([i7({type:ev.GeneralizedTime})],o2.prototype,"notBeforeTime",void 0),nn([i7({type:ev.GeneralizedTime})],o2.prototype,"notAfterTime",void 0);class o4{constructor(e={}){Object.assign(this,e)}}nn([i7({type:oX,implicit:!0,context:0,optional:!0})],o4.prototype,"baseCertificateID",void 0),nn([i7({type:nP,implicit:!0,context:1,optional:!0})],o4.prototype,"entityName",void 0),nn([i7({type:oZ,implicit:!0,context:2,optional:!0})],o4.prototype,"objectDigestInfo",void 0),(z=eK||(eK={}))[z.v2=1]="v2";class o8{constructor(e={}){this.version=eK.v2,this.holder=new o4,this.issuer=new o1,this.signature=new oS,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new o2,this.attributes=[],Object.assign(this,e)}}nn([i7({type:ev.Integer})],o8.prototype,"version",void 0),nn([i7({type:o4})],o8.prototype,"holder",void 0),nn([i7({type:o1})],o8.prototype,"issuer",void 0),nn([i7({type:oS})],o8.prototype,"signature",void 0),nn([i7({type:ev.Integer,converter:iR})],o8.prototype,"serialNumber",void 0),nn([i7({type:o2})],o8.prototype,"attrCertValidityPeriod",void 0),nn([i7({type:od,repeated:"sequence"})],o8.prototype,"attributes",void 0),nn([i7({type:ev.BitString,optional:!0})],o8.prototype,"issuerUniqueID",void 0),nn([i7({type:ok,optional:!0})],o8.prototype,"extensions",void 0);class o5{constructor(e={}){this.acinfo=new o8,this.signatureAlgorithm=new oS,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:o8})],o5.prototype,"acinfo",void 0),nn([i7({type:oS})],o5.prototype,"signatureAlgorithm",void 0),nn([i7({type:ev.BitString})],o5.prototype,"signatureValue",void 0),(Q=e$||(e$={}))[Q.unmarked=1]="unmarked",Q[Q.unclassified=2]="unclassified",Q[Q.restricted=4]="restricted",Q[Q.confidential=8]="confidential",Q[Q.secret=16]="secret",Q[Q.topSecret=32]="topSecret";class o3 extends iN{}class o6{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier,implicit:!0,context:0})],o6.prototype,"type",void 0),nn([i7({type:ev.Any,implicit:!0,context:1})],o6.prototype,"value",void 0);class o7{constructor(e={}){this.policyId="",this.classList=new o3(e$.unclassified),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],o7.prototype,"policyId",void 0),nn([i7({type:o3,defaultValue:new o3(e$.unclassified)})],o7.prototype,"classList",void 0),nn([i7({type:o6,repeated:"set"})],o7.prototype,"securityCategories",void 0);class o9{constructor(e={}){Object.assign(this,e)}}nn([i7({type:iM})],o9.prototype,"cotets",void 0),nn([i7({type:ev.ObjectIdentifier})],o9.prototype,"oid",void 0),nn([i7({type:ev.Utf8String})],o9.prototype,"string",void 0);class se{constructor(e={}){this.values=[],Object.assign(this,e)}}nn([i7({type:nP,implicit:!0,context:0,optional:!0})],se.prototype,"policyAuthority",void 0),nn([i7({type:o9,repeated:"sequence"})],se.prototype,"values",void 0);class st{constructor(e={}){this.targetCertificate=new oX,Object.assign(this,e)}}nn([i7({type:oX})],st.prototype,"targetCertificate",void 0),nn([i7({type:ng,optional:!0})],st.prototype,"targetName",void 0),nn([i7({type:oZ,optional:!0})],st.prototype,"certDigestInfo",void 0);let sr=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ng,context:0,implicit:!0})],sr.prototype,"targetName",void 0),nn([i7({type:ng,context:1,implicit:!0})],sr.prototype,"targetGroup",void 0),nn([i7({type:st,context:2,implicit:!0})],sr.prototype,"targetCert",void 0),sr=nn([i6({type:eg.Choice})],sr);let si=eW=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eW.prototype)}};si=eW=nn([i6({type:eg.Sequence,itemType:sr})],si);let sn=eq=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eq.prototype)}};sn=eq=nn([i6({type:eg.Sequence,itemType:si})],sn);class so{constructor(e={}){Object.assign(this,e)}}nn([i7({type:nP,implicit:!0,context:0,optional:!0})],so.prototype,"roleAuthority",void 0),nn([i7({type:ng,implicit:!0,context:1})],so.prototype,"roleName",void 0);class ss{constructor(e={}){this.service=new ng,this.ident=new ng,Object.assign(this,e)}}nn([i7({type:ng})],ss.prototype,"service",void 0),nn([i7({type:ng})],ss.prototype,"ident",void 0),nn([i7({type:iM,optional:!0})],ss.prototype,"authInfo",void 0);class sa{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sa.prototype,"otherCertFormat",void 0),nn([i7({type:ev.Any})],sa.prototype,"otherCert",void 0);let sl=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:oT})],sl.prototype,"certificate",void 0),nn([i7({type:o5,context:2,implicit:!0})],sl.prototype,"v2AttrCert",void 0),nn([i7({type:sa,context:3,implicit:!0})],sl.prototype,"other",void 0),sl=nn([i6({type:eg.Choice})],sl);let sc=ez=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,ez.prototype)}};sc=ez=nn([i6({type:eg.Set,itemType:sl})],sc);class su{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],su.prototype,"contentType",void 0),nn([i7({type:ev.Any,context:0})],su.prototype,"content",void 0);let sp=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:iM})],sp.prototype,"single",void 0),nn([i7({type:ev.Any})],sp.prototype,"any",void 0),sp=nn([i6({type:eg.Choice})],sp);class sh{constructor(e={}){this.eContentType="",Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sh.prototype,"eContentType",void 0),nn([i7({type:sp,context:0,optional:!0})],sh.prototype,"eContent",void 0);let sf=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:iM,context:0,implicit:!0,optional:!0})],sf.prototype,"value",void 0),nn([i7({type:iM,converter:{fromASN:e=>new iM(e.getValue()),toASN:e=>e.toASN()},context:0,implicit:!0,optional:!0,repeated:"sequence"})],sf.prototype,"constructedValue",void 0),sf=nn([i6({type:eg.Choice})],sf);class sd{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new o_,Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sd.prototype,"contentType",void 0),nn([i7({type:o_})],sd.prototype,"contentEncryptionAlgorithm",void 0),nn([i7({type:sf,optional:!0})],sd.prototype,"encryptedContent",void 0);class sy{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sy.prototype,"keyAttrId",void 0),nn([i7({type:ev.Any,optional:!0})],sy.prototype,"keyAttr",void 0);class sg{constructor(e={}){this.subjectKeyIdentifier=new ov,Object.assign(this,e)}}nn([i7({type:ov})],sg.prototype,"subjectKeyIdentifier",void 0),nn([i7({type:ev.GeneralizedTime,optional:!0})],sg.prototype,"date",void 0),nn([i7({type:sy,optional:!0})],sg.prototype,"other",void 0);let sv=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:sg,context:0,implicit:!0,optional:!0})],sv.prototype,"rKeyId",void 0),nn([i7({type:oR,optional:!0})],sv.prototype,"issuerAndSerialNumber",void 0),sv=nn([i6({type:eg.Choice})],sv);class sm{constructor(e={}){this.rid=new sv,this.encryptedKey=new iM,Object.assign(this,e)}}nn([i7({type:sv})],sm.prototype,"rid",void 0),nn([i7({type:iM})],sm.prototype,"encryptedKey",void 0);let sw=eQ=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eQ.prototype)}};sw=eQ=nn([i6({type:eg.Sequence,itemType:sm})],sw);class sA{constructor(e={}){this.algorithm=new oS,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:oS})],sA.prototype,"algorithm",void 0),nn([i7({type:ev.BitString})],sA.prototype,"publicKey",void 0);let sb=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ov,context:0,implicit:!0,optional:!0})],sb.prototype,"subjectKeyIdentifier",void 0),nn([i7({type:sA,context:1,implicit:!0,optional:!0})],sb.prototype,"originatorKey",void 0),nn([i7({type:oR,optional:!0})],sb.prototype,"issuerAndSerialNumber",void 0),sb=nn([i6({type:eg.Choice})],sb);class sS{constructor(e={}){this.version=eH.v3,this.originator=new sb,this.keyEncryptionAlgorithm=new oH,this.recipientEncryptedKeys=new sw,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sS.prototype,"version",void 0),nn([i7({type:sb,context:0})],sS.prototype,"originator",void 0),nn([i7({type:iM,context:1,optional:!0})],sS.prototype,"ukm",void 0),nn([i7({type:oH})],sS.prototype,"keyEncryptionAlgorithm",void 0),nn([i7({type:sw})],sS.prototype,"recipientEncryptedKeys",void 0);let sE=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ov,context:0,implicit:!0})],sE.prototype,"subjectKeyIdentifier",void 0),nn([i7({type:oR})],sE.prototype,"issuerAndSerialNumber",void 0),sE=nn([i6({type:eg.Choice})],sE);class sB{constructor(e={}){this.version=eH.v0,this.rid=new sE,this.keyEncryptionAlgorithm=new oH,this.encryptedKey=new iM,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sB.prototype,"version",void 0),nn([i7({type:sE})],sB.prototype,"rid",void 0),nn([i7({type:oH})],sB.prototype,"keyEncryptionAlgorithm",void 0),nn([i7({type:iM})],sB.prototype,"encryptedKey",void 0);class sx{constructor(e={}){this.keyIdentifier=new iM,Object.assign(this,e)}}nn([i7({type:iM})],sx.prototype,"keyIdentifier",void 0),nn([i7({type:ev.GeneralizedTime,optional:!0})],sx.prototype,"date",void 0),nn([i7({type:sy,optional:!0})],sx.prototype,"other",void 0);class sC{constructor(e={}){this.version=eH.v4,this.kekid=new sx,this.keyEncryptionAlgorithm=new oH,this.encryptedKey=new iM,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sC.prototype,"version",void 0),nn([i7({type:sx})],sC.prototype,"kekid",void 0),nn([i7({type:oH})],sC.prototype,"keyEncryptionAlgorithm",void 0),nn([i7({type:iM})],sC.prototype,"encryptedKey",void 0);class sk{constructor(e={}){this.version=eH.v0,this.keyEncryptionAlgorithm=new oH,this.encryptedKey=new iM,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sk.prototype,"version",void 0),nn([i7({type:oG,context:0,optional:!0})],sk.prototype,"keyDerivationAlgorithm",void 0),nn([i7({type:oH})],sk.prototype,"keyEncryptionAlgorithm",void 0),nn([i7({type:iM})],sk.prototype,"encryptedKey",void 0);class sI{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sI.prototype,"oriType",void 0),nn([i7({type:ev.Any})],sI.prototype,"oriValue",void 0);let sT=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:sB,optional:!0})],sT.prototype,"ktri",void 0),nn([i7({type:sS,context:1,implicit:!0,optional:!0})],sT.prototype,"kari",void 0),nn([i7({type:sC,context:2,implicit:!0,optional:!0})],sT.prototype,"kekri",void 0),nn([i7({type:sk,context:3,implicit:!0,optional:!0})],sT.prototype,"pwri",void 0),nn([i7({type:sI,context:4,implicit:!0,optional:!0})],sT.prototype,"ori",void 0),sT=nn([i6({type:eg.Choice})],sT);let sO=eJ=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eJ.prototype)}};sO=eJ=nn([i6({type:eg.Set,itemType:sT})],sO);class sN{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],sN.prototype,"otherRevInfoFormat",void 0),nn([i7({type:ev.Any})],sN.prototype,"otherRevInfo",void 0);let sM=class{constructor(e={}){this.other=new sN,Object.assign(this,e)}};nn([i7({type:sN,context:1,implicit:!0})],sM.prototype,"other",void 0),sM=nn([i6({type:eg.Choice})],sM);let sU=eY=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eY.prototype)}};sU=eY=nn([i6({type:eg.Set,itemType:sM})],sU);class sP{constructor(e={}){Object.assign(this,e)}}nn([i7({type:sc,context:0,implicit:!0,optional:!0})],sP.prototype,"certs",void 0),nn([i7({type:sU,context:1,implicit:!0,optional:!0})],sP.prototype,"crls",void 0);let sD=eX=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eX.prototype)}};sD=eX=nn([i6({type:eg.Set,itemType:oK})],sD);class sR{constructor(e={}){this.version=eH.v0,this.recipientInfos=new sO,this.encryptedContentInfo=new sd,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sR.prototype,"version",void 0),nn([i7({type:sP,context:0,implicit:!0,optional:!0})],sR.prototype,"originatorInfo",void 0),nn([i7({type:sO})],sR.prototype,"recipientInfos",void 0),nn([i7({type:sd})],sR.prototype,"encryptedContentInfo",void 0),nn([i7({type:sD,context:1,implicit:!0,optional:!0})],sR.prototype,"unprotectedAttrs",void 0);let sj=eZ=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,eZ.prototype)}};sj=eZ=nn([i6({type:eg.Set,itemType:oL})],sj);class sL{constructor(e={}){this.version=eH.v0,this.digestAlgorithms=new sj,this.encapContentInfo=new sh,this.signerInfos=new oW,Object.assign(this,e)}}nn([i7({type:ev.Integer})],sL.prototype,"version",void 0),nn([i7({type:sj})],sL.prototype,"digestAlgorithms",void 0),nn([i7({type:sh})],sL.prototype,"encapContentInfo",void 0),nn([i7({type:sc,context:0,implicit:!0,optional:!0})],sL.prototype,"certificates",void 0),nn([i7({type:sU,context:1,implicit:!0,optional:!0})],sL.prototype,"crls",void 0),nn([i7({type:oW})],sL.prototype,"signerInfos",void 0);let sV="1.2.840.10045.2.1",sH="1.2.840.10045.4.1",s_="1.2.840.10045.4.3.1",sF="1.2.840.10045.4.3.2",sG="1.2.840.10045.4.3.3",sK="1.2.840.10045.4.3.4",s$="1.2.840.10045.3.1.7",sW="1.3.132.0.34",sq="1.3.132.0.35";function sz(e){return new oS({algorithm:e})}let sQ=sz(sH);sz(s_);let sJ=sz(sF),sY=sz(sG),sX=sz(sK),sZ=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ev.ObjectIdentifier})],sZ.prototype,"fieldType",void 0),nn([i7({type:ev.Any})],sZ.prototype,"parameters",void 0),sZ=nn([i6({type:eg.Sequence})],sZ);let s0=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ev.OctetString})],s0.prototype,"a",void 0),nn([i7({type:ev.OctetString})],s0.prototype,"b",void 0),nn([i7({type:ev.BitString,optional:!0})],s0.prototype,"seed",void 0),s0=nn([i6({type:eg.Sequence})],s0),(J=e0||(e0={}))[J.ecpVer1=1]="ecpVer1";let s1=class{constructor(e={}){this.version=e0.ecpVer1,Object.assign(this,e)}};nn([i7({type:ev.Integer})],s1.prototype,"version",void 0),nn([i7({type:sZ})],s1.prototype,"fieldID",void 0),nn([i7({type:s0})],s1.prototype,"curve",void 0),nn([i7({type:class extends iM{}})],s1.prototype,"base",void 0),nn([i7({type:ev.Integer,converter:iR})],s1.prototype,"order",void 0),nn([i7({type:ev.Integer,optional:!0})],s1.prototype,"cofactor",void 0),s1=nn([i6({type:eg.Sequence})],s1);let s2=class{constructor(e={}){Object.assign(this,e)}};nn([i7({type:ev.ObjectIdentifier})],s2.prototype,"namedCurve",void 0),nn([i7({type:ev.Null})],s2.prototype,"implicitCurve",void 0),nn([i7({type:s1})],s2.prototype,"specifiedCurve",void 0),s2=nn([i6({type:eg.Choice})],s2);class s4{constructor(e={}){this.version=1,this.privateKey=new iM,Object.assign(this,e)}}nn([i7({type:ev.Integer})],s4.prototype,"version",void 0),nn([i7({type:iM})],s4.prototype,"privateKey",void 0),nn([i7({type:s2,context:0,optional:!0})],s4.prototype,"parameters",void 0),nn([i7({type:ev.BitString,context:1,optional:!0})],s4.prototype,"publicKey",void 0);class s8{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.Integer,converter:iR})],s8.prototype,"r",void 0),nn([i7({type:ev.Integer,converter:iR})],s8.prototype,"s",void 0);let s5="1.2.840.113549.1.1",s3=`${s5}.1`,s6=`${s5}.7`,s7=`${s5}.9`,s9=`${s5}.10`,ae=`${s5}.2`,at=`${s5}.4`,ar=`${s5}.5`,ai=`${s5}.14`,an=`${s5}.11`,ao=`${s5}.12`,as=`${s5}.13`,aa=`${s5}.15`,al=`${s5}.16`,ac="1.3.14.3.2.26",au="2.16.840.1.101.3.4.2.4",ap="2.16.840.1.101.3.4.2.1",ah="2.16.840.1.101.3.4.2.2",af="2.16.840.1.101.3.4.2.3",ad=`${s5}.8`;function ay(e){return new oS({algorithm:e,parameters:null})}ay("1.2.840.113549.2.2"),ay("1.2.840.113549.2.5");let ag=ay(ac);ay(au),ay(ap),ay(ah),ay(af),ay("2.16.840.1.101.3.4.2.5"),ay("2.16.840.1.101.3.4.2.6");let av=new oS({algorithm:ad,parameters:ni.serialize(ag)}),am=new oS({algorithm:s7,parameters:ni.serialize(iH.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});ay(s3),ay(ae),ay(at),ay(ar),ay(aa),ay(al),ay(ao),ay(as),ay(aa),ay(al);class aw{constructor(e={}){this.hashAlgorithm=new oS(ag),this.maskGenAlgorithm=new oS({algorithm:ad,parameters:ni.serialize(ag)}),this.pSourceAlgorithm=new oS(am),Object.assign(this,e)}}nn([i7({type:oS,context:0,defaultValue:ag})],aw.prototype,"hashAlgorithm",void 0),nn([i7({type:oS,context:1,defaultValue:av})],aw.prototype,"maskGenAlgorithm",void 0),nn([i7({type:oS,context:2,defaultValue:am})],aw.prototype,"pSourceAlgorithm",void 0),new oS({algorithm:s6,parameters:ni.serialize(new aw)});class aA{constructor(e={}){this.hashAlgorithm=new oS(ag),this.maskGenAlgorithm=new oS({algorithm:ad,parameters:ni.serialize(ag)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}nn([i7({type:oS,context:0,defaultValue:ag})],aA.prototype,"hashAlgorithm",void 0),nn([i7({type:oS,context:1,defaultValue:av})],aA.prototype,"maskGenAlgorithm",void 0),nn([i7({type:ev.Integer,context:2,defaultValue:20})],aA.prototype,"saltLength",void 0),nn([i7({type:ev.Integer,context:3,defaultValue:1})],aA.prototype,"trailerField",void 0),new oS({algorithm:s9,parameters:ni.serialize(new aA)});class ab{constructor(e={}){this.digestAlgorithm=new oS,this.digest=new iM,Object.assign(this,e)}}nn([i7({type:oS})],ab.prototype,"digestAlgorithm",void 0),nn([i7({type:iM})],ab.prototype,"digest",void 0);class aS{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.Integer,converter:iR})],aS.prototype,"prime",void 0),nn([i7({type:ev.Integer,converter:iR})],aS.prototype,"exponent",void 0),nn([i7({type:ev.Integer,converter:iR})],aS.prototype,"coefficient",void 0);let aE=e1=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e1.prototype)}};aE=e1=nn([i6({type:eg.Sequence,itemType:aS})],aE);class aB{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.Integer})],aB.prototype,"version",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"modulus",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"publicExponent",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"privateExponent",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"prime1",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"prime2",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"exponent1",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"exponent2",void 0),nn([i7({type:ev.Integer,converter:iR})],aB.prototype,"coefficient",void 0),nn([i7({type:aE,optional:!0})],aB.prototype,"otherPrimeInfos",void 0);class ax{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.Integer,converter:iR})],ax.prototype,"modulus",void 0),nn([i7({type:ev.Integer,converter:iR})],ax.prototype,"publicExponent",void 0),(Y=e2||(e2={}))[Y.Transient=0]="Transient",Y[Y.Singleton=1]="Singleton",Y[Y.ResolutionScoped=2]="ResolutionScoped",Y[Y.ContainerScoped=3]="ContainerScoped";let aC=e2;var ak=function(e,t){return(ak=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function aI(e,t){function r(){this.constructor=e}ak(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function aT(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function aO(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function aN(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(aO(arguments[t]));return e}function aM(e){return!!e.useClass}function aU(e){return!!e.useFactory}var aP=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler(function(){return i||(t=e(r.wrap()),i=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]=e(),Reflect[r].apply(void 0,aN(t))}}),t},e}();function aD(e){return"string"==typeof e||"symbol"==typeof e}function aR(e){return"object"==typeof e&&"token"in e&&"transform"in e}function aj(e){return!!e.useToken}function aL(e){return void 0!=e.useValue}var aV=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),aH=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aI(t,e),t}(aV);let a_=function(){this.scopedResolutions=new Map};var aF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aI(t,e),t}(aV),aG=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return aI(t,e),t}(aV);let aK=function(){this.preResolution=new aF,this.postResolution=new aG};var a$=new Map,aW=new(function(){function e(e){this.parent=e,this._registry=new aH,this.interceptors=new aK,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){if(void 0===r&&(r={lifecycle:aC.Transient}),this.ensureNotDisposed(),i=aM(t)||aL(t)||aj(t)||aU(t)?t:{useClass:t},aj(i))for(var i,n=[e],o=i;null!=o;){var s=o.useToken;if(n.includes(s))throw Error("Token registration cycle detected! "+aN(n,[s]).join(" -> "));n.push(s);var a=this._registry.get(s);o=a&&aj(a.provider)?a.provider:null}if((r.lifecycle===aC.Singleton||r.lifecycle==aC.ContainerScoped||r.lifecycle==aC.ResolutionScoped)&&(aL(i)||aU(i)))throw Error('Cannot use lifecycle "'+aC[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),aD(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),aD(e)){if(aD(t))return this.register(e,{useToken:t},{lifecycle:aC.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:aC.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!aD(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:aC.Singleton})},e.prototype.resolve=function(e,t,r){void 0===t&&(t=new a_),void 0===r&&(r=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&aD(e)){if(r)return;throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if("function"==typeof e||e instanceof aP){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var n=[];try{for(var o=aT(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var a=s.value;"Once"!=a.options.frequency&&n.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,n)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,n;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=aT(this.interceptors.postResolution.getAll(e)),a=s.next();!a.done;a=s.next()){var l=a.value;"Once"!=l.options.frequency&&o.push(l),l.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===aC.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===aC.Singleton,n=e.options.lifecycle===aC.ContainerScoped,o=i||n;return r=aL(e.provider)?e.provider.useValue:aj(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):aM(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):aU(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===aC.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t,r){var i=this;void 0===t&&(t=new a_),void 0===r&&(r=!1),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&aD(e)){if(r)return[];throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),n){var o=n.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,o,"All"),o}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=aT(this._registry.entries()),i=r.next();!i.done;i=r.next()){var n=aO(i.value,2),o=n[0],s=n[1];this._registry.setAll(o,s.filter(function(e){return!aL(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,r,i=new e(this);try{for(var n=aT(this._registry.entries()),o=n.next();!o.done;o=n.next()){var s=aO(o.value,2),a=s[0],l=s[1];l.some(function(e){return e.options.lifecycle===aC.ContainerScoped})&&i._registry.setAll(a,l.map(function(e){return e.options.lifecycle===aC.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){var e,t,r,i;return e=this,t=void 0,r=void 0,i=function(){var e;return function(e,t){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){var l=[o,a];if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(n=2&l[0]?i.return:l[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,l[1])).done)return n;switch(i=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,i=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){s=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){s.label=l[1];break}if(6===l[0]&&s.label<n[1]){s.label=n[1],n=l;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(l);break}n[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],i=0}finally{r=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var r=t.dispose();r&&e.push(r)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(r||(r=Promise))(function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof aP)return e.createProxy(function(e){return r.resolve(e,t)});var i=function(){var i=a$.get(e);if(!i||0===i.length)if(0===e.length)return new e;else throw Error('TypeInfo not known for "'+e.name+'"');var n=i.map(r.resolveParams(t,e));return new(e.bind.apply(e,aN([void 0],n)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(i,n){var o,s,a,l,c,u,p;try{if("object"==typeof i&&"token"in i&&"multiple"in i)if(aR(i))return i.multiple?(o=r.resolve(i.transform)).transform.apply(o,aN([r.resolveAll(i.token,new a_,i.isOptional)],i.transformArgs)):(s=r.resolve(i.transform)).transform.apply(s,aN([r.resolve(i.token,e,i.isOptional)],i.transformArgs));else return i.multiple?r.resolveAll(i.token,new a_,i.isOptional):r.resolve(i.token,e,i.isOptional);if(aR(i))return(a=r.resolve(i.transform,e)).transform.apply(a,aN([r.resolve(i.token,e)],i.transformArgs));return r.resolve(i,e)}catch(e){throw Error((u="Cannot inject the dependency "+(c=void 0===(l=aO(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:l,null===c?"at position #"+n:'"'+c.split(",")[n].trim()+'" at position #'+n)+' of "'+t.name+'" constructor. Reason:',void 0===p&&(p="    "),aN([u],e.message.split("\n").map(function(e){return p+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}());let aq=function(e){return function(t){var r,i;a$.set(t,(r=Reflect.getMetadata("design:paramtypes",t)||[],Object.keys(i=Reflect.getOwnMetadata("injectionTokens",t)||{}).forEach(function(e){r[+e]=i[e]}),r)),e&&e.token&&(Array.isArray(e.token)?e.token.forEach(function(e){aW.register(e,t)}):aW.register(e.token,t))}};if(e.s([],399226),"u"<typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");e.i(399226);class az{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}nn([i7({type:ev.ObjectIdentifier})],az.prototype,"attrId",void 0),nn([i7({type:ev.Any,repeated:"set"})],az.prototype,"attrValues",void 0);let aQ=e4=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e4.prototype)}};aQ=e4=nn([i6({type:eg.Sequence,itemType:az})],aQ);let aJ=e8=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e8.prototype)}};aJ=e8=nn([i6({type:eg.Sequence,itemType:su})],aJ);class aY{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],aY.prototype,"certId",void 0),nn([i7({type:ev.Any,context:0})],aY.prototype,"certValue",void 0);class aX{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],aX.prototype,"crlId",void 0),nn([i7({type:ev.Any,context:0})],aX.prototype,"crltValue",void 0);class aZ extends iM{}class a0{constructor(e={}){this.encryptionAlgorithm=new oS,this.encryptedData=new aZ,Object.assign(this,e)}}nn([i7({type:oS})],a0.prototype,"encryptionAlgorithm",void 0),nn([i7({type:aZ})],a0.prototype,"encryptedData",void 0),(X=e3||(e3={}))[X.v1=0]="v1";class a1 extends iM{}let a2=e5=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e5.prototype)}};a2=e5=nn([i6({type:eg.Sequence,itemType:od})],a2);class a4{constructor(e={}){this.version=e3.v1,this.privateKeyAlgorithm=new oS,this.privateKey=new a1,Object.assign(this,e)}}nn([i7({type:ev.Integer})],a4.prototype,"version",void 0),nn([i7({type:oS})],a4.prototype,"privateKeyAlgorithm",void 0),nn([i7({type:a1})],a4.prototype,"privateKey",void 0),nn([i7({type:a2,implicit:!0,context:0,optional:!0})],a4.prototype,"attributes",void 0);let a8=class extends a4{};a8=nn([i6({type:eg.Sequence})],a8);let a5=class extends a0{};a5=nn([i6({type:eg.Sequence})],a5);class a3{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],a3.prototype,"secretTypeId",void 0),nn([i7({type:ev.Any,context:0})],a3.prototype,"secretValue",void 0);class a6{constructor(e={}){this.mac=new ab,this.macSalt=new iM,this.iterations=1,Object.assign(this,e)}}nn([i7({type:ab})],a6.prototype,"mac",void 0),nn([i7({type:iM})],a6.prototype,"macSalt",void 0),nn([i7({type:ev.Integer,defaultValue:1})],a6.prototype,"iterations",void 0);class a7{constructor(e={}){this.version=3,this.authSafe=new su,this.macData=new a6,Object.assign(this,e)}}nn([i7({type:ev.Integer})],a7.prototype,"version",void 0),nn([i7({type:su})],a7.prototype,"authSafe",void 0),nn([i7({type:a6,optional:!0})],a7.prototype,"macData",void 0);class a9{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:ev.ObjectIdentifier})],a9.prototype,"bagId",void 0),nn([i7({type:ev.Any,context:0})],a9.prototype,"bagValue",void 0),nn([i7({type:az,repeated:"set",optional:!0})],a9.prototype,"bagAttributes",void 0);let le=e6=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e6.prototype)}};le=e6=nn([i6({type:eg.Sequence,itemType:a9})],le);let lt="1.2.840.113549.1.9",lr=`${lt}.7`,li=`${lt}.14`,ln=class extends nl{constructor(e={}){super(e)}toString(){return({}).toString(),this.ia5String||super.toString()}};nn([i7({type:ev.IA5String})],ln.prototype,"ia5String",void 0),ln=nn([i6({type:eg.Choice})],ln);let lo=class extends su{};lo=nn([i6({type:eg.Sequence})],lo);let ls=class extends a7{};ls=nn([i6({type:eg.Sequence})],ls);let la=class extends a0{};la=nn([i6({type:eg.Sequence})],la);let ll=class{constructor(e=""){this.value=e}toString(){return this.value}};nn([i7({type:ev.IA5String})],ll.prototype,"value",void 0),ll=nn([i6({type:eg.Choice})],ll);let lc=class extends ln{};lc=nn([i6({type:eg.Choice})],lc);let lu=class extends nl{};lu=nn([i6({type:eg.Choice})],lu);let lp=class{constructor(e=new Date){this.value=e}};nn([i7({type:ev.GeneralizedTime})],lp.prototype,"value",void 0),lp=nn([i6({type:eg.Choice})],lp);let lh=class extends nl{};lh=nn([i6({type:eg.Choice})],lh);let lf=class{constructor(e="M"){this.value=e}toString(){return this.value}};nn([i7({type:ev.PrintableString})],lf.prototype,"value",void 0),lf=nn([i6({type:eg.Choice})],lf);let ld=class{constructor(e=""){this.value=e}toString(){return this.value}};nn([i7({type:ev.PrintableString})],ld.prototype,"value",void 0),ld=nn([i6({type:eg.Choice})],ld);let ly=class extends ld{};ly=nn([i6({type:eg.Choice})],ly);let lg=class extends nl{};lg=nn([i6({type:eg.Choice})],lg);let lv=class{constructor(e=""){this.value=e}toString(){return this.value}};nn([i7({type:ev.ObjectIdentifier})],lv.prototype,"value",void 0),lv=nn([i6({type:eg.Choice})],lv);let lm=class extends oB{};lm=nn([i6({type:eg.Choice})],lm);let lw=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};nn([i7({type:ev.Integer})],lw.prototype,"value",void 0),lw=nn([i6({type:eg.Choice})],lw);let lA=class extends o${};lA=nn([i6({type:eg.Sequence})],lA);let lb=class extends nl{};lb=nn([i6({type:eg.Choice})],lb);let lS=e7=class extends ok{constructor(e){super(e),Object.setPrototypeOf(this,e7.prototype)}};lS=e7=nn([i6({type:eg.Sequence})],lS);let lE=e9=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,e9.prototype)}};lE=e9=nn([i6({type:eg.Set,itemType:oK})],lE);let lB=class{constructor(e=""){this.value=e}toString(){return this.value}};nn([i7({type:ev.BmpString})],lB.prototype,"value",void 0),lB=nn([i6({type:eg.Choice})],lB);let lx=class extends oS{};lx=nn([i6({type:eg.Sequence})],lx);let lC=te=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,te.prototype)}};lC=te=nn([i6({type:eg.Sequence,itemType:lx})],lC);let lk=tt=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,tt.prototype)}};lk=tt=nn([i6({type:eg.Sequence,itemType:od})],lk);class lI{constructor(e={}){this.version=0,this.subject=new nf,this.subjectPKInfo=new oE,this.attributes=new lk,Object.assign(this,e)}}nn([i7({type:ev.Integer})],lI.prototype,"version",void 0),nn([i7({type:nf})],lI.prototype,"subject",void 0),nn([i7({type:oE})],lI.prototype,"subjectPKInfo",void 0),nn([i7({type:lk,implicit:!0,context:0,optional:!0})],lI.prototype,"attributes",void 0);class lT{constructor(e={}){this.certificationRequestInfo=new lI,this.signatureAlgorithm=new oS,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}nn([i7({type:lI,raw:!0})],lT.prototype,"certificationRequestInfo",void 0),nn([i7({type:oS})],lT.prototype,"signatureAlgorithm",void 0),nn([i7({type:ev.BitString})],lT.prototype,"signature",void 0);let lO="crypto.algorithm",lN="crypto.algorithmProvider";aW.registerSingleton(lN,class{getAlgorithms(){return aW.resolveAll(lO)}toAsnAlgorithm(e){for(let t of({...e},this.getAlgorithms())){let r=t.toAsnAlgorithm(e);if(r)return r}if(/^[0-9.]+$/.test(e.name)){let t=new oS({algorithm:e.name});return"parameters"in e&&(t.parameters=e.parameters),t}throw Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(let t of this.getAlgorithms()){let r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});let lM="1.3.36.3.3.2.8.1.1",lU=`${lM}.1`,lP=`${lM}.2`,lD=`${lM}.3`,lR=`${lM}.4`,lj=`${lM}.5`,lL=`${lM}.6`,lV=`${lM}.7`,lH=`${lM}.8`,l_=`${lM}.9`,lF=`${lM}.10`,lG=`${lM}.11`,lK=`${lM}.12`,l$=`${lM}.13`,lW=`${lM}.14`,lq="brainpoolP160r1",lz="brainpoolP160t1",lQ="brainpoolP192r1",lJ="brainpoolP192t1",lY="brainpoolP224r1",lX="brainpoolP224t1",lZ="brainpoolP256r1",l0="brainpoolP256t1",l1="brainpoolP320r1",l2="brainpoolP320t1",l4="brainpoolP384r1",l8="brainpoolP384t1",l5="brainpoolP512r1",l3="brainpoolP512t1",l6="ECDSA",l7=tr=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===l6.toLowerCase()){if("hash"in e)switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return sQ;case"sha-256":return sJ;case"sha-384":return sY;case"sha-512":return sX}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=s$;break;case"K-256":t=tr.SECP256K1;break;case"P-384":t=sW;break;case"P-521":t=sq;break;case lq:t=lU;break;case lz:t=lP;break;case lQ:t=lD;break;case lJ:t=lR;break;case lY:t=lj;break;case lX:t=lL;break;case lZ:t=lV;break;case l0:t=lH;break;case l1:t=l_;break;case l2:t=lF;break;case l4:t=lG;break;case l8:t=lK;break;case l5:t=l$;break;case l3:t=lW}if(t)return new oS({algorithm:sV,parameters:ni.serialize(new s2({namedCurve:t}))})}}return null}toWebAlgorithm(e){switch(e.algorithm){case sH:return{name:l6,hash:{name:"SHA-1"}};case sF:return{name:l6,hash:{name:"SHA-256"}};case sG:return{name:l6,hash:{name:"SHA-384"}};case sK:return{name:l6,hash:{name:"SHA-512"}};case sV:if(!e.parameters)throw TypeError("Cannot get required parameters from EC algorithm");switch(ni.parse(e.parameters,s2).namedCurve){case s$:return{name:l6,namedCurve:"P-256"};case tr.SECP256K1:return{name:l6,namedCurve:"K-256"};case sW:return{name:l6,namedCurve:"P-384"};case sq:return{name:l6,namedCurve:"P-521"};case lU:return{name:l6,namedCurve:lq};case lP:return{name:l6,namedCurve:lz};case lD:return{name:l6,namedCurve:lQ};case lR:return{name:l6,namedCurve:lJ};case lj:return{name:l6,namedCurve:lY};case lL:return{name:l6,namedCurve:lX};case lV:return{name:l6,namedCurve:lZ};case lH:return{name:l6,namedCurve:l0};case l_:return{name:l6,namedCurve:l1};case lF:return{name:l6,namedCurve:l2};case lG:return{name:l6,namedCurve:l4};case lK:return{name:l6,namedCurve:l8};case l$:return{name:l6,namedCurve:l5};case lW:return{name:l6,namedCurve:l3}}}return null}};l7.SECP256K1="1.3.132.0.10",l7=tr=nn([aq()],l7),aW.registerSingleton(lO,l7);let l9=Symbol("name"),ce=Symbol("value");class ct{constructor(e,t={},r=""){for(const i in this[l9]=e,this[ce]=r,t)this[i]=t[i]}}ct.NAME=l9,ct.VALUE=ce;class cr{static toString(e){let t=this.items[e];return t||e}}cr.items={[ac]:"sha1",[au]:"sha224",[ap]:"sha256",[ah]:"sha384",[af]:"sha512",[s3]:"rsaEncryption",[ar]:"sha1WithRSAEncryption",[ai]:"sha224WithRSAEncryption",[an]:"sha256WithRSAEncryption",[ao]:"sha384WithRSAEncryption",[as]:"sha512WithRSAEncryption",[sV]:"ecPublicKey",[sH]:"ecdsaWithSHA1",[s_]:"ecdsaWithSHA224",[sF]:"ecdsaWithSHA256",[sG]:"ecdsaWithSHA384",[sK]:"ecdsaWithSHA512",[n4]:"TLS WWW server authentication",[n8]:"TLS WWW client authentication",[n5]:"Code Signing",[n3]:"E-mail Protection",[n6]:"Time Stamping",[n7]:"OCSP Signing","1.2.840.113549.1.7.2":"Signed Data"};class ci{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){let r=[],i=this.pad(t++),n="",o=e[ct.VALUE];for(let s in o&&(n=` ${o}`),r.push(`${i}${e[ct.NAME]}:${n}`),i=this.pad(t),e){if("symbol"==typeof s)continue;let n=e[s],o=s?`${s}: `:"";if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)r.push(`${i}${o}${n}`);else if(n instanceof Date)r.push(`${i}${o}${n.toUTCString()}`);else if(Array.isArray(n))for(let e of n)e[ct.NAME]=s,r.push(...this.serializeObj(e,t));else if(n instanceof ct)n[ct.NAME]=s,r.push(...this.serializeObj(n,t));else if(re.isBufferSource(n))s?(r.push(`${i}${o}`),r.push(...this.serializeBufferSource(n,t+1))):r.push(...this.serializeBufferSource(n,t));else if("toTextObject"in n){let e=n.toTextObject();e[ct.NAME]=s,r.push(...this.serializeObj(e,t))}else throw TypeError("Cannot serialize data in text format. Unsupported type.")}return r}static serializeBufferSource(e,t=0){let r=this.pad(t),i=re.toUint8Array(e),n=[];for(let e=0;e<i.length;){let t=[];for(let r=0;r<16&&e<i.length;r++){8===r&&t.push("");let n=i[e++].toString(16).padStart(2,"0");t.push(n)}n.push(`${r}${t.join(" ")}`)}return n}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}ci.oidSerializer=cr,ci.algorithmSerializer=class{static toTextObject(e){let t=new ct("Algorithm Identifier",{},cr.toString(e.algorithm));if(e.parameters)if(e.algorithm===sV){let r=new l7().toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters}else t.Parameters=e.parameters;return t}};class cn{get rawData(){return no(this,ti,"f")||ns(this,ti,ni.serialize(this.asn),"f"),no(this,ti,"f")}constructor(...e){ti.set(this,void 0),re.isBufferSource(e[0])?(this.asn=ni.parse(e[0],e[1]),ns(this,ti,re.toArrayBuffer(e[0]),"f")):this.asn=e[0],this.onInit(this.asn)}equal(e){return e instanceof cn&&rl(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return ni.toString(this.rawData);case"text":return ci.serialize(this.toTextObject());case"hex":return ra.ToHex(this.rawData);case"base64":return ra.ToBase64(this.rawData);case"base64url":return ra.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){let e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new ct(this.getTextName(),{},e)}}ti=new WeakMap,cn.NAME="ASN";class co extends cn{constructor(...e){super(re.isBufferSource(e[0])?re.toArrayBuffer(e[0]):ni.serialize(new oC({extnID:e[0],critical:e[1],extnValue:new iM(re.toArrayBuffer(e[2]))})),oC)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[ct.NAME]===co.NAME&&(e[ct.NAME]=cr.toString(this.type)),e}}class cs{static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}constructor(){this.items=new Map,this[tn]="CryptoProvider","u">typeof self&&"u">typeof crypto?this.set(cs.DEFAULT,crypto):e.g.crypto&&e.g.crypto.subtle&&this.set(cs.DEFAULT,e.g.crypto)}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=cs.DEFAULT){let t=this.items.get(e.toLowerCase());if(!t)throw Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(cs.DEFAULT,e);return this}}tn=Symbol.toStringTag,cs.DEFAULT="default";let ca=new cs,cl=/^[0-2](?:\.[1-9][0-9]*)+$/;class cc{constructor(e={}){for(const t in this.items={},e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return new RegExp(cl).test(e)?e:this.get(e)}register(e,t){this.items[e]=t,this.items[t]=e}}let cu=new cc;function cp(e,t){return`\\${ra.ToHex(ra.FromUtf8String(t)).toUpperCase()}`}cu.register("CN","2.5.4.3"),cu.register("L","2.5.4.7"),cu.register("ST","2.5.4.8"),cu.register("O","2.5.4.10"),cu.register("OU","2.5.4.11"),cu.register("C","2.5.4.6"),cu.register("DC","0.9.2342.19200300.100.1.25"),cu.register("E","1.2.840.113549.1.9.1"),cu.register("G","2.5.4.42"),cu.register("I","2.5.4.43"),cu.register("SN","2.5.4.4"),cu.register("T","2.5.4.12");class ch{static isASCII(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!1;return!0}static isPrintableString(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/g.test(e)}constructor(e,t={}){for(const e in this.extraNames=new cc,this.asn=new nf,t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof nf?this.asn=e:re.isBufferSource(e)?this.asn=ni.parse(e,nf):this.asn=this.fromJSON(e)}getField(e){let t=this.extraNames.findId(e)||cu.findId(e),r=[];for(let e of this.asn)for(let i of e)i.type===t&&r.push(i.value.toString());return r}getName(e){return this.extraNames.get(e)||cu.get(e)}toString(){return this.asn.map(e=>e.map(e=>{let t=this.getName(e.type)||e.type,r=e.value.anyValue?`#${ra.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,cp);return`${t}=${r}`}).join("+")).join(", ")}toJSON(){let e=[];for(let t of this.asn){let r={};for(let e of t){let t=this.getName(e.type)||e.type;null!=r[t]||(r[t]=[]),r[t].push(e.value.anyValue?`#${ra.ToHex(e.value.anyValue)}`:e.value.toString())}e.push(r)}return e}fromString(e){let t=new nf,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+"\\](?=[,+]|$))|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g,i=null,n=",";for(;i=r.exec(`${e},`);){let[,e,r]=i,o=r[r.length-1];(","===o||"+"===o)&&(r=r.slice(0,r.length-1),i[3]=o);let s=i[3];e=this.getTypeOid(e);let a=this.createAttribute(e,r);"+"===n?t[t.length-1].push(a):t.push(new np([a])),n=s}return t}fromJSON(e){let t=new nf;for(let r of e){let e=new np;for(let t in r){let i=this.getTypeOid(t);for(let n of r[t]){let t=this.createAttribute(i,n);e.push(t)}}t.push(e)}return t}getTypeOid(e){if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw Error(`Cannot get OID for name type '${e}'`);return e}createAttribute(e,t){let r=new nu({type:e});if("object"==typeof t)for(let e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else if("#"===t[0])r.value.anyValue=ra.FromHex(t.slice(1));else{let i=this.processStringValue(t);e===this.getName("E")||e===this.getName("DC")?r.value.ia5String=i:ch.isPrintableString(i)?r.value.printableString=i:r.value.utf8String=i}return r}processStringValue(e){let t=/"(.*?[^\\])?"/.exec(e);return t&&(e=t[1]),e.replace(/\\0a/ig,"\n").replace(/\\0d/ig,"\r").replace(/\\0g/ig,"	").replace(/\\(.)/g,"$1")}toArrayBuffer(){return ni.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||ca.get():(i=e[0]||i,r=e[1]||ca.get()),await r.subtle.digest(i,this.toArrayBuffer())}}let cf="Cannot initialize GeneralName from ASN.1 data.",cd=`${cf} Unsupported string format in use.`,cy=`${cf} Value doesn't match to GUID regular expression.`,cg=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,cv="1.3.6.1.4.1.311.25.1",cm="1.3.6.1.4.1.311.20.2.3",cw="email",cA="guid";class cb extends cn{constructor(...e){let t;if(2===e.length)switch(e[0]){case"dn":{const r=new ch(e[1]).toArrayBuffer(),i=ni.parse(r,nf);t=new ng({directoryName:i});break}case"dns":t=new ng({dNSName:e[1]});break;case cw:t=new ng({rfc822Name:e[1]});break;case cA:{const r=RegExp(cg,"i").exec(e[1]);if(!r)throw Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=r.slice(1).map((e,t)=>t<3?ra.ToHex(new Uint8Array(ra.FromHex(e)).reverse()):e).join("");t=new ng({otherName:new nd({typeId:cv,value:ni.serialize(new iM(ra.FromHex(i)))})});break}case"ip":t=new ng({iPAddress:e[1]});break;case"id":t=new ng({registeredID:e[1]});break;case"upn":t=new ng({otherName:new nd({typeId:cm,value:ni.serialize(iF.toASN(e[1]))})});break;case"url":t=new ng({uniformResourceIdentifier:e[1]});break;default:throw Error("Cannot create GeneralName. Unsupported type of the name")}else t=re.isBufferSource(e[0])?ni.parse(e[0],ng):e[0];super(t)}onInit(e){if(void 0!=e.dNSName)this.type="dns",this.value=e.dNSName;else if(void 0!=e.rfc822Name)this.type=cw,this.value=e.rfc822Name;else if(void 0!=e.iPAddress)this.type="ip",this.value=e.iPAddress;else if(void 0!=e.uniformResourceIdentifier)this.type="url",this.value=e.uniformResourceIdentifier;else if(void 0!=e.registeredID)this.type="id",this.value=e.registeredID;else if(void 0!=e.directoryName)this.type="dn",this.value=new ch(e.directoryName).toString();else if(void 0!=e.otherName)if(e.otherName.typeId===cv){this.type=cA;let t=ni.parse(e.otherName.value,iM),r=RegExp(cg,"i").exec(ra.ToHex(t));if(!r)throw Error(cy);this.value=r.slice(1).map((e,t)=>t<3?ra.ToHex(new Uint8Array(ra.FromHex(e)).reverse()):e).join("-")}else if(e.otherName.typeId===cm)this.type="upn",this.value=ni.parse(e.otherName.value,nl).toString();else throw Error(cd);else throw Error(cd)}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case"dn":case"dns":case cA:case"ip":case"id":case"upn":case"url":e=this.type.toUpperCase();break;case cw:e="Email";break;default:throw Error("Unsupported GeneralName type")}let t=this.value;return"id"===this.type&&(t=cr.toString(t)),new ct(e,void 0,t)}}class cS extends cn{constructor(e){let t;if(e instanceof nP)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof ng)r.push(t);else{const e=ni.parse(new cb(t.type,t.value).rawData,ng);r.push(e)}t=new nP(r)}else if(re.isBufferSource(e))t=ni.parse(e,nP);else throw Error("Cannot initialize GeneralNames. Incorrect incoming arguments");super(t)}onInit(e){let t=[];for(let r of e){let e=null;try{e=new cb(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map(e=>e.toJSON())}toTextObject(){let e=super.toTextObjectEmpty();for(let t of this.items){let r=t.toTextObject(),i=e[r[ct.NAME]];Array.isArray(i)||(i=[],e[r[ct.NAME]]=i),i.push(r)}return e}}cS.NAME="GeneralNames";let cE="-{5}",cB=`[^\\n]+`,cx=`${cE}BEGIN (${cB}(?=${cE}))${cE}`,cC=`${cE}END \\1${cE}`,ck=`[^:\\n]+`,cI=`(?:[^\\n]+\\n(?: +[^\\n]+\\n)*)`,cT=`(?:[a-zA-Z0-9=+/]+\\n)+`,cO=`${cx}\\n(?:((?:${ck}: ${cI})+))?\\n?(${cT})${cC}`;class cN{static isPem(e){return"string"==typeof e&&RegExp(cO,"g").test(e.replace(/\r/g,""))}static decodeWithHeaders(e){e=e.replace(/\r/g,"");let t=RegExp(cO,"g"),r=[],i=null;for(;i=t.exec(e);){let e=i[3].replace(RegExp(`[\\n]+`,"g"),""),t={type:i[1],headers:[],rawData:ra.FromBase64(e)},n=i[2];if(n){let e=n.split(RegExp("\\n","g")),r=null;for(let i of e){let[e,n]=i.split(/:(.*)/);if(void 0===n){if(!r)throw Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:n.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map(e=>e.rawData)}static decodeFirst(e){let t=this.decode(e);if(!t.length)throw RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){let r=[];return t?e.forEach(e=>{if(!re.isBufferSource(e))throw TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:re.toArrayBuffer(e)}))}):e.forEach(e=>{if(!("type"in e))throw TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))}),r.join("\n")}if(!t)throw Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:re.toArrayBuffer(e)})}static encodeStruct(e){var t;let r,i=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${i}-----`),null==(t=e.headers)?void 0:t.length){for(let t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}let o=ra.ToBase64(e.rawData),s=0,a=[];for(;s<o.length;)if(o.length-s<64?r=o.substring(s):(r=o.substring(s,s+64),s+=64),0!==r.length){if(a.push(r),r.length<64)break}else break;return n.push(...a),n.push(`-----END ${i}-----`),n.join("\n")}}cN.CertificateTag="CERTIFICATE",cN.CrlTag="CRL",cN.CertificateRequestTag="CERTIFICATE REQUEST",cN.PublicKeyTag="PUBLIC KEY",cN.PrivateKeyTag="PRIVATE KEY";class cM extends cn{static isAsnEncoded(e){return re.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e)if(cN.isPem(e))return cN.decode(e)[0];else if(ra.isHex(e))return ra.FromHex(e);else if(ra.isBase64(e))return ra.FromBase64(e);else if(ra.isBase64Url(e))return ra.FromBase64Url(e);else throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url");{let t=re.toUint8Array(e);if(t.length>0&&48===t[0])return re.toArrayBuffer(e);let r=ra.ToBinary(e);if(cN.isPem(r))return cN.decode(r)[0];if(ra.isHex(r))return ra.FromHex(r);if(ra.isBase64(r))return ra.FromBase64(r);else if(ra.isBase64Url(r))return ra.FromBase64Url(r);throw TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}}constructor(...e){cM.isAsnEncoded(e[0])?super(cM.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?cN.encode(this.rawData,this.tag):super.toString(e)}}class cU extends cM{static async create(e,t=ca.get()){if(e instanceof cU)return e;if(cs.isCryptoKey(e)){if("public"!==e.type)throw TypeError("Public key is required");return new cU(await t.subtle.exportKey("spki",e))}if(e.publicKey)return e.publicKey;if(re.isBufferSource(e))return new cU(e);throw TypeError("Unsupported PublicKeyType")}constructor(e){cM.isAsnEncoded(e)?super(e,oE):super(e),this.tag=cN.PublicKeyTag}async export(...e){var t;let r,i=["verify"],n={hash:"SHA-256",...this.algorithm};e.length>1?(n=e[0]||n,i=e[1]||i,r=e[2]||ca.get()):r=e[0]||ca.get();let o=this.rawData,s=ni.parse(this.rawData,oE);return s.algorithm.algorithm===s9&&(t=s,t.algorithm=new oS({algorithm:s3,parameters:null}),o=ni.serialize(t)),r.subtle.importKey("spki",o,n,!0,i)}onInit(e){let t=aW.resolve(lN),r=this.algorithm=t.toWebAlgorithm(e.algorithm);if(e.algorithm.algorithm===s3){let t=ni.parse(e.subjectPublicKey,ax),i=re.toUint8Array(t.modulus);r.publicExponent=re.toUint8Array(t.publicExponent),r.modulusLength=(!i[0]?i.slice(1):i).byteLength<<3}}async getThumbprint(...e){var t;let r,i="SHA-1";return!(e.length>=1)||(null==(t=e[0])?void 0:t.subtle)?r=e[0]||ca.get():(i=e[0]||i,r=e[1]||ca.get()),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(...e){let t,r="SHA-1";1===e.length?"string"==typeof e[0]?(r=e[0],t=ca.get()):t=e[0]:2===e.length?(r=e[0],t=e[1]):t=ca.get();let i=ni.parse(this.rawData,oE);return await t.subtle.digest(r,i.subjectPublicKey)}toTextObject(){let e=this.toTextObjectEmpty(),t=ni.parse(this.rawData,oE);return e.Algorithm=ci.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===sV?e["EC Point"]=t.subjectPublicKey:e["Raw Data"]=t.subjectPublicKey,e}}class cP extends co{static async create(e,t=!1,r=ca.get()){if("name"in e&&"serialNumber"in e)return new cP(e,t);let i=await cU.create(e,r),n=await i.getKeyIdentifier(r);return new cP(ra.ToHex(n),t)}constructor(...e){if(re.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new nN({keyIdentifier:new nO(ra.FromHex(e[0]))});super(nT,e[1],ni.serialize(t))}else{const t=e[0],r=new nN({authorityCertIssuer:t.name instanceof cS?ni.parse(t.name.rawData,nP):t.name,authorityCertSerialNumber:ra.FromHex(t.serialNumber)});super(nT,e[1],ni.serialize(r))}}onInit(e){super.onInit(e);let t=ni.parse(e.extnValue,nN);t.keyIdentifier&&(this.keyId=ra.ToHex(t.keyIdentifier)),(t.authorityCertIssuer||t.authorityCertSerialNumber)&&(this.certId={name:t.authorityCertIssuer||[],serialNumber:t.authorityCertSerialNumber?ra.ToHex(t.authorityCertSerialNumber):""})}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ni.parse(this.value,nN);return t.authorityCertIssuer&&(e["Authority Issuer"]=new cS(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}cP.NAME="Authority Key Identifier";class cD extends co{constructor(...e){if(re.isBufferSource(e[0])){super(e[0]);const t=ni.parse(this.value,nU);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new nU({cA:e[0],pathLenConstraint:e[1]});super(nM,e[2],ni.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}cD.NAME="Basic Constraints",(Z=to||(to={})).serverAuth="1.3.6.1.5.5.7.3.1",Z.clientAuth="1.3.6.1.5.5.7.3.2",Z.codeSigning="1.3.6.1.5.5.7.3.3",Z.emailProtection="1.3.6.1.5.5.7.3.4",Z.timeStamping="1.3.6.1.5.5.7.3.8",Z.ocspSigning="1.3.6.1.5.5.7.3.9";class cR extends co{constructor(...e){if(re.isBufferSource(e[0])){super(e[0]);const t=ni.parse(this.value,n2);this.usages=t.map(e=>e)}else{const t=new n2(e[0]);super(n1,e[1],ni.serialize(t)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[""]=this.usages.map(e=>cr.toString(e)).join(", "),e}}cR.NAME="Extended Key Usages",(ee=ts||(ts={}))[ee.digitalSignature=1]="digitalSignature",ee[ee.nonRepudiation=2]="nonRepudiation",ee[ee.keyEncipherment=4]="keyEncipherment",ee[ee.dataEncipherment=8]="dataEncipherment",ee[ee.keyAgreement=16]="keyAgreement",ee[ee.keyCertSign=32]="keyCertSign",ee[ee.cRLSign=64]="cRLSign",ee[ee.encipherOnly=128]="encipherOnly",ee[ee.decipherOnly=256]="decipherOnly";class cj extends co{constructor(...e){if(re.isBufferSource(e[0])){super(e[0]);const t=ni.parse(this.value,oo);this.usages=t.toNumber()}else{const t=new oo(e[0]);super(on,e[1],ni.serialize(t)),this.usages=e[0]}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ni.parse(this.value,oo);return e[""]=t.toJSON().join(", "),e}}cj.NAME="Key Usages";class cL extends co{static async create(e,t=!1,r=ca.get()){let i=await cU.create(e,r),n=await i.getKeyIdentifier(r);return new cL(ra.ToHex(n),t)}constructor(...e){if(re.isBufferSource(e[0])){super(e[0]);const t=ni.parse(this.value,ov);this.keyId=ra.ToHex(t)}else{const t="string"==typeof e[0]?ra.FromHex(e[0]):e[0],r=new ov(t);super(og,e[1],ni.serialize(r)),this.keyId=ra.ToHex(t)}}toTextObject(){let e=this.toTextObjectWithoutValue(),t=ni.parse(this.value,ov);return e[""]=t,e}}cL.NAME="Subject Key Identifier";class cV extends co{constructor(...e){re.isBufferSource(e[0])?super(e[0]):super(oh,e[1],new cS(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=ni.parse(e.extnValue,of);this.names=new cS(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}cV.NAME="Subject Alternative Name";class cH{static register(e,t){this.items.set(e,t)}static create(e){let t=new co(e),r=this.items.get(t.type);return r?new r(e):t}}cH.items=new Map;class c_ extends co{constructor(...e){var t;if(re.isBufferSource(e[0])){super(e[0]);const t=ni.parse(this.value,nG);this.policies=t.map(e=>e.policyIdentifier)}else{const r=e[0],i=null!=(t=e[1])&&t,n=new nG(r.map(e=>new nF({policyIdentifier:e})));super(nR,i,ni.serialize(n)),this.policies=r}}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map(e=>new ct("",{},cr.toString(e))),e}}c_.NAME="Certificate Policies",cH.register(nR,c_);class cF extends co{constructor(...e){if(re.isBufferSource(e[0]))super(e[0]);else if(Array.isArray(e[0])&&"string"==typeof e[0][0]){const t=e[0].map(e=>new nQ({distributionPoint:new nz({fullName:[new ng({uniformResourceIdentifier:e})]})})),r=new nJ(t);super(nW,e[1],ni.serialize(r))}else{const t=new nJ(e[0]);super(nW,e[1],ni.serialize(t))}null!=this.distributionPoints||(this.distributionPoints=[])}onInit(e){super.onInit(e);let t=ni.parse(e.extnValue,nJ);this.distributionPoints=t}toTextObject(){let e=this.toTextObjectWithoutValue();return e["Distribution Point"]=this.distributionPoints.map(e=>{var t;let r={};return e.distributionPoint&&(r[""]=null==(t=e.distributionPoint.fullName)?void 0:t.map(e=>new cb(e).toString()).join(", ")),e.reasons&&(r.Reasons=e.reasons.toString()),e.cRLIssuer&&(r["CRL Issuer"]=e.cRLIssuer.map(e=>e.toString()).join(", ")),r}),e}}cF.NAME="CRL Distribution Points";class cG extends co{constructor(...e){if(re.isBufferSource(e[0]))super(e[0]);else if(e[0]instanceof nI){const t=new nI(e[0]);super(nC,e[1],ni.serialize(t))}else{const t=e[0],r=new nI;c$(r,t,nb,"ocsp"),c$(r,t,nS,"caIssuers"),c$(r,t,nE,"timeStamping"),c$(r,t,nB,"caRepository"),super(nC,e[1],ni.serialize(r))}null!=this.ocsp||(this.ocsp=[]),null!=this.caIssuers||(this.caIssuers=[]),null!=this.timeStamping||(this.timeStamping=[]),null!=this.caRepository||(this.caRepository=[])}onInit(e){super.onInit(e),this.ocsp=[],this.caIssuers=[],this.timeStamping=[],this.caRepository=[],ni.parse(e.extnValue,nI).forEach(e=>{switch(e.accessMethod){case nb:this.ocsp.push(new cb(e.accessLocation));break;case nS:this.caIssuers.push(new cb(e.accessLocation));break;case nE:this.timeStamping.push(new cb(e.accessLocation));break;case nB:this.caRepository.push(new cb(e.accessLocation))}})}toTextObject(){let e=this.toTextObjectWithoutValue();return this.ocsp.length&&cK(e,"OCSP",this.ocsp),this.caIssuers.length&&cK(e,"CA Issuers",this.caIssuers),this.timeStamping.length&&cK(e,"Time Stamping",this.timeStamping),this.caRepository.length&&cK(e,"CA Repository",this.caRepository),e}}function cK(e,t,r){if(1===r.length)e[t]=r[0].toTextObject();else{let i=new ct("");r.forEach((e,t)=>{let r=e.toTextObject(),n=`${r[ct.NAME]} ${t+1}`,o=i[n];Array.isArray(o)||(o=[],i[n]=o),o.push(r)}),e[t]=i}}function c$(e,t,r,i){let n=t[i];n&&(Array.isArray(n)?n:[n]).forEach(t=>{"string"==typeof t&&(t=new cb("url",t)),e.push(new nk({accessMethod:r,accessLocation:ni.parse(t.rawData,ng)}))})}cG.NAME="Authority Info Access";class cW extends co{constructor(...e){re.isBufferSource(e[0])?super(e[0]):super(or,e[1],new cS(e[0]||[]).rawData)}onInit(e){super.onInit(e);let t=ni.parse(e.extnValue,nP);this.names=new cS(t)}toTextObject(){let e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(let r in t)e[r]=t[r];return e}}cW.NAME="Issuer Alternative Name";class cq extends cn{constructor(...e){let t;if(re.isBufferSource(e[0]))t=re.toArrayBuffer(e[0]);else{const r=e[0],i=Array.isArray(e[1])?e[1].map(e=>re.toArrayBuffer(e)):[];t=ni.serialize(new od({type:r,values:i}))}super(t,od)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){let e=this.toTextObjectWithoutValue();return e.Value=this.values.map(e=>new ct("",{"":e})),e}toTextObjectWithoutValue(){let e=this.toTextObjectEmpty();return e[ct.NAME]===cq.NAME&&(e[ct.NAME]=cr.toString(this.type)),e}}cq.NAME="Attribute";class cz extends cq{constructor(...e){if(re.isBufferSource(e[0]))super(e[0]);else{const t=new lb({printableString:e[0]});super(lr,[ni.serialize(t)])}null!=this.password||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){let e=ni.parse(this.values[0],lb);this.password=e.toString()}}toTextObject(){let e=this.toTextObjectWithoutValue();return e[ct.VALUE]=this.password,e}}cz.NAME="Challenge Password";class cQ extends cq{constructor(...e){if(re.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new ok;for(const e of t)r.push(ni.parse(e.rawData,oC));super(li,[ni.serialize(r)])}null!=this.items||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){let e=ni.parse(this.values[0],ok);this.items=e.map(e=>cH.create(ni.serialize(e)))}}toTextObject(){let e=this.toTextObjectWithoutValue();for(let t of this.items.map(e=>e.toTextObject()))e[t[ct.NAME]]=t;return e}}cQ.NAME="Extensions";class cJ{static register(e,t){this.items.set(e,t)}static create(e){let t=new cq(e),r=this.items.get(t.type);return r?new r(e):t}}cJ.items=new Map;let cY="crypto.signatureFormatter",cX=ta=class{static createPssParams(e,t){let r=ta.getHashAlgorithm(e);return r?new aA({hashAlgorithm:r,maskGenAlgorithm:new oS({algorithm:ad,parameters:ni.serialize(r)}),saltLength:t}):null}static getHashAlgorithm(e){let t=aW.resolve(lN);return"string"==typeof e?t.toAsnAlgorithm({name:e}):"object"==typeof e&&e&&"name"in e?t.toAsnAlgorithm(e):null}toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"rsassa-pkcs1-v1_5":if(!("hash"in e))return new oS({algorithm:s3,parameters:null});{let t;if("string"==typeof e.hash)t=e.hash;else if(e.hash&&"object"==typeof e.hash&&"name"in e.hash&&"string"==typeof e.hash.name)t=e.hash.name.toUpperCase();else throw Error("Cannot get hash algorithm name");switch(t.toLowerCase()){case"sha-1":return new oS({algorithm:ar,parameters:null});case"sha-256":return new oS({algorithm:an,parameters:null});case"sha-384":return new oS({algorithm:ao,parameters:null});case"sha-512":return new oS({algorithm:as,parameters:null})}}break;case"rsa-pss":if(!("hash"in e))return new oS({algorithm:s9,parameters:null});{if(!("saltLength"in e&&"number"==typeof e.saltLength))throw Error("Cannot get 'saltLength' from 'alg' argument");let t=ta.createPssParams(e.hash,e.saltLength);if(!t)throw Error("Cannot create PSS parameters");return new oS({algorithm:s9,parameters:ni.serialize(t)})}}return null}toWebAlgorithm(e){switch(e.algorithm){case s3:return{name:"RSASSA-PKCS1-v1_5"};case ar:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case an:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case ao:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case as:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case s9:if(!e.parameters)return{name:"RSA-PSS"};{let t=ni.parse(e.parameters,aA);return{name:"RSA-PSS",hash:aW.resolve(lN).toWebAlgorithm(t.hashAlgorithm),saltLength:t.saltLength}}}return null}};cX=ta=nn([aq()],cX),aW.registerSingleton(lO,cX);let cZ=class{toAsnAlgorithm(e){switch(e.name.toLowerCase()){case"sha-1":return new oS({algorithm:ac});case"sha-256":return new oS({algorithm:ap});case"sha-384":return new oS({algorithm:ah});case"sha-512":return new oS({algorithm:af})}return null}toWebAlgorithm(e){switch(e.algorithm){case ac:return{name:"SHA-1"};case ap:return{name:"SHA-256"};case ah:return{name:"SHA-384"};case af:return{name:"SHA-512"}}return null}};cZ=nn([aq()],cZ),aW.registerSingleton(lO,cZ);class c0{addPadding(e,t){let r=re.toUint8Array(t),i=new Uint8Array(e);return i.set(r,e-r.length),i.buffer}removePadding(e,t=!1){let r=re.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){let e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){let r=e.namedCurve,i=c0.namedCurveSize.get(r)||c0.defaultNamedCurveSize,n=new s8,o=re.toUint8Array(t);return n.r=this.removePadding(o.slice(0,i),!0),n.s=this.removePadding(o.slice(i,i+i),!0),ni.serialize(n)}return null}toWebSignature(e,t){if("ECDSA"===e.name){let r=ni.parse(t,s8),i=e.namedCurve,n=c0.namedCurveSize.get(i)||c0.defaultNamedCurveSize;return function(...e){let t=new Uint8Array(e.map(e=>e.byteLength).reduce((e,t)=>e+t)),r=0;return e.map(e=>new Uint8Array(e)).forEach(e=>{for(let i of e)t[r++]=i}),t.buffer}(this.addPadding(n,this.removePadding(r.r)),this.addPadding(n,this.removePadding(r.s)))}return null}}c0.namedCurveSize=new Map,c0.defaultNamedCurveSize=32;let c1="1.3.101.110",c2="1.3.101.111",c4="1.3.101.112",c8="1.3.101.113",c5=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"ed25519":t=c4;break;case"x25519":t=c1;break;case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=c4;break;case"ed448":t=c8}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=c1;break;case"x448":t=c2}}return t?new oS({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case c4:return{name:"Ed25519"};case c8:return{name:"EdDSA",namedCurve:"Ed448"};case c1:return{name:"X25519"};case c2:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};c5=nn([aq()],c5),aW.registerSingleton(lO,c5),new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;class c3 extends cM{get publicKey(){return no(this,tw,"f")||ns(this,tw,new cU(this.asn.tbsCertificate.subjectPublicKeyInfo),"f"),no(this,tw,"f")}get serialNumber(){if(!no(this,tc,"f")){let e=new Uint8Array(this.asn.tbsCertificate.serialNumber);e.length>1&&0===e[0]&&e[1]>127&&(e=e.slice(1)),ns(this,tc,ra.ToHex(e),"f")}return no(this,tc,"f")}get subjectName(){return no(this,tu,"f")||ns(this,tu,new ch(this.asn.tbsCertificate.subject),"f"),no(this,tu,"f")}get subject(){return no(this,tp,"f")||ns(this,tp,this.subjectName.toString(),"f"),no(this,tp,"f")}get issuerName(){return no(this,th,"f")||ns(this,th,new ch(this.asn.tbsCertificate.issuer),"f"),no(this,th,"f")}get issuer(){return no(this,tf,"f")||ns(this,tf,this.issuerName.toString(),"f"),no(this,tf,"f")}get notBefore(){if(!no(this,td,"f")){let e=this.asn.tbsCertificate.validity.notBefore.utcTime||this.asn.tbsCertificate.validity.notBefore.generalTime;if(!e)throw Error("Cannot get 'notBefore' value");ns(this,td,e,"f")}return no(this,td,"f")}get notAfter(){if(!no(this,ty,"f")){let e=this.asn.tbsCertificate.validity.notAfter.utcTime||this.asn.tbsCertificate.validity.notAfter.generalTime;if(!e)throw Error("Cannot get 'notAfter' value");ns(this,ty,e,"f")}return no(this,ty,"f")}get signatureAlgorithm(){if(!no(this,tg,"f")){let e=aW.resolve(lN);ns(this,tg,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return no(this,tg,"f")}get signature(){return no(this,tv,"f")||ns(this,tv,this.asn.signatureValue,"f"),no(this,tv,"f")}get extensions(){return!no(this,tm,"f")&&(ns(this,tm,[],"f"),this.asn.tbsCertificate.extensions&&ns(this,tm,this.asn.tbsCertificate.extensions.map(e=>cH.create(ni.serialize(e))),"f")),no(this,tm,"f")}get tbs(){return no(this,tl,"f")||ns(this,tl,this.asn.tbsCertificateRaw||ni.serialize(this.asn.tbsCertificate),"f"),no(this,tl,"f")}constructor(e){const t=cM.isAsnEncoded(e)?[e,oT]:[e];super(t[0],t[1]),tl.set(this,void 0),tc.set(this,void 0),tu.set(this,void 0),tp.set(this,void 0),th.set(this,void 0),tf.set(this,void 0),td.set(this,void 0),ty.set(this,void 0),tg.set(this,void 0),tv.set(this,void 0),tm.set(this,void 0),tw.set(this,void 0),this.tag=cN.CertificateTag}onInit(e){}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e={},t=ca.get()){let r,i,n=e.publicKey;try{if(n)if("publicKey"in n)r={...n.publicKey.algorithm,...this.signatureAlgorithm},i=await n.publicKey.export(r,["verify"],t);else if(n instanceof cU)r={...n.algorithm,...this.signatureAlgorithm},i=await n.export(r,["verify"],t);else if(re.isBufferSource(n)){let e=new cU(n);r={...e.algorithm,...this.signatureAlgorithm},i=await e.export(r,["verify"],t)}else r={...n.algorithm,...this.signatureAlgorithm},i=n;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t)}catch{return!1}let o=aW.resolveAll(cY).reverse(),s=null;for(let e of o)if(s=e.toWebSignature(r,this.signature))break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");let a=await t.subtle.verify(this.signatureAlgorithm,i,s,this.tbs);if(e.signatureOnly)return a;{let t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=ca.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=ca.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){let e=this.toTextObjectEmpty(),t=ni.parse(this.rawData,oT),r=t.tbsCertificate,i=new ct("",{Version:`${eV[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":ci.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new ct("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(i["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(i["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){let e=new ct("");for(let t of this.extensions){let r=t.toTextObject();e[r[ct.NAME]]=r}i.Extensions=e}return e.Data=i,e.Signature=new ct("",{Algorithm:ci.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}function c6(e,t=ca.get()){let r=re.toUint8Array(ra.FromHex(e||"")),i=r&&r.length&&r.some(e=>e>0)?new Uint8Array(r):void 0;i||(i=t.getRandomValues(new Uint8Array(16)));let n=0;for(;n<i.length-1&&0===i[n];)n++;if((i=i.slice(n))[0]>127){let e=new Uint8Array(i.length+1);e[0]=0,e.set(i,1),i=e}return i.buffer}tl=new WeakMap,tc=new WeakMap,tu=new WeakMap,tp=new WeakMap,th=new WeakMap,tf=new WeakMap,td=new WeakMap,ty=new WeakMap,tg=new WeakMap,tv=new WeakMap,tm=new WeakMap,tw=new WeakMap,c3.NAME="Certificate",(et=tx||(tx={}))[et.unspecified=0]="unspecified",et[et.keyCompromise=1]="keyCompromise",et[et.cACompromise=2]="cACompromise",et[et.affiliationChanged=3]="affiliationChanged",et[et.superseded=4]="superseded",et[et.cessationOfOperation=5]="cessationOfOperation",et[et.certificateHold=6]="certificateHold",et[et.removeFromCRL=8]="removeFromCRL",et[et.privilegeWithdrawn=9]="privilegeWithdrawn",et[et.aACompromise=10]="aACompromise";class c7 extends cn{get serialNumber(){return no(this,tA,"f")||ns(this,tA,ra.ToHex(this.asn.userCertificate),"f"),no(this,tA,"f")}get revocationDate(){return no(this,tb,"f")||ns(this,tb,this.asn.revocationDate.getTime(),"f"),no(this,tb,"f")}get reason(){return void 0===no(this,tS,"f")&&this.extensions,no(this,tS,"f")}get invalidity(){return void 0===no(this,tE,"f")&&this.extensions,no(this,tE,"f")}get extensions(){return!no(this,tB,"f")&&(ns(this,tB,[],"f"),this.asn.crlEntryExtensions&&ns(this,tB,this.asn.crlEntryExtensions.map(e=>{let t=cH.create(ni.serialize(e));switch(t.type){case nZ:void 0===no(this,tS,"f")&&ns(this,tS,ni.parse(t.value,n0).reason,"f");break;case oe:void 0===no(this,tE,"f")&&ns(this,tE,ni.parse(t.value,ot).value,"f")}return t}),"f")),no(this,tB,"f")}constructor(...e){let t;if(re.isBufferSource(e[0])?t=re.toArrayBuffer(e[0]):"string"==typeof e[0]?t=ni.serialize(new oO({userCertificate:c6(e[0]),revocationDate:new oB(e[1]),crlEntryExtensions:e[2]})):e[0]instanceof oO&&(t=e[0]),!t)throw TypeError("Cannot create X509CrlEntry instance. Wrong constructor arguments.");super(t,oO),tA.set(this,void 0),tb.set(this,void 0),tS.set(this,void 0),tE.set(this,void 0),tB.set(this,void 0)}onInit(e){}}tA=new WeakMap,tb=new WeakMap,tS=new WeakMap,tE=new WeakMap,tB=new WeakMap;class c9 extends cM{get version(){return this.asn.tbsCertList.version}get signatureAlgorithm(){if(!no(this,tk,"f")){let e=aW.resolve(lN);ns(this,tk,e.toWebAlgorithm(this.asn.signatureAlgorithm),"f")}return no(this,tk,"f")}get signature(){return this.asn.signature}get issuer(){return this.issuerName.toString()}get issuerName(){return no(this,tI,"f")||ns(this,tI,new ch(this.asn.tbsCertList.issuer),"f"),no(this,tI,"f")}get thisUpdate(){if(!no(this,tT,"f")){let e=this.asn.tbsCertList.thisUpdate.getTime();if(!e)throw Error("Cannot get 'thisUpdate' value");ns(this,tT,e,"f")}return no(this,tT,"f")}get nextUpdate(){var e;return void 0===no(this,tO,"f")&&ns(this,tO,(null==(e=this.asn.tbsCertList.nextUpdate)?void 0:e.getTime())||void 0,"f"),no(this,tO,"f")}get entries(){var e;return no(this,tN,"f")||ns(this,tN,(null==(e=this.asn.tbsCertList.revokedCertificates)?void 0:e.map(e=>new c7(e)))||[],"f"),no(this,tN,"f")}get extensions(){return!no(this,tM,"f")&&(ns(this,tM,[],"f"),this.asn.tbsCertList.crlExtensions&&ns(this,tM,this.asn.tbsCertList.crlExtensions.map(e=>cH.create(ni.serialize(e))),"f")),no(this,tM,"f")}get tbs(){return no(this,tC,"f")||ns(this,tC,this.asn.tbsCertListRaw||ni.serialize(this.asn.tbsCertList),"f"),no(this,tC,"f")}get tbsCertListSignatureAlgorithm(){return this.asn.tbsCertList.signature}get certListSignatureAlgorithm(){return this.asn.signatureAlgorithm}constructor(e){super(e,cM.isAsnEncoded(e)?oM:void 0),this.tag=cN.CrlTag,tC.set(this,void 0),tk.set(this,void 0),tI.set(this,void 0),tT.set(this,void 0),tO.set(this,void 0),tN.set(this,void 0),tM.set(this,void 0)}onInit(e){}getExtension(e){for(let t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter(t=>"string"==typeof e?t.type===e:t instanceof e)}async verify(e,t=ca.get()){let r,i;if(!this.certListSignatureAlgorithm.isEqual(this.tbsCertListSignatureAlgorithm))throw Error("algorithm identifier in the sequence tbsCertList and CertificateList mismatch");let n=e.publicKey;try{n instanceof c3?(r={...n.publicKey.algorithm,...n.signatureAlgorithm},i=await n.publicKey.export(r,["verify"])):n instanceof cU?(r={...n.algorithm,...this.signatureAlgorithm},i=await n.export(r,["verify"])):(r={...n.algorithm,...this.signatureAlgorithm},i=n)}catch{return!1}let o=aW.resolveAll(cY).reverse(),s=null;for(let e of o)if(s=e.toWebSignature(r,this.signature))break;if(!s)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return await t.subtle.verify(this.signatureAlgorithm,i,s,this.tbs)}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=ca.get()),await t.subtle.digest(r,this.rawData)}findRevoked(e){let t=c6("string"==typeof e?e:e.serialNumber);for(let e of this.asn.tbsCertList.revokedCertificates||[])if(re.isEqual(e.userCertificate,t))return new c7(ni.serialize(e));return null}}function ue(e){return ut.stubThis(e)}tC=new WeakMap,tk=new WeakMap,tI=new WeakMap,tT=new WeakMap,tO=new WeakMap,tN=new WeakMap,tM=new WeakMap,cH.register(nM,cD),cH.register(n1,cR),cH.register(on,cj),cH.register(og,cL),cH.register(nT,cP),cH.register(oh,cV),cH.register(nW,cF),cH.register(nC,cG),cH.register(or,cW),cJ.register(lr,cz),cJ.register(li,cQ),aW.registerSingleton(cY,class{toAsnSignature(e,t){return re.toArrayBuffer(t)}toWebSignature(e,t){return re.toArrayBuffer(t)}}),aW.registerSingleton(cY,c0),c0.namedCurveSize.set("P-256",32),c0.namedCurveSize.set("K-256",32),c0.namedCurveSize.set("P-384",48),c0.namedCurveSize.set("P-521",66);let ut={stubThis:e=>globalThis.fetch(e)},ur={};async function ui(e){let t,r,i,n,o,s,{extensions:a}=e;if(!a)return!1;if(a.forEach(e=>{e instanceof cP?t=e:e instanceof cL?r=e:e instanceof cF&&(i=e)}),t&&t.keyId?s=t.keyId:r&&(s=r.keyId),s){let t=ur[s];if(t){let r=new Date;if(!t.nextUpdate||t.nextUpdate>r)return t.revokedCerts.indexOf(e.serialNumber)>=0}}let l=i?.distributionPoints?.[0].distributionPoint?.fullName?.[0].uniformResourceIdentifier;if(!l)return!1;try{let e=await ue(l);n=await e.arrayBuffer()}catch(e){return!1}try{o=new c9(n)}catch(e){return!1}let c={revokedCerts:[],nextUpdate:void 0};o.nextUpdate&&(c.nextUpdate=o.nextUpdate);let u=o.entries;if(u){for(let e of u){let t=e.serialNumber;c.revokedCerts.push(t)}return s&&(ur[s]=c),c.revokedCerts.indexOf(e.serialNumber)>=0}return!1}var t0=t0,t0=t0,tY=tY;function un(e){let t,r,i,n,o;if(e.byteLength<37)throw Error(`Authenticator data was ${e.byteLength} bytes, expected at least 37 bytes`);let s=0,a=tY.toDataView(e),l=e.slice(s,s+=32),c=e.slice(s,s+=1),u=c[0],p={up:!!(1&u),uv:!!(4&u),be:!!(8&u),bs:!!(16&u),at:!!(64&u),ed:!!(128&u),flagsInt:u},h=e.slice(s,s+4),f=a.getUint32(s,!1);if(s+=4,p.at){t=e.slice(s,s+=16);let n=a.getUint16(s);s+=2,r=e.slice(s,s+=n);let o=tY.fromHex("a301634f4b500327206745643235353139"),l=e.slice(s,s+o.byteLength),c=!1;tY.areEqual(o,l)&&(c=!0,e[s]=164);let u=t0.decodeFirst(e.slice(s)),p=Uint8Array.from(t0.encode(u));c&&(e[s]=163),i=p,s+=p.byteLength}if(p.ed){let t=t0.decodeFirst(e.slice(s));n=function(e){let t;try{t=t0.decodeFirst(e)}catch(e){throw Error(`Error decoding authenticator extensions: ${e.message}`)}return function e(t){let r={};for(let[i,n]of t)n instanceof Map?r[i]=e(n):r[i]=n;return r}(t)}(o=Uint8Array.from(t0.encode(t))),s+=o.byteLength}if(e.byteLength>s)throw Error("Leftover bytes detected while parsing authenticator data");return uo.stubThis({rpIdHash:l,flagsBuf:c,flags:p,counter:f,counterBuf:h,aaguid:t,credentialID:r,credentialPublicKey:i,extensionsData:n,extensionsDataBuffer:o})}let uo={stubThis:e=>e};var t6=t6,tY=tY;function us(e,t=-7){return"string"==typeof e&&(e=tY.fromUTF8String(e)),t6.digest(e,t)}async function ua(e,t=[]){if(0===t.length)return!0;let r=await U(),i=e.map(e=>new c3(e));for(let t=0;t<i.length;t++){let r=i[t],n=e[t];try{await ul(r)}catch(e){throw Error(`Found revoked certificate in x5c:
${n}`)}try{uc(r.notBefore,r.notAfter)}catch(e){throw Error(`Found certificate out of validity period in x5c:
${n}`)}}let n=t.map(e=>{try{return new c3(e)}catch(t){throw Error(`Could not parse trust anchor certificate:
${e}`,{cause:t})}}),o=[];for(let e=0;e<n.length;e++){let t=n[e];try{await ul(t)}catch(e){continue}try{uc(t.notBefore,t.notAfter)}catch(e){continue}o.push(t)}if(0===o.length)throw Error("No specified trust anchor was valid for verifying x5c");let s=!1;for(let e of n)try{let t=i.concat([e]);if(new Set(t).size!==t.length)throw Error("Invalid certificate path: found duplicate certificates");for(let e=0;e<t.length-1;e++){let i=t[e],n=t[e+1];if(!await i.verify({publicKey:n.publicKey,signatureOnly:!0},r))throw new uu;if(n.subject===n.issuer){if(!await n.verify({publicKey:n.publicKey,signatureOnly:!0},r))throw new uu;break}}s=!1;break}catch(e){if(e instanceof uu)s=!0;else throw Error("Unexpected error while validating certificate path",{cause:e})}if(s)throw new uu;return!0}async function ul(e){if(await ui(e))throw Error("Found revoked certificate in certificate path")}function uc(e,t){let r=new Date(Date.now());if(e>r||t<r)throw Error("Certificate is not yet valid or expired")}class uu extends Error{constructor(){super("Subject issuer did not match issuer subject"),this.name="InvalidSubjectAndIssuer"}}var t6=t6;function up(e){let t;if("1.2.840.10045.4.3.2"===e)t=ef.ES256;else if("1.2.840.10045.4.3.3"===e)t=ef.ES384;else if("1.2.840.10045.4.3.4"===e)t=ef.ES512;else if("1.2.840.113549.1.1.11"===e)t=ef.RS256;else if("1.2.840.113549.1.1.12"===e)t=ef.RS384;else if("1.2.840.113549.1.1.13"===e)t=ef.RS512;else if("1.2.840.113549.1.1.5"===e)t=ef.RS1;else throw Error(`Unable to map X.509 signature algorithm ${e} to a COSE algorithm`);return t}function uh(e){let t=new Map,{tbsCertificate:r}=ne.parse(e,oT),{subjectPublicKeyInfo:i,signature:n}=r,o=n.algorithm,s=i.algorithm.algorithm;if(s===sV){let e,r;if(!i.algorithm.parameters)throw Error("Certificate public key was missing parameters (EC2)");let n=ne.parse(new Uint8Array(i.algorithm.parameters),s2),s=-999,{namedCurve:a}=n;if(a===s$)s=eh.P256;else if(a===sW)s=eh.P384;else throw Error(`Certificate public key contained unexpected namedCurve ${a} (EC2)`);let l=new Uint8Array(i.subjectPublicKey);if(4===l[0]){let t=1,i=(l.length-1)/2;e=l.slice(t,t+=i),r=l.slice(t)}else throw Error('TODO: Figure out how to handle public keys in "compressed form"');let c=new Map;c.set(eu.kty,ep.EC2),c.set(eu.alg,up(o)),c.set(eu.crv,s),c.set(eu.x,e),c.set(eu.y,r),t=c}else if(s===s3){let e=ne.parse(i.subjectPublicKey,ax),r=new Map;r.set(eu.kty,ep.RSA),r.set(eu.alg,up(o)),r.set(eu.n,new Uint8Array(e.modulus)),r.set(eu.e,new Uint8Array(e.publicExponent)),t=r}else throw Error(`Certificate public key contained unexpected algorithm ID ${s}`);return t}function uf(e){let{signature:t,data:r,credentialPublicKey:i,x509Certificate:n,hashAlgorithm:o}=e;if(!n&&!i)throw Error('Must declare either "leafCert" or "credentialPublicKey"');if(n&&i)throw Error('Must not declare both "leafCert" and "credentialPublicKey"');let s=new Map;return i?s=t5(i):n&&(s=uh(n)),ud.stubThis(t6.verify({cosePublicKey:s,signature:t,data:r,shaHashOverride:o}))}let ud={stubThis:e=>e};e.i(643130);var uy=tV;async function ug(e){let t,{cosePublicKey:r,signature:i,data:n}=e,o=await U(),s=r.get(eu.alg),a=r.get(eu.crv),l=r.get(eu.x);if(!s)throw Error("Public key was missing alg (OKP)");if(!N(s))throw Error(`Public key had invalid alg ${s} (OKP)`);if(!a)throw Error("Public key was missing crv (OKP)");if(!l)throw Error("Public key was missing x (OKP)");if(a===eh.ED25519)t="Ed25519";else throw Error(`Unexpected COSE crv value of ${a} (OKP)`);let c={kty:"OKP",crv:t,alg:"EdDSA",x:uy.fromBuffer(l),ext:!1},u={name:t,namedCurve:t},p=await L({keyData:c,algorithm:u}),h={name:t};return o.subtle.verify(h,p,i,n)}var tY=tY;function uv(e,t){let r;if(e.length<t)(r=new Uint8Array(t)).set(e,t-e.length);else if(e.length===t)r=e;else if(e.length===t+1&&0===e[0]&&(128&e[1])==128)r=e.subarray(1);else throw Error(`Invalid signature component length ${e.length}, expected ${t}`);return r}function um(e){let t,{cosePublicKey:r,signature:i,data:n,shaHashOverride:o}=e;if(I(r)){let e,t,s,a,l,c,u=r.get(eu.crv);if(!(Object.values(eh).indexOf(u)>=0))throw Error(`unknown COSE curve ${u}`);return tH({cosePublicKey:r,signature:(t=new Uint8Array((e=ne.parse(i,s8)).r),s=new Uint8Array(e.s),l=uv(t,a=function(e){switch(e){case eh.P256:return 32;case eh.P384:return 48;case eh.P521:return 66;default:throw Error(`Unexpected COSE crv value of ${e} (EC2)`)}}(u)),c=uv(s,a),tY.concat([l,c])),data:n,shaHashOverride:o})}if(T(r))return tF({cosePublicKey:r,signature:i,data:n,shaHashOverride:o});if(O(t=r.get(eu.kty))&&t===ep.OKP)return ug({cosePublicKey:r,signature:i,data:n});let s=r.get(eu.kty);throw Error(`Signature verification with public key of kty ${s} is not supported by this method`)}var t6=t6;async function uw(){let e=new Uint8Array(32);return await t6.getRandomValues(e),uA.stubThis(e)}let uA={stubThis:e=>e};var tV=tV,tY=tY;let ub=[-8,-7,-36,-37,-38,-39,-257,-258,-259,-65535],uS={residentKey:"preferred",userVerification:"preferred"},uE=[-8,-7,-257];async function uB(e){let{rpName:t,rpID:r,userName:i,userID:n,challenge:o=await uw(),userDisplayName:s="",timeout:a=6e4,attestationType:l="none",excludeCredentials:c=[],authenticatorSelection:u=uS,extensions:p,supportedAlgorithmIDs:h=uE,preferredAuthenticatorType:f}=e,d=h.map(e=>({alg:e,type:"public-key"}));void 0===u.residentKey?u.requireResidentKey&&(u.residentKey="required"):u.requireResidentKey="required"===u.residentKey;let y=o;if("string"==typeof y&&(y=tY.fromUTF8String(y)),"string"==typeof n)throw Error("String values for `userID` are no longer supported. See https://simplewebauthn.dev/docs/advanced/server/custom-user-ids");let g=n;g||(g=await t7());let v=[];return f&&("securityKey"===f?(v.push("security-key"),u.authenticatorAttachment="cross-platform"):"localDevice"===f?(v.push("client-device"),u.authenticatorAttachment="platform"):"remoteDevice"===f&&(v.push("hybrid"),u.authenticatorAttachment="cross-platform")),{challenge:tV.fromBuffer(y),rp:{name:t,id:r},user:{id:tV.fromBuffer(g),name:i,displayName:s},pubKeyCredParams:d,timeout:a,attestation:l,excludeCredentials:c.map(e=>{if(!tV.isBase64URL(e.id))throw Error(`excludeCredential id "${e.id}" is not a valid base64url string`);return{...e,id:tV.trimPadding(e.id),type:"public-key"}}),authenticatorSelection:u,extensions:{...p,credProps:!0},hints:v}}function ux({be:e,bs:t}){let r="singleDevice";if(e&&(r="multiDevice"),"singleDevice"===r&&t)throw new uC("Single-device credential indicated that it was backed up, which should be impossible.");return{credentialDeviceType:r,credentialBackedUp:t}}class uC extends Error{constructor(e){super(e),this.name="InvalidBackupFlags"}}var tY=tY;async function uk(e,t){try{return await Promise.any(t.map(t=>new Promise((r,i)=>{us(tY.fromASCIIString(t)).then(n=>{tY.areEqual(e,n)?r(t):i()})})))}catch(e){if("AggregateError"===e.name)throw new uI;throw e}}class uI extends Error{constructor(){super("Unexpected RP ID hash"),this.name="UnexpectedRPIDHash"}}var tV=tV;let uT=`-----BEGIN CERTIFICATE-----
MIIDdTCCAl2gAwIBAgILBAAAAAABFUtaw5QwDQYJKoZIhvcNAQEFBQAwVzELMAkG
A1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv
b3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw05ODA5MDExMjAw
MDBaFw0yODAxMjgxMjAwMDBaMFcxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i
YWxTaWduIG52LXNhMRAwDgYDVQQLEwdSb290IENBMRswGQYDVQQDExJHbG9iYWxT
aWduIFJvb3QgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDaDuaZ
jc6j40+Kfvvxi4Mla+pIH/EqsLmVEQS98GPR4mdmzxzdzxtIK+6NiY6arymAZavp
xy0Sy6scTHAHoT0KMM0VjU/43dSMUBUc71DuxC73/OlS8pF94G3VNTCOXkNz8kHp
1Wrjsok6Vjk4bwY8iGlbKk3Fp1S4bInMm/k8yuX9ifUSPJJ4ltbcdG6TRGHRjcdG
snUOhugZitVtbNV4FpWi6cgKOOvyJBNPc1STE4U6G7weNLWLBYy5d4ux2x8gkasJ
U26Qzns3dLlwR5EiUWMWea6xrkEmCMgZK9FGqkjWZCrXgzT/LCrBbBlDSgeF59N8
9iFo7+ryUp9/k5DPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8E
BTADAQH/MB0GA1UdDgQWBBRge2YaRQ2XyolQL30EzTSo//z9SzANBgkqhkiG9w0B
AQUFAAOCAQEA1nPnfE920I2/7LqivjTFKDK1fPxsnCwrvQmeU79rXqoRSLblCKOz
yj1hTdNGCbM+w6DjY1Ub8rrvrTnhQ7k4o+YviiY776BQVvnGCv04zcQLcFGUl5gE
38NflNUVyRRBnMRddWQVDf9VMOyGj/8N7yy5Y0b2qvzfvGn9LhJIZJrglfCm7ymP
AbEVtQwdpf5pLGkkeB6zpxxxYu7KyJesF12KwvhHhm4qxFYxldBniYUr+WymXUad
DKqC5JlR3XC321Y9YeRq4VzW9v493kHMB65jUr9TU/Qr6cf9tveCX4XSQRjbgbME
HMUfpIBvFSDJ3gyICh3WZlXi/EjJKSZp4A==
-----END CERTIFICATE-----
`,uO=`-----BEGIN CERTIFICATE-----
MIIFYDCCA0igAwIBAgIJAOj6GWMU0voYMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMTYwNTI2MTYyODUyWhcNMjYwNTI0MTYy
ODUyWjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS
Sxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7
tv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj
nar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq
C4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ
oVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O
JtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg
sTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi
igHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M
RPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E
aDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um
AGMCAwEAAaOBpjCBozAdBgNVHQ4EFgQUNmHhAHyIBQlRi0RsR/8aTMnqTxIwHwYD
VR0jBBgwFoAUNmHhAHyIBQlRi0RsR/8aTMnqTxIwDwYDVR0TAQH/BAUwAwEB/zAO
BgNVHQ8BAf8EBAMCAYYwQAYDVR0fBDkwNzA1oDOgMYYvaHR0cHM6Ly9hbmRyb2lk
Lmdvb2dsZWFwaXMuY29tL2F0dGVzdGF0aW9uL2NybC8wDQYJKoZIhvcNAQELBQAD
ggIBACDIw41L3KlXG0aMiS//cqrG+EShHUGo8HNsw30W1kJtjn6UBwRM6jnmiwfB
Pb8VA91chb2vssAtX2zbTvqBJ9+LBPGCdw/E53Rbf86qhxKaiAHOjpvAy5Y3m00m
qC0w/Zwvju1twb4vhLaJ5NkUJYsUS7rmJKHHBnETLi8GFqiEsqTWpG/6ibYCv7rY
DBJDcR9W62BW9jfIoBQcxUCUJouMPH25lLNcDc1ssqvC2v7iUgI9LeoM1sNovqPm
QUiG9rHli1vXxzCyaMTjwftkJLkf6724DFhuKug2jITV0QkXvaJWF4nUaHOTNA4u
JU9WDvZLI1j83A+/xnAJUucIv/zGJ1AMH2boHqF8CY16LpsYgBt6tKxxWH00XcyD
CdW2KlBCeqbQPcsFmWyWugxdcekhYsAWyoSf818NUsZdBWBaR/OukXrNLfkQ79Iy
ZohZbvabO/X+MVT3rriAoKc8oE2Uws6DF+60PV7/WIPjNvXySdqspImSN78mflxD
qwLqRBYkA3I75qppLGG9rp7UCdRjxMl8ZDBld+7yvHVgt1cVzJx9xnyGCC23Uaic
MDSXYrB4I4WHXPGjxhZuCuPBLTdOLU8YRvMYdEvYebWHMpvwGCF6bAx3JBpIeOQ1
wDB5y0USicV3YgYGmi+NZfhA4URSh77Yd6uuJOJENRaNVTzk
-----END CERTIFICATE-----
`,uN=`-----BEGIN CERTIFICATE-----
MIIFHDCCAwSgAwIBAgIJANUP8luj8tazMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMTkxMTIyMjAzNzU4WhcNMzQxMTE4MjAz
NzU4WjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS
Sxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7
tv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj
nar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq
C4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ
oVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O
JtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg
sTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi
igHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M
RPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E
aDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um
AGMCAwEAAaNjMGEwHQYDVR0OBBYEFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMB8GA1Ud
IwQYMBaAFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMA8GA1UdEwEB/wQFMAMBAf8wDgYD
VR0PAQH/BAQDAgIEMA0GCSqGSIb3DQEBCwUAA4ICAQBOMaBc8oumXb2voc7XCWnu
XKhBBK3e2KMGz39t7lA3XXRe2ZLLAkLM5y3J7tURkf5a1SutfdOyXAmeE6SRo83U
h6WszodmMkxK5GM4JGrnt4pBisu5igXEydaW7qq2CdC6DOGjG+mEkN8/TA6p3cno
L/sPyz6evdjLlSeJ8rFBH6xWyIZCbrcpYEJzXaUOEaxxXxgYz5/cTiVKN2M1G2ok
QBUIYSY6bjEL4aUN5cfo7ogP3UvliEo3Eo0YgwuzR2v0KR6C1cZqZJSTnghIC/vA
D32KdNQ+c3N+vl2OTsUVMC1GiWkngNx1OO1+kXW+YTnnTUOtOIswUP/Vqd5SYgAI
mMAfY8U9/iIgkQj6T2W6FsScy94IN9fFhE1UtzmLoBIuUFsVXJMTz+Jucth+IqoW
Fua9v1R93/k98p41pjtFX+H8DslVgfP097vju4KDlqN64xV1grw3ZLl4CiOe/A91
oeLm2UHOq6wn3esB4r2EIQKb6jTVGu5sYCcdWpXr0AUVqcABPdgL+H7qJguBw09o
jm6xNIrw2OocrDKsudk/okr/AwqEyPKw9WnMlQgLIKw1rODG2NvU9oR3GVGdMkUB
ZutL8VuFkERQGt6vQ2OCw0sV47VMkuYbacK/xyZFiRcrPJPb41zgbQj9XAEyLKCH
ex0SdDrx+tWUDqG8At2JHA==
-----END CERTIFICATE-----
`,uM=`
-----BEGIN CERTIFICATE-----
MIIFHDCCAwSgAwIBAgIJAMNrfES5rhgxMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMjExMTE3MjMxMDQyWhcNMzYxMTEzMjMx
MDQyWjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS
Sxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7
tv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj
nar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq
C4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ
oVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O
JtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg
sTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi
igHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M
RPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E
aDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um
AGMCAwEAAaNjMGEwHQYDVR0OBBYEFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMB8GA1Ud
IwQYMBaAFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMA8GA1UdEwEB/wQFMAMBAf8wDgYD
VR0PAQH/BAQDAgIEMA0GCSqGSIb3DQEBCwUAA4ICAQBTNNZe5cuf8oiq+jV0itTG
zWVhSTjOBEk2FQvh11J3o3lna0o7rd8RFHnN00q4hi6TapFhh4qaw/iG6Xg+xOan
63niLWIC5GOPFgPeYXM9+nBb3zZzC8ABypYuCusWCmt6Tn3+Pjbz3MTVhRGXuT/T
QH4KGFY4PhvzAyXwdjTOCXID+aHud4RLcSySr0Fq/L+R8TWalvM1wJJPhyRjqRCJ
erGtfBagiALzvhnmY7U1qFcS0NCnKjoO7oFedKdWlZz0YAfu3aGCJd4KHT0MsGiL
Zez9WP81xYSrKMNEsDK+zK5fVzw6jA7cxmpXcARTnmAuGUeI7VVDhDzKeVOctf3a
0qQLwC+d0+xrETZ4r2fRGNw2YEs2W8Qj6oDcfPvq9JySe7pJ6wcHnl5EZ0lwc4xH
7Y4Dx9RA1JlfooLMw3tOdJZH0enxPXaydfAD3YifeZpFaUzicHeLzVJLt9dvGB0b
HQLE4+EqKFgOZv2EoP686DQqbVS1u+9k0p2xbMA105TBIk7npraa8VM0fnrRKi7w
lZKwdH+aNAyhbXRW9xsnODJ+g8eF452zvbiKKngEKirK5LGieoXBX7tZ9D1GNBH2
Ob3bKOwwIWdEFle/YF/h6zWgdeoaNGDqVBrLr2+0DtWoiB1aDEjLWl9FmyIUyUm7
mD/vFDkzF+wm7cyWpQpCVQ==
-----END CERTIFICATE-----
`,uU=`
-----BEGIN CERTIFICATE-----
MIIFHDCCAwSgAwIBAgIJAPHBcqaZ6vUdMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMjIwMzIwMTgwNzQ4WhcNNDIwMzE1MTgw
NzQ4WjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAr7bHgiuxpwHsK7Qui8xUFmOr75gvMsd/dTEDDJdS
Sxtf6An7xyqpRR90PL2abxM1dEqlXnf2tqw1Ne4Xwl5jlRfdnJLmN0pTy/4lj4/7
tv0Sk3iiKkypnEUtR6WfMgH0QZfKHM1+di+y9TFRtv6y//0rb+T+W8a9nsNL/ggj
nar86461qO0rOs2cXjp3kOG1FEJ5MVmFmBGtnrKpa73XpXyTqRxB/M0n1n/W9nGq
C4FSYa04T6N5RIZGBN2z2MT5IKGbFlbC8UrW0DxW7AYImQQcHtGl/m00QLVWutHQ
oVJYnFPlXTcHYvASLu+RhhsbDmxMgJJ0mcDpvsC4PjvB+TxywElgS70vE0XmLD+O
JtvsBslHZvPBKCOdT0MS+tgSOIfga+z1Z1g7+DVagf7quvmag8jfPioyKvxnK/Eg
sTUVi2ghzq8wm27ud/mIM7AY2qEORR8Go3TVB4HzWQgpZrt3i5MIlCaY504LzSRi
igHCzAPlHws+W0rB5N+er5/2pJKnfBSDiCiFAVtCLOZ7gLiMm0jhO2B6tUXHI/+M
RPjy02i59lINMRRev56GKtcd9qO/0kUJWdZTdA2XoS82ixPvZtXQpUpuL12ab+9E
aDK8Z4RHJYYfCT3Q5vNAXaiWQ+8PTWm2QgBR/bkwSWc+NpUFgNPN9PvQi8WEg5Um
AGMCAwEAAaNjMGEwHQYDVR0OBBYEFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMB8GA1Ud
IwQYMBaAFDZh4QB8iAUJUYtEbEf/GkzJ6k8SMA8GA1UdEwEB/wQFMAMBAf8wDgYD
VR0PAQH/BAQDAgIEMA0GCSqGSIb3DQEBCwUAA4ICAQB8cMqTllHc8U+qCrOlg3H7
174lmaCsbo/bJ0C17JEgMLb4kvrqsXZs01U3mB/qABg/1t5Pd5AORHARs1hhqGIC
W/nKMav574f9rZN4PC2ZlufGXb7sIdJpGiO9ctRhiLuYuly10JccUZGEHpHSYM2G
tkgYbZba6lsCPYAAP83cyDV+1aOkTf1RCp/lM0PKvmxYN10RYsK631jrleGdcdkx
oSK//mSQbgcWnmAEZrzHoF1/0gso1HZgIn0YLzVhLSA/iXCX4QT2h3J5z3znluKG
1nv8NQdxei2DIIhASWfu804CA96cQKTTlaae2fweqXjdN1/v2nqOhngNyz1361mF
mr4XmaKH/ItTwOe72NI9ZcwS1lVaCvsIkTDCEXdm9rCNPAY10iTunIHFXRh+7KPz
lHGewCq/8TOohBRn0/NNfh7uRslOSZ/xKbN9tMBtw37Z8d2vvnXq/YWdsm1+JLVw
n6yYD/yacNJBlwpddla8eaVMjsF6nBnIgQOf9zKSe06nSTqvgwUHosgOECZJZ1Eu
zbH4yswbt02tKtKEFhx+v+OTge/06V+jGsqTWLsfrOCNLuA8H++z+pUENmpqnnHo
vaI47gC+TNpkgYGkkBT6B/m/U01BuOBBTzhIlMEZq9qkDWuM2cA5kW5V3FJUcfHn
w1IdYIg2Wxg7yHcQZemFQg==
-----END CERTIFICATE-----
`,uP=`-----BEGIN CERTIFICATE-----
MIICEjCCAZmgAwIBAgIQaB0BbHo84wIlpQGUKEdXcTAKBggqhkjOPQQDAzBLMR8w
HQYDVQQDDBZBcHBsZSBXZWJBdXRobiBSb290IENBMRMwEQYDVQQKDApBcHBsZSBJ
bmMuMRMwEQYDVQQIDApDYWxpZm9ybmlhMB4XDTIwMDMxODE4MjEzMloXDTQ1MDMx
NTAwMDAwMFowSzEfMB0GA1UEAwwWQXBwbGUgV2ViQXV0aG4gUm9vdCBDQTETMBEG
A1UECgwKQXBwbGUgSW5jLjETMBEGA1UECAwKQ2FsaWZvcm5pYTB2MBAGByqGSM49
AgEGBSuBBAAiA2IABCJCQ2pTVhzjl4Wo6IhHtMSAzO2cv+H9DQKev3//fG59G11k
xu9eI0/7o6V5uShBpe1u6l6mS19S1FEh6yGljnZAJ+2GNP1mi/YK2kSXIuTHjxA/
pcoRf7XkOtO4o1qlcaNCMEAwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUJtdk
2cV4wlpn0afeaxLQG2PxxtcwDgYDVR0PAQH/BAQDAgEGMAoGCCqGSM49BAMDA2cA
MGQCMFrZ+9DsJ1PW9hfNdBywZDsWDbWFp28it1d/5w2RPkRX3Bbn/UbDTNLx7Jr3
jAGGiQIwHFj+dJZYUJR786osByBelJYsVZd2GbHQu209b5RCmGQ21gpSAk9QZW4B
1bWeT0vT
-----END CERTIFICATE-----
`,uD=`-----BEGIN CERTIFICATE-----
MIIDXzCCAkegAwIBAgILBAAAAAABIVhTCKIwDQYJKoZIhvcNAQELBQAwTDEgMB4G
A1UECxMXR2xvYmFsU2lnbiBSb290IENBIC0gUjMxEzARBgNVBAoTCkdsb2JhbFNp
Z24xEzARBgNVBAMTCkdsb2JhbFNpZ24wHhcNMDkwMzE4MTAwMDAwWhcNMjkwMzE4
MTAwMDAwWjBMMSAwHgYDVQQLExdHbG9iYWxTaWduIFJvb3QgQ0EgLSBSMzETMBEG
A1UEChMKR2xvYmFsU2lnbjETMBEGA1UEAxMKR2xvYmFsU2lnbjCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMwldpB5BngiFvXAg7aEyiie/QV2EcWtiHL8
RgJDx7KKnQRfJMsuS+FggkbhUqsMgUdwbN1k0ev1LKMPgj0MK66X17YUhhB5uzsT
gHeMCOFJ0mpiLx9e+pZo34knlTifBtc+ycsmWQ1z3rDI6SYOgxXG71uL0gRgykmm
KPZpO/bLyCiR5Z2KYVc3rHQU3HTgOu5yLy6c+9C7v/U9AOEGM+iCK65TpjoWc4zd
QQ4gOsC0p6Hpsk+QLjJg6VfLuQSSaGjlOCZgdbKfd/+RFO+uIEn8rUAVSNECMWEZ
XriX7613t2Saer9fwRPvm2L7DWzgVGkWqQPabumDk3F2xmmFghcCAwEAAaNCMEAw
DgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFI/wS3+o
LkUkrk1Q+mOai97i3Ru8MA0GCSqGSIb3DQEBCwUAA4IBAQBLQNvAUKr+yAzv95ZU
RUm7lgAJQayzE4aGKAczymvmdLm6AC2upArT9fHxD4q/c2dKg8dEe3jgr25sbwMp
jjM5RcOO5LlXbKr8EpbsU8Yt5CRsuZRj+9xTaGdWPoO4zzUhw8lo/s7awlOqzJCK
6fBdRoyV3XpYKBovHd7NADdBj+1EbddTKJd+82cEHhXXipa0095MJ6RMG3NzdvQX
mcIfeg7jLQitChws/zyrVQ4PkX4268NXSb7hLi18YIvDQVETI53O9zJrlAGomecs
Mx86OyXShkDOOyyGeMlhLxS67ttVb9+E7gUJTb0o2HLO02JQZR7rkpeDMdmztcpH
WD9f
-----END CERTIFICATE-----
 `,uR=new class{constructor(){Object.defineProperty(this,"pemCertificates",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pemCertificates=new Map}setRootCertificates(e){let{identifier:t,certificates:r}=e,i=[];for(let e of r)e instanceof Uint8Array?i.push(tZ(e)):i.push(e);this.pemCertificates.set(t,i)}getRootCertificates(e){let{identifier:t}=e;return this.pemCertificates.get(t)??[]}};uR.setRootCertificates({identifier:"android-key",certificates:[uO,uN,uM,uU]}),uR.setRootCertificates({identifier:"android-safetynet",certificates:[uT]}),uR.setRootCertificates({identifier:"apple",certificates:[uP]}),uR.setRootCertificates({identifier:"mds",certificates:[uD]});var tY=tY;async function uj(e){let{attStmt:t,clientDataHash:r,rpIdHash:i,credentialID:n,credentialPublicKey:o,aaguid:s,rootCertificates:a}=e,l=Uint8Array.from([0]),c=t1(o),u=tY.concat([l,i,r,n,c]),p=t.get("sig"),h=t.get("x5c");if(!h)throw Error("No attestation certificate provided in attestation statement (FIDOU2F)");if(!p)throw Error("No attestation signature provided in attestation statement (FIDOU2F)");let f=Number.parseInt(tY.toHex(s),16);if(0!==f)throw Error(`AAGUID "${f}" was not expected value`);try{await ua(h.map(tZ),a)}catch(e){throw Error(`${e.message} (FIDOU2F)`)}return uf({signature:p,data:u,x509Certificate:h[0],hashAlgorithm:ef.ES256})}var tY=tY,tY=tY;let uL="1.3.6.1.4.1.45724.1.1.4";function uV(e,t){if(!e)return!0;let r=e.find(e=>e.extnID===uL);if(!r)return!0;let i=new Uint8Array(ne.parse(r.extnValue,iM).buffer);if(!tY.areEqual(t,i)){let e=tY.toHex(i),r=tY.toHex(t);throw Error(`Certificate extension id-fido-gen-ce-aaguid (${uL}) value of "${e}" was present but not equal to attestation statement AAGUID value of "${r}"`)}return!0}var tV=tV,tV=tV,tV=tV,tY=tY;(er=tU||(tU={}))[er.DISABLED=0]="DISABLED",er[er.REFRESHING=1]="REFRESHING",er[er.READY=2]="READY";let uH=(e,...t)=>{},u_=new class{constructor(){Object.defineProperty(this,"mdsCache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"statementCache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:tU.DISABLED}),Object.defineProperty(this,"verificationMode",{enumerable:!0,configurable:!0,writable:!0,value:"strict"})}async initialize(e={}){let{mdsServers:t=["https://mds.fidoalliance.org/"],statements:r,verificationMode:i}=e;if(this.setState(tU.REFRESHING),r?.length){let e=0;r.forEach(t=>{t.aaguid&&(this.statementCache[t.aaguid]={entry:{metadataStatement:t,statusReports:[],timeOfLastStatusChange:"1970-01-01"},url:""},e+=1)}),uH(`Cached ${e} local statements`)}if(t?.length){let e=Object.keys(this.statementCache).length,r=t.length;for(let e of t)try{await this.downloadBlob({url:e,no:0,nextUpdate:new Date(0)})}catch(t){uH(`Could not download BLOB from ${e}:`,t),r-=1}let i=Object.keys(this.statementCache).length;uH(`Cached ${i-e} statements from ${r} metadata server(s)`)}i&&(this.verificationMode=i),this.setState(tU.READY)}async getStatement(e){if(this.state===tU.DISABLED||!e)return;e instanceof Uint8Array&&(e=tX(e)),await this.pauseUntilReady();let t=this.statementCache[e];if(!t){if("strict"===this.verificationMode)throw Error(`No metadata statement found for aaguid "${e}"`);return}if(t.url){let e=this.mdsCache[t.url];if(new Date>e.nextUpdate)try{this.setState(tU.REFRESHING),await this.downloadBlob(e)}finally{this.setState(tU.READY)}}let{entry:r}=t;for(let t of r.statusReports){let{status:r}=t;if("USER_VERIFICATION_BYPASS"===r||"ATTESTATION_KEY_COMPROMISE"===r||"USER_KEY_REMOTE_COMPROMISE"===r||"USER_KEY_PHYSICAL_COMPROMISE"===r)throw Error(`Detected compromised aaguid "${e}"`)}return r.metadataStatement}async downloadBlob(e){let t,r,{url:i,no:n}=e,o=await ue(i),s=await o.text(),a=(t=s.split("."),[JSON.parse(tV.toUTF8String(t[0])),JSON.parse(tV.toUTF8String(t[1])),t[2]]),l=a[0],c=a[1];if(c.no<=n)throw Error(`Latest BLOB no. "${c.no}" is not greater than previous ${n}`);let u=l.x5c.map(tZ);try{let e=uR.getRootCertificates({identifier:"mds"});await ua(u,e)}catch(e){throw Error("BLOB certificate path could not be validated",{cause:e})}let p=u[0];if(!await function(e,t){let[r,i,n]=e.split("."),o=uh(t),s=tY.fromUTF8String(`${r}.${i}`),a=tV.toBuffer(n);if(I(o))return tH({data:s,signature:a,cosePublicKey:o,shaHashOverride:ef.ES256});if(T(o))return tF({data:s,signature:a,cosePublicKey:o});let l=o.get(eu.kty);throw Error(`JWT verification with public key of kty ${l} is not supported by this method`)}(s,(r=p.replace("-----BEGIN CERTIFICATE-----","").replace("-----END CERTIFICATE-----","").replace(/[\n ]/g,""),tV.toBuffer(r,"base64"))))throw Error("BLOB signature could not be verified");for(let e of c.entries)e.aaguid&&(this.statementCache[e.aaguid]={entry:e,url:i});let[h,f,d]=c.nextUpdate.split("-");this.mdsCache[i]={...e,no:c.no,nextUpdate:new Date(parseInt(h,10),parseInt(f,10)-1,parseInt(d,10))}}pauseUntilReady(){return new Promise(this.state===tU.READY?e=>{e()}:(e,t)=>{let r=700,i=globalThis.setInterval(()=>{r<1?(clearInterval(i),t("State did not become ready in 70 seconds")):this.state===tU.READY&&(clearInterval(i),e()),r-=1},100)})}setState(e){this.state=e,e===tU.DISABLED?uH("MetadataService is DISABLED"):e===tU.REFRESHING?uH("MetadataService is REFRESHING"):e===tU.READY&&uH("MetadataService is READY")}};async function uF({statement:e,credentialPublicKey:t,x5c:r,attestationStatementAlg:i}){let{authenticationAlgorithms:n,authenticatorGetInfo:o,attestationRootCertificates:s}=e,a=new Set;n.forEach(e=>{let t=uG[e];t&&a.add(t)});let l=t5(t),c=l.get(eu.kty),u=l.get(eu.alg);if(!c)throw Error("Credential public key was missing kty");if(!u)throw Error("Credential public key was missing alg");if(!c)throw Error("Credential public key was missing kty");let p={kty:c,alg:u};I(l)&&(p.crv=l.get(eu.crv));let h=!1;for(let e of a)if(e.alg===p.alg&&e.kty===p.kty&&((e.kty===ep.EC2||e.kty===ep.OKP)&&e.crv===p.crv,h=!0),h)break;if(!h){let e=JSON.stringify(n.map(e=>`'${e}' (COSE info: ${uK(uG[e])})`),null,2).replace(/"/g,""),t=uK(p);throw Error(`Public key parameters ${t} did not match any of the following metadata algorithms:
${e}`)}if(void 0!==i&&o?.algorithms!==void 0){let e=o.algorithms.map(e=>e.alg);if(0>e.indexOf(i))throw Error(`Attestation statement alg ${i} did not match one of ${e}`)}let f=r.map(tZ),d=s.map(tZ),y=!1;if(1===f.length&&d.indexOf(f[0])>=0&&(y=!0),!y)try{await ua(f,d)}catch(e){throw Error(`Could not validate certificate path with any metadata root certificates: ${e.message}`)}return!0}let uG={secp256r1_ecdsa_sha256_raw:{kty:2,alg:-7,crv:1},secp256r1_ecdsa_sha256_der:{kty:2,alg:-7,crv:1},rsassa_pss_sha256_raw:{kty:3,alg:-37},rsassa_pss_sha256_der:{kty:3,alg:-37},secp256k1_ecdsa_sha256_raw:{kty:2,alg:-47,crv:8},secp256k1_ecdsa_sha256_der:{kty:2,alg:-47,crv:8},rsassa_pss_sha384_raw:{kty:3,alg:-38},rsassa_pkcsv15_sha256_raw:{kty:3,alg:-257},rsassa_pkcsv15_sha384_raw:{kty:3,alg:-258},rsassa_pkcsv15_sha512_raw:{kty:3,alg:-259},rsassa_pkcsv15_sha1_raw:{kty:3,alg:-65535},secp384r1_ecdsa_sha384_raw:{kty:2,alg:-35,crv:2},secp512r1_ecdsa_sha256_raw:{kty:2,alg:-36,crv:3},ed25519_eddsa_sha512_raw:{kty:1,alg:-8,crv:6}};function uK(e){let{kty:t,alg:r,crv:i}=e;return t!==ep.RSA?`{ kty: ${t}, alg: ${r}, crv: ${i} }`:`{ kty: ${t}, alg: ${r} }`}async function u$(e){let{attStmt:t,clientDataHash:r,authData:i,credentialPublicKey:n,aaguid:o,rootCertificates:s}=e,a=t.get("sig"),l=t.get("x5c"),c=t.get("alg");if(!a)throw Error("No attestation signature provided in attestation statement (Packed)");if(!c)throw Error("Attestation statement did not contain alg (Packed)");if(!N(c))throw Error(`Attestation statement contained invalid alg ${c} (Packed)`);let u=tY.concat([i,r]),p=!1;if(l){let{subject:e,basicConstraintsCA:t,version:r,notBefore:i,notAfter:h,parsedCertificate:f}=oP(l[0]),{OU:d,CN:y,O:g,C:v}=e;if("Authenticator Attestation"!==d)throw Error('Certificate OU was not "Authenticator Attestation" (Packed|Full)');if(!y)throw Error("Certificate CN was empty (Packed|Full)");if(!g)throw Error("Certificate O was empty (Packed|Full)");if(!v||2!==v.length)throw Error("Certificate C was not two-character ISO 3166 code (Packed|Full)");if(t)throw Error("Certificate basic constraints CA was not `false` (Packed|Full)");if(2!==r)throw Error("Certificate version was not `3` (ASN.1 value of 2) (Packed|Full)");let m=new Date;if(i>m)throw Error(`Certificate not good before "${i.toString()}" (Packed|Full)`);if(h<(m=new Date))throw Error(`Certificate not good after "${h.toString()}" (Packed|Full)`);try{await uV(f.tbsCertificate.extensions,o)}catch(e){throw Error(`${e.message} (Packed|Full)`)}let w=await u_.getStatement(o);if(w){if(0>w.attestationTypes.indexOf("basic_full"))throw Error("Metadata does not indicate support for full attestations (Packed|Full)");try{await uF({statement:w,credentialPublicKey:n,x5c:l,attestationStatementAlg:c})}catch(e){throw Error(`${e.message} (Packed|Full)`)}}else try{await ua(l.map(tZ),s)}catch(e){throw Error(`${e.message} (Packed|Full)`)}p=await uf({signature:a,data:u,x509Certificate:l[0]})}else p=await uf({signature:a,data:u,credentialPublicKey:n,hashAlgorithm:c});return p}var tV=tV,tY=tY;async function uW(e){let{attStmt:t,clientDataHash:r,authData:i,aaguid:n,rootCertificates:o,verifyTimestampMS:s=!0,credentialPublicKey:a,attestationSafetyNetEnforceCTSCheck:l}=e,c=t.get("alg"),u=t.get("response");if(!t.get("ver"))throw Error("No ver value in attestation (SafetyNet)");if(!u)throw Error("No response was included in attStmt by authenticator (SafetyNet)");let p=tY.toUTF8String(u).split("."),h=JSON.parse(tV.toUTF8String(p[0])),f=JSON.parse(tV.toUTF8String(p[1])),d=p[2],{nonce:y,ctsProfileMatch:g,timestampMs:v}=f;if(s){let e=Date.now();if(v>Date.now())throw Error(`Payload timestamp "${v}" was later than "${e}" (SafetyNet)`);let t=v+6e4;if(t<(e=Date.now()))throw Error(`Payload timestamp "${t}" has expired (SafetyNet)`)}let m=tY.concat([i,r]),w=await us(m);if(y!==tV.fromBuffer(w,"base64"))throw Error("Could not verify payload nonce (SafetyNet)");if(l&&!g)throw Error("Could not verify device integrity (SafetyNet)");let A=tV.toBuffer(h.x5c[0],"base64"),{subject:b}=oP(A);if("attest.android.com"!==b.CN)throw Error('Certificate common name was not "attest.android.com" (SafetyNet)');let S=await u_.getStatement(n);if(S)try{await uF({statement:S,credentialPublicKey:a,x5c:h.x5c,attestationStatementAlg:c})}catch(e){throw Error(`${e.message} (SafetyNet)`)}else try{await ua(h.x5c.map(tZ),o)}catch(e){throw Error(`${e.message} (SafetyNet)`)}let E=tY.fromUTF8String(`${p[0]}.${p[1]}`),B=tV.toBuffer(d);return await uf({signature:B,data:E,x509Certificate:A})}var tY=tY;let uq={196:"TPM_ST_RSP_COMMAND",32768:"TPM_ST_NULL",32769:"TPM_ST_NO_SESSIONS",32770:"TPM_ST_SESSIONS",32788:"TPM_ST_ATTEST_NV",32789:"TPM_ST_ATTEST_COMMAND_AUDIT",32790:"TPM_ST_ATTEST_SESSION_AUDIT",32791:"TPM_ST_ATTEST_CERTIFY",32792:"TPM_ST_ATTEST_QUOTE",32793:"TPM_ST_ATTEST_TIME",32794:"TPM_ST_ATTEST_CREATION",32801:"TPM_ST_CREATION",32802:"TPM_ST_VERIFIED",32803:"TPM_ST_AUTH_SECRET",32804:"TPM_ST_HASHCHECK",32805:"TPM_ST_AUTH_SIGNED",32809:"TPM_ST_FU_MANIFEST"},uz={0:"TPM_ALG_ERROR",1:"TPM_ALG_RSA",4:"TPM_ALG_SHA",4:"TPM_ALG_SHA1",5:"TPM_ALG_HMAC",6:"TPM_ALG_AES",7:"TPM_ALG_MGF1",8:"TPM_ALG_KEYEDHASH",10:"TPM_ALG_XOR",11:"TPM_ALG_SHA256",12:"TPM_ALG_SHA384",13:"TPM_ALG_SHA512",16:"TPM_ALG_NULL",18:"TPM_ALG_SM3_256",19:"TPM_ALG_SM4",20:"TPM_ALG_RSASSA",21:"TPM_ALG_RSAES",22:"TPM_ALG_RSAPSS",23:"TPM_ALG_OAEP",24:"TPM_ALG_ECDSA",25:"TPM_ALG_ECDH",26:"TPM_ALG_ECDAA",27:"TPM_ALG_SM2",28:"TPM_ALG_ECSCHNORR",29:"TPM_ALG_ECMQV",32:"TPM_ALG_KDF1_SP800_56A",33:"TPM_ALG_KDF2",34:"TPM_ALG_KDF1_SP800_108",35:"TPM_ALG_ECC",37:"TPM_ALG_SYMCIPHER",38:"TPM_ALG_CAMELLIA",64:"TPM_ALG_CTR",65:"TPM_ALG_OFB",66:"TPM_ALG_CBC",67:"TPM_ALG_CFB",68:"TPM_ALG_ECB"},uQ={0:"TPM_ECC_NONE",1:"TPM_ECC_NIST_P192",2:"TPM_ECC_NIST_P224",3:"TPM_ECC_NIST_P256",4:"TPM_ECC_NIST_P384",5:"TPM_ECC_NIST_P521",16:"TPM_ECC_BN_P256",17:"TPM_ECC_BN_P638",32:"TPM_ECC_SM2_P256"},uJ={"id:414D4400":{name:"AMD",id:"AMD"},"id:414E5400":{name:"Ant Group",id:"ANT"},"id:41544D4C":{name:"Atmel",id:"ATML"},"id:4252434D":{name:"Broadcom",id:"BRCM"},"id:4353434F":{name:"Cisco",id:"CSCO"},"id:464C5953":{name:"Flyslice Technologies",id:"FLYS"},"id:524F4343":{name:"Fuzhou Rockchip",id:"ROCC"},"id:474F4F47":{name:"Google",id:"GOOG"},"id:48504900":{name:"HPI",id:"HPI"},"id:48504500":{name:"HPE",id:"HPE"},"id:48495349":{name:"Huawei",id:"HISI"},"id:49424d00":{name:"IBM",id:"IBM"},"id:49424D00":{name:"IBM",id:"IBM"},"id:49465800":{name:"Infineon",id:"IFX"},"id:494E5443":{name:"Intel",id:"INTC"},"id:4C454E00":{name:"Lenovo",id:"LEN"},"id:4D534654":{name:"Microsoft",id:"MSFT"},"id:4E534D20":{name:"National Semiconductor",id:"NSM"},"id:4E545A00":{name:"Nationz",id:"NTZ"},"id:4E534700":{name:"NSING",id:"NSG"},"id:4E544300":{name:"Nuvoton Technology",id:"NTC"},"id:51434F4D":{name:"Qualcomm",id:"QCOM"},"id:534D534E":{name:"Samsung",id:"SMSN"},"id:53454345":{name:"SecEdge",id:"SECE"},"id:534E5300":{name:"Sinosun",id:"SNS"},"id:534D5343":{name:"SMSC",id:"SMSC"},"id:53544D20":{name:"STMicroelectronics",id:"STM"},"id:54584E00":{name:"Texas Instruments",id:"TXN"},"id:57454300":{name:"Winbond",id:"WEC"},"id:5345414C":{name:"Wisekey",id:"SEAL"},"id:FFFFF1D0":{name:"FIDO Alliance",id:"FIDO"}},uY={TPM_ECC_NIST_P256:1,TPM_ECC_NIST_P384:2,TPM_ECC_NIST_P521:3,TPM_ECC_BN_P256:1,TPM_ECC_SM2_P256:1};var tY=tY,tY=tY;async function uX(e){let t,r,i,n,o,s,a,l,c,u,p,h,f,d,y,g,v,m,w,A,b,S,E,B,{aaguid:x,attStmt:C,authData:k,credentialPublicKey:O,clientDataHash:M,rootCertificates:U}=e,P=C.get("ver"),D=C.get("sig"),R=C.get("alg"),j=C.get("x5c"),L=C.get("pubArea"),V=C.get("certInfo");if("2.0"!==P)throw Error(`Unexpected ver "${P}", expected "2.0" (TPM)`);if(!D)throw Error("No attestation signature provided in attestation statement (TPM)");if(!R)throw Error("Attestation statement did not contain alg (TPM)");if(!N(R))throw Error(`Attestation statement contained invalid alg ${R} (TPM)`);if(!j)throw Error("No attestation certificate provided in attestation statement (TPM)");if(!L)throw Error("Attestation statement did not contain pubArea (TPM)");if(!V)throw Error("Attestation statement did not contain certInfo (TPM)");let{unique:H,type:_,parameters:F}=function(e){let t=0,r=tY.toDataView(e),i=uz[r.getUint16(t)];t+=2;let n=uz[r.getUint16(t)];t+=2;let o=r.getUint32(t);t+=4;let s=r.getUint16(t);t+=2;let a=e.slice(t,t+=s),l={},c=Uint8Array.from([]);if("TPM_ALG_RSA"===i){let i=uz[r.getUint16(t)];t+=2;let n=uz[r.getUint16(t)];t+=2;let o=r.getUint16(t);t+=2;let s=r.getUint32(t);t+=4,l.rsa={symmetric:i,scheme:n,keyBits:o,exponent:s};let a=r.getUint16(t);t+=2,c=e.slice(t,t+=a)}else if("TPM_ALG_ECC"===i){let i=uz[r.getUint16(t)];t+=2;let n=uz[r.getUint16(t)];t+=2;let o=uQ[r.getUint16(t)];t+=2;let s=uz[r.getUint16(t)];t+=2,l.ecc={symmetric:i,scheme:n,curveID:o,kdf:s};let a=r.getUint16(t);t+=2;let u=e.slice(t,t+=a),p=r.getUint16(t);t+=2;let h=e.slice(t,t+=p);c=tY.concat([u,h])}else throw Error(`Unexpected type "${i}" (TPM)`);return{type:i,nameAlg:n,objectAttributes:{fixedTPM:!!(1&o),stClear:!!(2&o),fixedParent:!!(8&o),sensitiveDataOrigin:!!(16&o),userWithAuth:!!(32&o),adminWithPolicy:!!(64&o),noDA:!!(512&o),encryptedDuplication:!!(1024&o),restricted:!!(32768&o),decrypt:!!(65536&o),signOrEncrypt:!!(131072&o)},authPolicy:a,parameters:l,unique:c}}(L),G=t5(O);if("TPM_ALG_RSA"===_){if(!T(G))throw Error(`Credential public key with kty ${G.get(eu.kty)} did not match ${_}`);let e=G.get(eu.n),t=G.get(eu.e);if(!e)throw Error("COSE public key missing n (TPM|RSA)");if(!t)throw Error("COSE public key missing e (TPM|RSA)");if(!tY.areEqual(H,e))throw Error("PubArea unique is not same as credentialPublicKey (TPM|RSA)");if(!F.rsa)throw Error("Parsed pubArea type is RSA, but missing parameters.rsa (TPM|RSA)");let r=F.rsa.exponent||65537,i=t[0]+(t[1]<<8)+(t[2]<<16);if(r!==i)throw Error(`Unexpected public key exp ${i}, expected ${r} (TPM|RSA)`)}else if("TPM_ALG_ECC"===_){if(!I(G))throw Error(`Credential public key with kty ${G.get(eu.kty)} did not match ${_}`);let e=G.get(eu.crv),t=G.get(eu.x),r=G.get(eu.y);if(!e)throw Error("COSE public key missing crv (TPM|ECC)");if(!t)throw Error("COSE public key missing x (TPM|ECC)");if(!r)throw Error("COSE public key missing y (TPM|ECC)");if(!tY.areEqual(H,tY.concat([t,r])))throw Error("PubArea unique is not same as public key x and y (TPM|ECC)");if(!F.ecc)throw Error("Parsed pubArea type is ECC, but missing parameters.ecc (TPM|ECC)");let i=F.ecc.curveID,n=uY[i];if(n!==e)throw Error(`Public area key curve ID "${i}" mapped to "${n}" which did not match public key crv of "${e}" (TPM|ECC)`)}else throw Error(`Unsupported pubArea.type "${_}"`);let{magic:K,type:$,attested:W,extraData:q}=(s=0,l=(a=tY.toDataView(V)).getUint32(s),s+=4,c=a.getUint16(s),s+=2,u=uq[c],p=a.getUint16(s),s+=2,h=V.slice(s,s+=p),f=a.getUint16(s),s+=2,d=V.slice(s,s+=f),y=V.slice(s,s+=8),g=a.getUint32(s),s+=4,v=a.getUint32(s),s+=4,m=!!V.slice(s,s+=1),w=V.slice(s,s+=8),A=a.getUint16(s),s+=2,b=V.slice(s,s+=A),S=tY.toDataView(b),E=a.getUint16(s),s+=2,B=V.slice(s,s+=E),{magic:l,type:u,qualifiedSigner:h,extraData:d,clockInfo:{clock:y,resetCount:g,restartCount:v,safe:m},firmwareVersion:w,attested:{nameAlg:uz[S.getUint16(0)],nameAlgBuffer:b.slice(0,2),name:b,qualifiedName:B}});if(0xff544347!==K)throw Error(`Unexpected magic value "${K}", expected "0xff544347" (TPM)`);if("TPM_ST_ATTEST_CERTIFY"!==$)throw Error(`Unexpected type "${$}", expected "TPM_ST_ATTEST_CERTIFY" (TPM)`);let z=await us(L,function(e){if("TPM_ALG_SHA256"===e)return ef.ES256;if("TPM_ALG_SHA384"===e)return ef.ES384;if("TPM_ALG_SHA512"===e)return ef.ES512;throw Error(`Unexpected TPM attested name alg ${e}`)}(W.nameAlg)),Q=tY.concat([W.nameAlgBuffer,z]);if(!tY.areEqual(W.name,Q))throw Error("Attested name comparison failed (TPM)");let J=tY.concat([k,M]),Y=await us(J,R);if(!tY.areEqual(q,Y))throw Error("CertInfo extra data did not equal hashed attestation (TPM)");if(j.length<1)throw Error("No certificates present in x5c array (TPM)");let{basicConstraintsCA:X,version:Z,subject:ee,notAfter:et,notBefore:er}=oP(j[0]);if(X)throw Error("Certificate basic constraints CA was not `false` (TPM)");if(2!==Z)throw Error("Certificate version was not `3` (ASN.1 value of 2) (TPM)");if(ee.combined.length>0)throw Error("Certificate subject was not empty (TPM)");let ei=new Date;if(er>ei)throw Error(`Certificate not good before "${er.toString()}" (TPM)`);if(et<(ei=new Date))throw Error(`Certificate not good after "${et.toString()}" (TPM)`);let en=ne.parse(j[0],oT);if(!en.tbsCertificate.extensions)throw Error("Certificate was missing extensions (TPM)");if(en.tbsCertificate.extensions.forEach(e=>{e.extnID===oh?n=ne.parse(e.extnValue,of):e.extnID===n1&&(o=ne.parse(e.extnValue,n2))}),!n)throw Error("Certificate did not contain subjectAltName extension (TPM)");if(!n[0].directoryName?.[0].length)throw Error("Certificate subjectAltName extension directoryName was empty (TPM)");let{tcgAtTpmManufacturer:eo,tcgAtTpmModel:es,tcgAtTpmVersion:ea}=(n[0].directoryName.forEach(e=>{e.forEach(e=>{"2.23.133.2.1"===e.type?t=e.value.toString():"2.23.133.2.2"===e.type?r=e.value.toString():"2.23.133.2.3"===e.type&&(i=e.value.toString())})}),{tcgAtTpmManufacturer:t,tcgAtTpmModel:r,tcgAtTpmVersion:i});if(!eo||!es||!ea)throw Error("Certificate contained incomplete subjectAltName data (TPM)");if(!o)throw Error("Certificate did not contain ExtendedKeyUsage extension (TPM)");if(!uJ[eo])throw Error(`Could not match TPM manufacturer "${eo}" (TPM)`);if("2.23.133.8.3"!==o[0])throw Error(`Unexpected extKeyUsage "${o[0]}", expected "2.23.133.8.3" (TPM)`);try{await uV(en.tbsCertificate.extensions,x)}catch(e){throw Error(`${e.message} (TPM)`)}let el=await u_.getStatement(x);if(el)try{await uF({statement:el,credentialPublicKey:O,x5c:j,attestationStatementAlg:R})}catch(e){throw Error(`${e.message} (TPM)`)}else try{await ua(j.map(tZ),U)}catch(e){throw Error(`${e.message} (TPM)`)}return uf({signature:D,data:V,x509Certificate:j[0],hashAlgorithm:R})}(ei=tD||(tD={}))[ei.verified=0]="verified",ei[ei.selfSigned=1]="selfSigned",ei[ei.unverified=2]="unverified",ei[ei.failed=3]="failed";class uZ{constructor(e={}){this.verifiedBootKey=new iM,this.deviceLocked=!1,this.verifiedBootState=tD.verified,Object.assign(this,e)}}nn([i7({type:iM})],uZ.prototype,"verifiedBootKey",void 0),nn([i7({type:ev.Boolean})],uZ.prototype,"deviceLocked",void 0),nn([i7({type:ev.Enumerated})],uZ.prototype,"verifiedBootState",void 0),nn([i7({type:iM,optional:!0})],uZ.prototype,"verifiedBootHash",void 0);let u0=tP=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,tP.prototype)}};u0=tP=nn([i6({type:eg.Set,itemType:ev.Integer})],u0);class u1{constructor(e={}){Object.assign(this,e)}}nn([i7({context:1,type:u0,optional:!0})],u1.prototype,"purpose",void 0),nn([i7({context:2,type:ev.Integer,optional:!0})],u1.prototype,"algorithm",void 0),nn([i7({context:3,type:ev.Integer,optional:!0})],u1.prototype,"keySize",void 0),nn([i7({context:5,type:u0,optional:!0})],u1.prototype,"digest",void 0),nn([i7({context:6,type:u0,optional:!0})],u1.prototype,"padding",void 0),nn([i7({context:10,type:ev.Integer,optional:!0})],u1.prototype,"ecCurve",void 0),nn([i7({context:200,type:ev.Integer,optional:!0})],u1.prototype,"rsaPublicExponent",void 0),nn([i7({context:203,type:u0,optional:!0})],u1.prototype,"mgfDigest",void 0),nn([i7({context:303,type:ev.Null,optional:!0})],u1.prototype,"rollbackResistance",void 0),nn([i7({context:305,type:ev.Null,optional:!0})],u1.prototype,"earlyBootOnly",void 0),nn([i7({context:400,type:ev.Integer,optional:!0})],u1.prototype,"activeDateTime",void 0),nn([i7({context:401,type:ev.Integer,optional:!0})],u1.prototype,"originationExpireDateTime",void 0),nn([i7({context:402,type:ev.Integer,optional:!0})],u1.prototype,"usageExpireDateTime",void 0),nn([i7({context:405,type:ev.Integer,optional:!0})],u1.prototype,"usageCountLimit",void 0),nn([i7({context:503,type:ev.Null,optional:!0})],u1.prototype,"noAuthRequired",void 0),nn([i7({context:504,type:ev.Integer,optional:!0})],u1.prototype,"userAuthType",void 0),nn([i7({context:505,type:ev.Integer,optional:!0})],u1.prototype,"authTimeout",void 0),nn([i7({context:506,type:ev.Null,optional:!0})],u1.prototype,"allowWhileOnBody",void 0),nn([i7({context:507,type:ev.Null,optional:!0})],u1.prototype,"trustedUserPresenceRequired",void 0),nn([i7({context:508,type:ev.Null,optional:!0})],u1.prototype,"trustedConfirmationRequired",void 0),nn([i7({context:509,type:ev.Null,optional:!0})],u1.prototype,"unlockedDeviceRequired",void 0),nn([i7({context:600,type:ev.Null,optional:!0})],u1.prototype,"allApplications",void 0),nn([i7({context:601,type:iM,optional:!0})],u1.prototype,"applicationId",void 0),nn([i7({context:701,type:ev.Integer,optional:!0})],u1.prototype,"creationDateTime",void 0),nn([i7({context:702,type:ev.Integer,optional:!0})],u1.prototype,"origin",void 0),nn([i7({context:703,type:ev.Null,optional:!0})],u1.prototype,"rollbackResistant",void 0),nn([i7({context:704,type:uZ,optional:!0})],u1.prototype,"rootOfTrust",void 0),nn([i7({context:705,type:ev.Integer,optional:!0})],u1.prototype,"osVersion",void 0),nn([i7({context:706,type:ev.Integer,optional:!0})],u1.prototype,"osPatchLevel",void 0),nn([i7({context:709,type:iM,optional:!0})],u1.prototype,"attestationApplicationId",void 0),nn([i7({context:710,type:iM,optional:!0})],u1.prototype,"attestationIdBrand",void 0),nn([i7({context:711,type:iM,optional:!0})],u1.prototype,"attestationIdDevice",void 0),nn([i7({context:712,type:iM,optional:!0})],u1.prototype,"attestationIdProduct",void 0),nn([i7({context:713,type:iM,optional:!0})],u1.prototype,"attestationIdSerial",void 0),nn([i7({context:714,type:iM,optional:!0})],u1.prototype,"attestationIdImei",void 0),nn([i7({context:715,type:iM,optional:!0})],u1.prototype,"attestationIdMeid",void 0),nn([i7({context:716,type:iM,optional:!0})],u1.prototype,"attestationIdManufacturer",void 0),nn([i7({context:717,type:iM,optional:!0})],u1.prototype,"attestationIdModel",void 0),nn([i7({context:718,type:ev.Integer,optional:!0})],u1.prototype,"vendorPatchLevel",void 0),nn([i7({context:719,type:ev.Integer,optional:!0})],u1.prototype,"bootPatchLevel",void 0),nn([i7({context:720,type:ev.Null,optional:!0})],u1.prototype,"deviceUniqueAttestation",void 0),nn([i7({context:723,type:iM,optional:!0})],u1.prototype,"attestationIdSecondImei",void 0),nn([i7({context:724,type:iM,optional:!0})],u1.prototype,"moduleHash",void 0),(en=tR||(tR={}))[en.software=0]="software",en[en.trustedEnvironment=1]="trustedEnvironment",en[en.strongBox=2]="strongBox",(eo=tj||(tj={}))[eo.KM2=1]="KM2",eo[eo.KM3=2]="KM3",eo[eo.KM4=3]="KM4",eo[eo.KM4_1=4]="KM4_1",eo[eo.keyMint1=100]="keyMint1",eo[eo.keyMint2=200]="keyMint2",eo[eo.keyMint3=300]="keyMint3",eo[eo.keyMint4=400]="keyMint4";class u2{constructor(e={}){this.attestationVersion=tj.KM4,this.attestationSecurityLevel=tR.software,this.keymasterVersion=0,this.keymasterSecurityLevel=tR.software,this.attestationChallenge=new iM,this.uniqueId=new iM,this.softwareEnforced=new u1,this.teeEnforced=new u1,Object.assign(this,e)}}nn([i7({type:ev.Integer})],u2.prototype,"attestationVersion",void 0),nn([i7({type:ev.Enumerated})],u2.prototype,"attestationSecurityLevel",void 0),nn([i7({type:ev.Integer})],u2.prototype,"keymasterVersion",void 0),nn([i7({type:ev.Enumerated})],u2.prototype,"keymasterSecurityLevel",void 0),nn([i7({type:iM})],u2.prototype,"attestationChallenge",void 0),nn([i7({type:iM})],u2.prototype,"uniqueId",void 0),nn([i7({type:u1})],u2.prototype,"softwareEnforced",void 0),nn([i7({type:u1})],u2.prototype,"teeEnforced",void 0);class u4{constructor(e={}){this.attestationVersion=tj.keyMint4,this.attestationSecurityLevel=tR.software,this.keyMintVersion=0,this.keyMintSecurityLevel=tR.software,this.attestationChallenge=new iM,this.uniqueId=new iM,this.softwareEnforced=new u1,this.hardwareEnforced=new u1,Object.assign(this,e)}toLegacyKeyDescription(){return new u2({attestationVersion:this.attestationVersion,attestationSecurityLevel:this.attestationSecurityLevel,keymasterVersion:this.keyMintVersion,keymasterSecurityLevel:this.keyMintSecurityLevel,attestationChallenge:this.attestationChallenge,uniqueId:this.uniqueId,softwareEnforced:this.softwareEnforced,teeEnforced:this.hardwareEnforced})}static fromLegacyKeyDescription(e){return new u4({attestationVersion:e.attestationVersion,attestationSecurityLevel:e.attestationSecurityLevel,keyMintVersion:e.keymasterVersion,keyMintSecurityLevel:e.keymasterSecurityLevel,attestationChallenge:e.attestationChallenge,uniqueId:e.uniqueId,softwareEnforced:e.softwareEnforced,hardwareEnforced:e.teeEnforced})}}nn([i7({type:ev.Integer})],u4.prototype,"attestationVersion",void 0),nn([i7({type:ev.Enumerated})],u4.prototype,"attestationSecurityLevel",void 0),nn([i7({type:ev.Integer})],u4.prototype,"keyMintVersion",void 0),nn([i7({type:ev.Enumerated})],u4.prototype,"keyMintSecurityLevel",void 0),nn([i7({type:iM})],u4.prototype,"attestationChallenge",void 0),nn([i7({type:iM})],u4.prototype,"uniqueId",void 0),nn([i7({type:u1})],u4.prototype,"softwareEnforced",void 0),nn([i7({type:u1})],u4.prototype,"hardwareEnforced",void 0);let u8=class extends u1{};u8=nn([i6({type:eg.Choice})],u8);let u5=tL=class extends nr{constructor(e){super(e),Object.setPrototypeOf(this,tL.prototype)}findProperty(e){let t=this.find(t=>e in t);if(t)return t[e]}};u5=tL=nn([i6({type:eg.Sequence,itemType:u8})],u5);class u3{get keyMintVersion(){return this.keymasterVersion}set keyMintVersion(e){this.keymasterVersion=e}get keyMintSecurityLevel(){return this.keymasterSecurityLevel}set keyMintSecurityLevel(e){this.keymasterSecurityLevel=e}get hardwareEnforced(){return this.teeEnforced}set hardwareEnforced(e){this.teeEnforced=e}constructor(e={}){this.attestationVersion=tj.KM4,this.attestationSecurityLevel=tR.software,this.keymasterVersion=0,this.keymasterSecurityLevel=tR.software,this.attestationChallenge=new iM,this.uniqueId=new iM,this.softwareEnforced=new u5,this.teeEnforced=new u5,Object.assign(this,e)}}nn([i7({type:ev.Integer})],u3.prototype,"attestationVersion",void 0),nn([i7({type:ev.Enumerated})],u3.prototype,"attestationSecurityLevel",void 0),nn([i7({type:ev.Integer})],u3.prototype,"keymasterVersion",void 0),nn([i7({type:ev.Enumerated})],u3.prototype,"keymasterSecurityLevel",void 0),nn([i7({type:iM})],u3.prototype,"attestationChallenge",void 0),nn([i7({type:iM})],u3.prototype,"uniqueId",void 0),nn([i7({type:u5})],u3.prototype,"softwareEnforced",void 0),nn([i7({type:u5})],u3.prototype,"teeEnforced",void 0);let u6=class extends u3{constructor(e={}){"keymasterVersion"in e&&!("keyMintVersion"in e)&&(e.keyMintVersion=e.keymasterVersion),"keymasterSecurityLevel"in e&&!("keyMintSecurityLevel"in e)&&(e.keyMintSecurityLevel=e.keymasterSecurityLevel),"teeEnforced"in e&&!("hardwareEnforced"in e)&&(e.hardwareEnforced=e.teeEnforced),super(e)}};u6=nn([i6({type:eg.Sequence})],u6);class u7{constructor(e={}){Object.assign(this,e)}}nn([i7({type:ev.OctetString})],u7.prototype,"packageName",void 0),nn([i7({type:ev.Integer})],u7.prototype,"version",void 0);class u9{constructor(e={}){Object.assign(this,e)}}nn([i7({type:u7,repeated:"set"})],u9.prototype,"packageInfos",void 0),nn([i7({type:ev.OctetString,repeated:"set"})],u9.prototype,"signatureDigests",void 0);var tY=tY;async function pe(e){let{authData:t,clientDataHash:r,attStmt:i,credentialPublicKey:n,aaguid:o,rootCertificates:s}=e,a=i.get("x5c"),l=i.get("sig"),c=i.get("alg");if(!a)throw Error("No attestation certificate provided in attestation statement (Android Key)");if(!l)throw Error("No attestation signature provided in attestation statement (Android Key)");if(!c)throw Error("Attestation statement did not contain alg (Android Key)");if(!N(c))throw Error(`Attestation statement contained invalid alg ${c} (Android Key)`);let u=ne.parse(a[0],oT),p=new Uint8Array(u.tbsCertificate.subjectPublicKeyInfo.subjectPublicKey),h=t1(n);if(!tY.areEqual(h,p))throw Error("Credential public key does not equal leaf cert public key (Android Key)");let f=u.tbsCertificate.extensions?.find(e=>"1.3.6.1.4.1.11129.2.1.17"===e.extnID);if(!f)throw Error("Certificate did not contain extKeyStore (Android Key)");let{attestationChallenge:d,teeEnforced:y,softwareEnforced:g}=ne.parse(f.extnValue,u2);if(!tY.areEqual(new Uint8Array(d.buffer),r))throw Error("Attestation challenge was not equal to client data hash (Android Key)");if(void 0!==y.allApplications||void 0!==g.allApplications)throw Error('teeEnforced contained "allApplications [600]" tag (Android Key)');let v=await u_.getStatement(o);if(v)try{await uF({statement:v,credentialPublicKey:n,x5c:a,attestationStatementAlg:c})}catch(e){throw Error(`${e.message} (Android Key)`,{cause:e})}else{let e=a.slice(0,-1).map(tZ),t=a.slice(-1).map(tZ);try{await ua(e,t)}catch(e){throw Error(`${e.message} (Android Key)`,{cause:e})}if(s.length>0&&0>s.indexOf(t[0]))throw Error("x5c root certificate was not a known root certificate (Android Key)")}return uf({signature:l,data:tY.concat([t,r]),x509Certificate:a[0],hashAlgorithm:c})}var tY=tY;async function pt(e){let{attStmt:t,authData:r,clientDataHash:i,credentialPublicKey:n,rootCertificates:o}=e,s=t.get("x5c");if(!s)throw Error("No attestation certificate provided in attestation statement (Apple)");try{await ua(s.map(tZ),o)}catch(e){throw Error(`${e.message} (Apple)`)}let{extensions:a,subjectPublicKeyInfo:l}=ne.parse(s[0],oT).tbsCertificate;if(!a)throw Error("credCert missing extensions (Apple)");let c=a.find(e=>"1.2.840.113635.100.8.2"===e.extnID);if(!c)throw Error('credCert missing "1.2.840.113635.100.8.2" extension (Apple)');let u=tY.concat([r,i]),p=await us(u),h=new Uint8Array(c.extnValue.buffer).slice(6);if(!tY.areEqual(p,h))throw Error("credCert nonce was not expected value (Apple)");let f=t1(n),d=new Uint8Array(l.subjectPublicKey);if(!tY.areEqual(f,d))throw Error("Credential public key does not equal credCert public key (Apple)");return!0}async function pr(e){let t,{response:r,expectedChallenge:i,expectedOrigin:n,expectedRPID:o,expectedType:s,requireUserPresence:a=!0,requireUserVerification:l=!0,supportedAlgorithmIDs:c=ub,attestationSafetyNetEnforceCTSCheck:u=!0}=e,{id:p,rawId:h,type:f,response:d}=r;if(!p)throw Error("Missing credential ID");if(p!==h)throw Error("Credential ID was not base64url-encoded");if("public-key"!==f)throw Error(`Unexpected credential type ${f}, expected "public-key"`);let y=t4(d.clientDataJSON),{type:g,origin:v,challenge:m,tokenBinding:w}=y;if(Array.isArray(s)){if(!s.includes(g)){let e=s.join(", ");throw Error(`Unexpected registration response type "${g}", expected one of: ${e}`)}}else if(s){if(g!==s)throw Error(`Unexpected registration response type "${g}", expected "${s}"`)}else if("webauthn.create"!==g)throw Error(`Unexpected registration response type: ${g}`);if("function"==typeof i){if(!await i(m))throw Error(`Custom challenge verifier returned false for registration response challenge "${m}"`)}else if(m!==i)throw Error(`Unexpected registration response challenge "${m}", expected "${i}"`);if(Array.isArray(n)){if(!n.includes(v))throw Error(`Unexpected registration response origin "${v}", expected one of: ${n.join(", ")}`)}else if(v!==n)throw Error(`Unexpected registration response origin "${v}", expected "${n}"`);if(w){if("object"!=typeof w)throw Error(`Unexpected value for TokenBinding "${w}"`);if(0>["present","supported","not-supported"].indexOf(w.status))throw Error(`Unexpected tokenBinding.status value of "${w.status}"`)}let A=tV.toBuffer(d.attestationObject),b=t2(t0.decodeFirst(A)),S=b.get("fmt"),E=b.get("authData"),B=b.get("attStmt"),{aaguid:x,rpIdHash:C,flags:k,credentialID:I,counter:T,credentialPublicKey:O,extensionsData:N}=un(E);if(o){let e=[];e="string"==typeof o?[o]:o,t=await uk(C,e)}if(a&&!k.up)throw Error("User presence was required, but user was not present");if(l&&!k.uv)throw Error("User verification was required, but user could not be verified");if(!I)throw Error("No credential ID was provided by authenticator");if(!O)throw Error("No public key was provided by authenticator");if(!x)throw Error("No AAGUID was present during registration");let M=t5(O).get(eu.alg);if("number"!=typeof M)throw Error("Credential public key was missing numeric alg");if(!c.includes(M)){let e=c.join(", ");throw Error(`Unexpected public key alg "${M}", expected one of "${e}"`)}let U={aaguid:x,attStmt:B,authData:E,clientDataHash:await us(tV.toBuffer(d.clientDataJSON)),credentialID:I,credentialPublicKey:O,rootCertificates:uR.getRootCertificates({identifier:S}),rpIdHash:C,attestationSafetyNetEnforceCTSCheck:u},P=!1;if("fido-u2f"===S)P=await uj(U);else if("packed"===S)P=await u$(U);else if("android-safetynet"===S)P=await uW(U);else if("android-key"===S)P=await pe(U);else if("tpm"===S)P=await uX(U);else if("apple"===S)P=await pt(U);else if("none"===S){if(B.size>0)throw Error("None attestation had unexpected attestation statement");P=!0}else throw Error(`Unsupported Attestation Format: ${S}`);if(!P)return{verified:!1};let{credentialDeviceType:D,credentialBackedUp:R}=ux(k);return{verified:!0,registrationInfo:{fmt:S,aaguid:tX(x),credentialType:f,credential:{id:tV.fromBuffer(I),publicKey:O,counter:T,transports:r.response.transports},attestationObject:A,userVerified:k.uv,credentialDeviceType:D,credentialBackedUp:R,origin:y.origin,rpID:t,authenticatorExtensionResults:N}}}var tV=tV,tY=tY;async function pi(e){let{allowCredentials:t,challenge:r=await uw(),timeout:i=6e4,userVerification:n="preferred",extensions:o,rpID:s}=e,a=r;return"string"==typeof a&&(a=tY.fromUTF8String(a)),{rpId:s,challenge:tV.fromBuffer(a),allowCredentials:t?.map(e=>{if(!tV.isBase64URL(e.id))throw Error(`allowCredential id "${e.id}" is not a valid base64url string`);return{...e,id:tV.trimPadding(e.id),type:"public-key"}}),timeout:i,userVerification:n,extensions:o}}var tV=tV,tY=tY;async function pn(e){let{response:t,expectedChallenge:r,expectedOrigin:i,expectedRPID:n,expectedType:o,credential:s,requireUserVerification:a=!0,advancedFIDOConfig:l}=e,{id:c,rawId:u,type:p,response:h}=t;if(!c)throw Error("Missing credential ID");if(c!==u)throw Error("Credential ID was not base64url-encoded");if("public-key"!==p)throw Error(`Unexpected credential type ${p}, expected "public-key"`);if(!t)throw Error("Credential missing response");if("string"!=typeof h?.clientDataJSON)throw Error("Credential response clientDataJSON was not a string");let f=t4(h.clientDataJSON),{type:d,origin:y,challenge:g,tokenBinding:v}=f;if(Array.isArray(o)){if(!o.includes(d)){let e=o.join(", ");throw Error(`Unexpected authentication response type "${d}", expected one of: ${e}`)}}else if(o){if(d!==o)throw Error(`Unexpected authentication response type "${d}", expected "${o}"`)}else if("webauthn.get"!==d)throw Error(`Unexpected authentication response type: ${d}`);if("function"==typeof r){if(!await r(g))throw Error(`Custom challenge verifier returned false for registration response challenge "${g}"`)}else if(g!==r)throw Error(`Unexpected authentication response challenge "${g}", expected "${r}"`);if(Array.isArray(i)){if(!i.includes(y)){let e=i.join(", ");throw Error(`Unexpected authentication response origin "${y}", expected one of: ${e}`)}}else if(y!==i)throw Error(`Unexpected authentication response origin "${y}", expected "${i}"`);if(!tV.isBase64URL(h.authenticatorData))throw Error("Credential response authenticatorData was not a base64url string");if(!tV.isBase64URL(h.signature))throw Error("Credential response signature was not a base64url string");if(h.userHandle&&"string"!=typeof h.userHandle)throw Error("Credential response userHandle was not a string");if(v){if("object"!=typeof v)throw Error("ClientDataJSON tokenBinding was not an object");if(0>["present","supported","notSupported"].indexOf(v.status))throw Error(`Unexpected tokenBinding status ${v.status}`)}let m=tV.toBuffer(h.authenticatorData),{rpIdHash:w,flags:A,counter:b,extensionsData:S}=un(m),E=[];E="string"==typeof n?[n]:n;let B=await uk(w,E);if(void 0!==l){let{userVerification:e}=l;if("required"===e&&!A.uv)throw Error("User verification required, but user could not be verified")}else{if(!A.up)throw Error("User not present during authentication");if(a&&!A.uv)throw Error("User verification required, but user could not be verified")}let x=await us(tV.toBuffer(h.clientDataJSON)),C=tY.concat([m,x]),k=tV.toBuffer(h.signature);if((b>0||s.counter>0)&&b<=s.counter)throw Error(`Response counter value ${b} was lower than expected ${s.counter}`);let{credentialDeviceType:I,credentialBackedUp:T}=ux(A);return{verified:await uf({signature:k,data:C,credentialPublicKey:s.publicKey}),authenticationInfo:{newCounter:b,credentialID:s.id,userVerified:A.uv,credentialDeviceType:I,credentialBackedUp:T,authenticatorExtensionResults:S,origin:f.origin,rpID:B}}}var po=e.i(803258);function ps(e){return Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function pa(){let e=(process.env.WEBAUTHN_ORIGIN??(0,po.getPublicBaseUrlOrigin)()).trim();return{rpName:(process.env.WEBAUTHN_RP_NAME??"Coinwaka").trim()||"Coinwaka",rpId:(process.env.WEBAUTHN_RP_ID??function(e){try{let t=new URL(e).hostname;if("localhost"===t)return t;return t.startsWith("www.")?t.slice(4):t}catch{return"localhost"}}(e)).trim(),origin:e}}async function pl(e){let{rpName:t,rpId:r}=pa();return await uB({rpName:t,rpID:r,userID:function(e){let t=e.replace(/-/g,"").toLowerCase();if(!/^[0-9a-f]{32}$/.test(t)){let t=new TextEncoder().encode(e);return new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength))}let r=new Uint8Array(new ArrayBuffer(16));for(let e=0;e<16;e++)r[e]=parseInt(t.slice(2*e,2*e+2),16);return r}(e.userId),userName:e.userName,userDisplayName:e.userDisplayName,attestationType:"none",authenticatorSelection:{residentKey:"preferred",userVerification:"required"},supportedAlgorithmIDs:[-7,-257],excludeCredentials:e.excludeCredentialIds.map(e=>({id:ps(e)}))})}async function pc(e){let{rpId:t,origin:r}=pa();return await pr({response:e.response,expectedChallenge:e.expectedChallenge,expectedOrigin:r,expectedRPID:t,requireUserVerification:!0})}async function pu(e){let{rpId:t}=pa();return await pi({rpID:t,userVerification:"required",allowCredentials:e.allowCredentialIds.map(e=>({id:ps(e)}))})}async function pp(e){let{rpId:t,origin:r}=pa(),i={id:e.credential.id,publicKey:new Uint8Array(e.credential.publicKey),counter:e.credential.counter};return await pn({response:e.response,expectedChallenge:e.expectedChallenge,expectedOrigin:r,expectedRPID:t,requireUserVerification:!0,credential:i})}e.s(["createAuthenticationOptions",()=>pu,"createRegistrationOptions",()=>pl,"verifyAuthentication",()=>pp,"verifyRegistration",()=>pc],558504)}];

//# sourceMappingURL=_00eca53a._.js.map