module.exports=[324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},522734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},446786,(e,t,r)=>{t.exports=e.x("os",()=>require("os"))},504446,(e,t,r)=>{t.exports=e.x("net",()=>require("net"))},755004,(e,t,r)=>{t.exports=e.x("tls",()=>require("tls"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},60438,(e,t,r)=>{t.exports=e.x("perf_hooks",()=>require("perf_hooks"))},300959,e=>{"use strict";var t=e.i(915874);function r(e,t){let r=t?.status??function(e){switch(e){case"missing_x_user_id":case"missing_user_id":case"reviewer_key_invalid":case"session_bootstrap_key_invalid":case"admin_key_invalid":case"session_token_expired":return 401;case"not_party":case"opened_by_not_party":case"x_user_id_mismatch":case"actor_not_allowed":case"withdrawal_address_not_allowlisted":case"email_not_verified":case"kyc_required_for_asset":case"withdrawal_requires_kyc":case"withdrawal_allowlist_cooldown":case"totp_setup_required":case"stepup_required":case"user_not_active":case"buyer_not_active":case"seller_not_active":case"p2p_country_not_supported":case"arcade_key_required":case"gas_disabled":case"cannot_trade_own_ad":return 403;case"not_found":case"recipient_not_found":case"trade_not_found":case"dispute_not_found":case"user_not_found":case"market_not_found":case"order_not_found":case"ad_not_found":case"transfer_not_found":return 404;case"trade_not_disputable":case"trade_not_disputed":case"trade_not_resolvable":case"dispute_not_open":case"dispute_already_exists":case"dispute_transition_not_allowed":case"trade_transition_not_allowed":case"trade_not_cancelable":case"trade_state_conflict":case"insufficient_balance":case"recipient_inactive":case"recipient_same_as_sender":case"transfer_not_reversible":case"transfer_already_reversed":case"recipient_insufficient_balance_for_reversal":case"seller_insufficient_funds":case"insufficient_liquidity_on_ad":case"seller_payment_details_missing":case"order_state_conflict":case"market_disabled":case"withdrawal_risk_blocked":case"ad_is_not_online":case"p2p_open_orders_limit":case"post_only_would_take":case"fok_insufficient_liquidity":case"idempotency_key_conflict":case"open_orders_limit":case"order_notional_too_large":case"exchange_price_out_of_band":case"market_halted":case"stp_cancel_newest":case"stp_cancel_both":case"passkey_not_configured":case"insufficient_gas":return 409;case"gas_asset_not_found":case"gas_fee_invalid":case"reviewer_key_not_configured":case"session_secret_not_configured":case"session_bootstrap_not_configured":case"admin_key_not_configured":case"internal_error":return 500;case"rate_limit_exceeded":case"p2p_order_create_cooldown":return 429;case"invalid_input":case"price_not_multiple_of_tick":case"quantity_not_multiple_of_lot":case"unsupported_version":case"missing_file":case"invalid_metadata_json":case"buyer_not_found":case"seller_not_found":case"seller_payment_method_required":case"invalid_seller_payment_method":case"webauthn_verification_failed":default:return 400;case"upstream_unavailable":return 503}}(e),s={error:e};"string"==typeof t?.details?(s.message=t.details,s.details=t.details):"object"==typeof t?.details&&t?.details!==null&&(s.details=t.details,"message"in t.details&&(s.message=t.details.message));let n=t?.headers?new Headers(t.headers):new Headers;return"upstream_unavailable"!==e||n.has("Retry-After")||n.set("Retry-After","3"),Response.json(s,{status:r,headers:n})}function s(e){return e instanceof t.ZodError?r("invalid_input",{status:400,details:e.issues}):null}function n(e,t){return r("upstream_unavailable",{status:503,details:e,headers:"number"==typeof t?.retryAfterSeconds?{"Retry-After":String(Math.max(0,Math.floor(t.retryAfterSeconds)))}:void 0})}e.s(["apiError",()=>r,"apiUpstreamUnavailable",()=>n,"apiZodError",()=>s])},184883,e=>{"use strict";var t=e.i(300959);function r(e){let t=((function(e){if(e&&"object"==typeof e)return"string"==typeof e.code?e.code:void 0})(e)??"").toUpperCase(),r=e&&"object"==typeof e&&"string"==typeof e.message?e.message:String(e),s=new Set(["CONNECTION_CLOSED","CONNECTION_ENDED","CONNECTION_DESTROYED","ECONNRESET","ETIMEDOUT","EPIPE","ENOTFOUND"]);if(t&&s.has(t))return!0;let n=new Set(["08000","08003","08006","08001","08004","57P01","57P02","57P03","53300"]);return!!(t&&n.has(t)||/CONNECTION_CLOSED|connection\s+terminated|terminating\s+connection|socket\s+hang\s+up|ECONNRESET|EPIPE/i.test(r))}async function s(e,t){try{return await e()}catch(n){var s;if(!r(n))throw n;return await (s=t?.delayMs??50,new Promise(e=>setTimeout(e,s))),await e()}}function n(e,s){return r(s)?(0,t.apiUpstreamUnavailable)({dependency:"db",op:e},{retryAfterSeconds:3}):null}e.s(["isTransientDbError",()=>r,"responseForDbError",()=>n,"retryOnceOnTransientDbError",()=>s])},666680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},691180,e=>{"use strict";var t=e.i(666680);let r="pp_session";function s(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")}function n(e,r){return s((0,t.createHmac)("sha256",e).update(r,"utf8").digest())}function a(e){if(!e)return{};let t={};for(let r of e.split(/;\s*/g)){let e=r.indexOf("=");if(e<=0)continue;let s=r.slice(0,e).trim(),n=r.slice(e+1).trim();s&&(t[s]=decodeURIComponent(n))}return t}function i(e){return a(e.headers.get("cookie"))[r]??null}function o(e){let t=Math.floor((e.now??Date.now())/1e3),r="number"==typeof e.ttlSeconds?e.ttlSeconds:604800,a={uid:e.userId,iat:t,exp:t+r,..."number"==typeof e.sessionVersion&&Number.isFinite(e.sessionVersion)?{sv:Math.max(0,Math.trunc(e.sessionVersion))}:{}},i=s(Buffer.from(JSON.stringify(a),"utf8")),o=n(e.secret,i);return`${i}.${o}`}function l(e){let r,s=e.token.trim(),a=s.indexOf(".");if(a<=0)return{ok:!1,error:"session_token_invalid"};let i=s.slice(0,a),o=s.slice(a+1);if(!i||!o)return{ok:!1,error:"session_token_invalid"};let l=n(e.secret,i),c=Buffer.from(o),u=Buffer.from(l);if(c.length!==u.length||!(0,t.timingSafeEqual)(c,u))return{ok:!1,error:"session_token_invalid"};try{let e,t;r=JSON.parse((e=i.length%4,t=(i+(e?"=".repeat(4-e):"")).replace(/-/g,"+").replace(/_/g,"/"),Buffer.from(t,"base64")).toString("utf8"))}catch{return{ok:!1,error:"session_token_invalid"}}if(!r||"object"!=typeof r||"string"!=typeof r.uid||!r.uid||"number"!=typeof r.exp||!Number.isFinite(r.exp))return{ok:!1,error:"session_token_invalid"};if(null!=r.sv){let e=Number(r.sv);if(!Number.isFinite(e)||e<0)return{ok:!1,error:"session_token_invalid"};r.sv=Math.max(0,Math.trunc(e))}let _=Math.floor((e.now??Date.now())/1e3);return r.exp<=_?{ok:!1,error:"session_token_expired"}:{ok:!0,payload:r}}function c(e){let t=[`${r}=${encodeURIComponent(e.token)}`,"Path=/","HttpOnly","SameSite=Lax",`Max-Age=${Math.max(0,Math.floor(e.maxAgeSeconds))}`];return e.secure&&t.push("Secure"),t.join("; ")}function u(e){let t=[`${r}=`,"Path=/","HttpOnly","SameSite=Lax","Max-Age=0"];return e?.secure&&t.push("Secure"),t.join("; ")}e.s(["createSessionToken",()=>o,"getSessionTokenFromRequest",()=>i,"parseCookieHeader",()=>a,"serializeClearSessionCookie",()=>u,"serializeSessionCookie",()=>c,"verifySessionToken",()=>l])},977775,e=>{"use strict";var t=e.i(691180);function r(e){let r=process.env.PROOFPACK_SESSION_SECRET??"";if(r){let s=(0,t.getSessionTokenFromRequest)(e);if(s){let e=(0,t.verifySessionToken)({token:s,secret:r});if(e.ok)return e.payload.uid}}else if(1)return console.error("[FATAL] PROOFPACK_SESSION_SECRET is not set in production!"),null;let s=process.env.INTERNAL_SERVICE_SECRET;if(s){let t=e.headers.get("x-internal-service-token");if(t&&t===s){let t=e.headers.get("x-user-id");if(t)return t}}return null}function s(e){return e?null:"missing_x_user_id"}function n(e,t){return!!e&&(e===t.buyer_user_id||e===t.seller_user_id)}e.s(["getActingUserId",()=>r,"isParty",()=>n,"requireActingUserIdInProd",()=>s])},364608,e=>{"use strict";async function t(e,t){if(!t)return null;let r=await e`
    SELECT status
    FROM app_user
    WHERE id = ${t}
    LIMIT 1
  `;return 0===r.length?"user_not_found":"active"!==r[0].status?"user_not_active":null}e.s(["requireActiveUser",()=>t])},406461,(e,t,r)=>{t.exports=e.x("zlib",()=>require("zlib"))},524836,(e,t,r)=>{t.exports=e.x("https",()=>require("https"))},921517,(e,t,r)=>{t.exports=e.x("http",()=>require("http"))},792509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},427699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},136799,e=>{"use strict";var t=e.i(29984);function r(e,t,r){return Math.min(r,Math.max(t,e))}function s(e){let t="number"==typeof e?e:"string"==typeof e?Number(e):NaN;return Number.isFinite(t)?t:null}function n(e){return e.trim().toUpperCase()}let a=["binance","bybit","okx","kucoin","gateio","bitget","mexc"],i=new Map;async function o(e,t,r){let s=0,n=Array.from({length:Math.min(Math.max(1,Math.floor(t)),e.length)},async()=>{for(;;){let t=s++;if(t>=e.length)return;await r(e[t])}});await Promise.allSettled(n)}async function l(e){var l;let c,u,_,d,p,f,m=n(e);if(!m||"USDT"===m)return null;let h=`${n(m)}USDT`,x=i.get(h);if(x&&x.validUntil.getTime()>Date.now())return x;let g=function(){let e=process.env.MARKETS_INDEX_EXCHANGES;if(!e)return a;let t=new Set(a),r=e.split(/[\n,]/g).map(e=>e.trim().toLowerCase()).filter(Boolean).filter(e=>t.has(e)),s=[],n=new Set;for(let e of r)n.has(e)||(n.add(e),s.push(e));return s.length?s:a}(),b=[],y=r(Number.isFinite(u=(c=process.env.MARKETS_INDEX_TICKER_TIMEOUT_MS??process.env.CCXT_TICKER_TIMEOUT_MS)?Number(c):NaN)?u:3500,500,2e4);await o(g,r(Number.isFinite(d=(_=process.env.MARKETS_INDEX_CONCURRENCY)?Number(_):NaN)?d:4,1,10),async e=>{try{let r=await Promise.race([(0,t.getExchangeTicker)(e,h),new Promise((t,r)=>setTimeout(()=>r(Error(`timeout:getExchangeTicker:${e}`)),y))]),n=s(r.bid),a=s(r.ask),i=s(r.last),o=n&&a?(n+a)/2:i;b.push({exchange:e,symbol:h,bid:n,ask:a,last:i,mid:o,ts:r.ts})}catch(t){b.push({exchange:e,symbol:h,bid:null,ask:null,last:null,mid:null,ts:Date.now(),error:t instanceof Error?t.message:String(t)})}});let E=b.map(e=>e.mid).filter(e=>"number"==typeof e&&Number.isFinite(e)&&e>0),S=function(e){if(!e.length)return null;let t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2==1?t[r]:(t[r-1]+t[r])/2}(E);if(!S)return null;let N=new Date,v={base:m,quote:"USDT",symbol:h,mid:S,sources:b,sourcesUsed:E.length,dispersionBps:function(e,t){if(e.length<3)return null;let r=[...e].sort((e,t)=>e-t),s=r[Math.floor((r.length-1)*.1)],n=r[Math.floor((r.length-1)*.9)];return!Number.isFinite(t)||t<=0?null:(n-s)/t*1e4}(E,S),computedAt:N,validUntil:(l=r(Number.isFinite(f=(p=process.env.MARKETS_INDEX_TTL_MS)?Number(p):NaN)?f:15e3,2e3,12e4),new Date(Date.now()+l))};return i.set(h,v),v}e.s(["getExternalIndexUsdt",()=>l])},844297,e=>{"use strict";var t=e.i(666680);function r(){let e=process.env.PROOFPACK_SESSION_SECRET;if(!e||e.length<32)throw Error("PROOFPACK_SESSION_SECRET must be at least 32 chars for credential encryption");return Buffer.from(e,"utf-8").subarray(0,32)}function s(e){let s=r(),n=(0,t.randomBytes)(12),a=(0,t.createCipheriv)("aes-256-gcm",s,n),i=a.update(e,"utf8","hex");i+=a.final("hex");let o=a.getAuthTag().toString("hex");return`${n.toString("hex")}:${i}:${o}`}function n(e){let s=r(),n=e.split(":");if(3!==n.length)throw Error("Invalid encrypted credential format");let[a,i,o]=n,l=Buffer.from(a,"hex"),c=Buffer.from(o,"hex"),u=(0,t.createDecipheriv)("aes-256-gcm",s,l);u.setAuthTag(c);let _=u.update(i,"hex","utf8");return _+u.final("utf8")}e.s(["decryptCredential",()=>n,"encryptCredential",()=>s])},6597,e=>{"use strict";var t=e.i(29984);let r=["binance","bybit","okx","kucoin","gateio","bitget","mexc"],s=function(e,t){let r=process.env[e];if(!r)return t;let s=[],n=new Set;for(let e of r.split(/[\n,]/g)){let t=e.trim();if(!t)continue;let r=t.replace(/[^a-zA-Z0-9]/g,"").toUpperCase();/^[A-Z0-9]{6,30}$/.test(r)&&(n.has(r)||(n.add(r),s.push(r)))}return s.length?s:t}("ARB_SYMBOLS",["BTCUSDT","ETHUSDT","BNBUSDT","SOLUSDT","XRPUSDT","ADAUSDT","DOGEUSDT","TRXUSDT","LINKUSDT","AVAXUSDT","TONUSDT","MATICUSDT"]),n=function(e,t){let s=process.env[e];if(!s)return t;let n=new Set(r),a=s.split(/[\n,]/g).map(e=>e.trim().toLowerCase()).filter(Boolean).filter(e=>n.has(e)),i=[],o=new Set;for(let e of a)o.has(e)||(o.add(e),i.push(e));return i.length?i:t}("ARB_EXCHANGES",r),a=new Set(function(e,t){let r=process.env[e];if(!r)return t;let s=r.split(/[\n,]/g).map(e=>e.trim().toLowerCase()).filter(Boolean);return s.length?s:t}("ARB_OPP_EXCHANGES",["binance","bybit"])),i="1"===process.env.ARB_INCLUDE_INTERNAL;function o(){return{exchanges:[...n],oppExchanges:Array.from(a),includeInternal:i,symbols:[...s]}}function l(e,t){let r=process.env[e],s=r?Number(r):NaN;return Number.isFinite(s)?s:t}async function c(e,t,r){let s=0,n=Array.from({length:Math.min(Math.max(1,Math.floor(t)),e.length)},async()=>{for(;;){let t=s++;if(t>=e.length)return;await r(e[t])}});await Promise.allSettled(n)}async function u(e,r){let a=[],i=[],o=(r&&"exchanges"in r?r.exchanges:void 0)??n,u=(r&&"symbols"in r?r.symbols:void 0)??s,_=r?.includeInternalPrices??!0,d=r?.storeSnapshots??!0,p=[];for(let e of o){let r=Math.max(1,Math.floor(l("ARB_CONCURRENCY",4))),s=Math.max(1,Math.floor(l("ARB_BYBIT_CONCURRENCY",6))),n="bybit"===e?Math.min(s,u.length):Math.min(r,u.length);p.push((async()=>{await c(u,n,async r=>{try{let s=await (0,t.getExchangeTicker)(e,r),n=Number.parseFloat(s.bid),i=Number.parseFloat(s.ask);if(!Number.isFinite(n)||!Number.isFinite(i)||n<=0||i<=0)return;a.push({symbol:r,exchange:e,bid:s.bid,ask:s.ask,ts:new Date})}catch(t){i.push({exchange:e,symbol:r,message:t instanceof Error?t.message:String(t)})}})})())}return _&&p.push((async()=>{try{for(let t of(await e`
            WITH stats AS (
              SELECT
                m.symbol,
                MAX(CASE WHEN o.side = 'buy' THEN o.price ELSE 0 END) as bid,
                MIN(CASE WHEN o.side = 'sell' THEN o.price ELSE NULL END) as ask
              FROM ex_order o
              JOIN ex_market m ON m.id = o.market_id
              WHERE o.status IN ('open', 'partially_filled')
              GROUP BY m.symbol
            )
            SELECT symbol, bid::text, ask::text FROM stats
          `)){let e=String(t.symbol).replace("/",""),r=Number.parseFloat(t.bid??"0"),s=Number.parseFloat(t.ask??"0");Number.isFinite(r)&&Number.isFinite(s)&&!(r<=0)&&!(s<=0)&&a.push({symbol:e,exchange:"tradesynapse",bid:String(r),ask:String(s),ts:new Date})}}catch(e){console.error("Failed to fetch local prices",e)}})()),await Promise.allSettled(p),d&&a.length>0&&await e`
      INSERT INTO arb_price_snapshot ${e(a.map(e=>({symbol:e.symbol,exchange:e.exchange,bid:e.bid,ask:e.ask,ts:e.ts})))}
    `,{snapshots:a,errors:i}}function _(e,t={}){let r,s,n=[],o=Number.isFinite(s=(r=process.env.ARB_MIN_SPREAD_PCT)?Number(r):NaN)?s:.001,c=(2*Math.max(0,l("ARB_TAKER_FEE_BPS",10))+2*Math.max(0,l("ARB_SLIPPAGE_BPS",2))+Math.max(0,l("ARB_TRANSFER_BPS",0))+Math.max(0,l("ARB_LATENCY_BPS",2)))/100,u=t.minNetSpread??Math.max(0,l("ARB_MIN_NET_SPREAD_PCT",0)),d=t.includeInternal??i,p=new Set(Array.isArray(t.oppExchanges)&&t.oppExchanges.length?t.oppExchanges.map(e=>String(e).toLowerCase()):Array.from(a)),f=(t.quoteSuffix??"USDT").toUpperCase(),m=new Map;for(let t of e){let e=m.get(t.symbol)??[];e.push(t),m.set(t.symbol,e)}for(let[e,t]of m){if(t.length<2||!e.toUpperCase().endsWith(f))continue;let r=t.filter(e=>{let t=String(e.exchange).toLowerCase();return"tradesynapse"===t?d:p.has(t)});if(!(r.length<2))for(let t=0;t<r.length;t++)for(let s=0;s<r.length;s++){if(t===s)continue;let a=r[t],i=r[s];if(a.exchange===i.exchange)continue;let l=parseFloat(a.ask),_=parseFloat(i.bid);if(_<=l||l<=0)continue;let d=(_-l)/l*100,p=d-c;if(d<o||!Number.isFinite(p)||p<u)continue;let f=d/100*1e3,m=p/100*1e3;n.push({symbol:e,buyExchange:a.exchange,sellExchange:i.exchange,buyAsk:l,sellBid:_,spreadPct:Math.round(1e4*d)/1e4,potentialProfit:Math.round(100*f)/100,netSpreadPct:Math.round(1e4*p)/1e4,netProfit:Math.round(100*m)/100,ts:new Date})}}return n.sort((e,t)=>t.spreadPct-e.spreadPct),n}async function d(e,t,r=1){return(t?await e`
        SELECT symbol, exchange, bid::text, ask::text, ts
        FROM arb_price_snapshot
        WHERE symbol = ${t}
          AND ts > now() - interval '1 hour' * ${r}
        ORDER BY ts DESC
        LIMIT 500
      `:await e`
        SELECT symbol, exchange, bid::text, ask::text, ts
        FROM arb_price_snapshot
        WHERE ts > now() - interval '1 hour' * ${r}
        ORDER BY ts DESC
        LIMIT 500
      `).map(e=>({symbol:e.symbol,exchange:e.exchange,bid:e.bid,ask:e.ask,ts:new Date(e.ts)}))}async function p(e,t){return(await e`
    SELECT DISTINCT ON (exchange) symbol, exchange, bid::text, ask::text, ts
    FROM arb_price_snapshot
    WHERE symbol = ${t}
      AND ts > now() - interval '5 minutes'
    ORDER BY exchange, ts DESC
  `).map(e=>({symbol:e.symbol,exchange:e.exchange,bid:e.bid,ask:e.ask,ts:new Date(e.ts)}))}e.s(["captureArbSnapshots",()=>u,"detectOpportunities",()=>_,"getArbScannerConfig",()=>o,"getLatestPricesBySymbol",()=>p,"getRecentSnapshots",()=>d])},813311,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_b5e82bad._.js"].map(t=>e.l(t))).then(()=>t(429194)))},850875,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_b5e82bad._.js","server/chunks/node_modules_ccxt_js_src_protobuf_mexc_compiled_cjs_a75143f3._.js"].map(t=>e.l(t))).then(()=>t(433054)))},607967,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_ccxt_js_src_static_dependencies_dydx-v4-client_91e8f96f._.js","server/chunks/node_modules_ccxt_js_src_static_dependencies_dydx-v4-client_registry_4a78b30a.js","server/chunks/node_modules_b5e82bad._.js"].map(t=>e.l(t))).then(()=>t(533718)))},552032,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_ccxt_js_src_static_dependencies_dydx-v4-client_5a3bd954._.js","server/chunks/node_modules_b5e82bad._.js"].map(t=>e.l(t))).then(()=>t(989929)))},348464,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_ccxt_js_src_static_dependencies_dydx-v4-client_8cedd7e0._.js","server/chunks/node_modules_b5e82bad._.js"].map(t=>e.l(t))).then(()=>t(662700)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__031dba79._.js.map