module.exports=[459056,e=>{"use strict";var t=e.i(747909),i=e.i(174017),r=e.i(996250),a=e.i(759756),n=e.i(561916),o=e.i(174677),s=e.i(869741),d=e.i(316795),l=e.i(487718),c=e.i(995169),u=e.i(47587),p=e.i(666012),h=e.i(570101),m=e.i(626937),f=e.i(10372),v=e.i(193695);e.i(52474);var _=e.i(600220),g=e.i(469719),y=e.i(300959),k=e.i(843793),w=e.i(184883),E=e.i(977775),R=e.i(720290);let b={low:[{weight:9300,value:"common"},{weight:650,value:"rare"},{weight:45,value:"epic"},{weight:5,value:"legendary"}],medium:[{weight:8800,value:"common"},{weight:1e3,value:"rare"},{weight:170,value:"epic"},{weight:30,value:"legendary"}],high:[{weight:8e3,value:"common"},{weight:1400,value:"rare"},{weight:430,value:"epic"},{weight:170,value:"legendary"}]},x=[{topic:"liquidity",titles:["Liquidity Lens","Depth Snapshot","Spread Check"],lines:["Tighter spreads usually reflect stronger two-sided interest.","Watch how depth changes near round-number prices.","Sudden thin books can amplify slippage on market orders."]},{topic:"risk",titles:["Risk Posture","Volatility Note","Drawdown Reminder"],lines:["Size positions so a bad day is survivable.","Avoid stacking correlated bets when volatility rises.","Define exit conditions before you enter."]},{topic:"execution",titles:["Execution Tip","Order Hygiene","Fee Awareness"],lines:["Limit orders can reduce fees and slippage, but may not fill.","Large orders can be split to reduce footprint.","Check fee tiers and routes before executing."]},{topic:"p2p",titles:["P2P Safety","Counterparty Check","Dispute Prep"],lines:["Keep chat and payment evidence organized.","Prefer counterparties with consistent history.","Never send funds outside agreed rails."]}],T=[{topic:"token_safety",title:"Token Verification Checklist",bullets:["Verify contract address from multiple independent sources.","Check contract is verified on explorer and read key functions.","Review liquidity depth and whether liquidity is locked (if applicable).","Confirm transfer restrictions / taxes are disclosed and bounded.","Avoid copycat tickers: compare full address, not name/symbol."],tags:["safety","tokens","verification"]},{topic:"p2p",title:"P2P Trade Safety Checklist",bullets:["Keep all communication inside the platform chat.","Capture payment proof and timestamps (screenshots/receipts).","Never accept pressure to move to external rails.","If something feels off: pause and open a dispute early.","Double-check amounts and names before releasing escrow."],tags:["p2p","safety"]},{topic:"execution",title:"Execution Discipline Checklist",bullets:["Prefer limit orders when spread is wide.","Split larger orders (TWAP/ladder) to reduce footprint.","Set invalidation levels before entry (not after).","Avoid chasing: if price runs, reassess instead of FOMO.","Track fees and slippage; they compound over time."],tags:["execution","discipline"]}],A=[{topic:"risk",title:"Risk Playbook: Survive Volatility",md:"### Risk Playbook\n- Size so a worst-case day is survivable.\n- Reduce correlation: avoid stacking similar bets.\n- Predefine exits: invalidation > hope.\n- Use holds/limits to avoid emotional overtrading.\n\n### Red flags\n- You can't explain why you're in the trade.\n- You're averaging down without a plan.\n- You're ignoring fees/slippage.",tags:["risk","volatility"]},{topic:"liquidity",title:"Liquidity Playbook: Read the Book",md:"### Liquidity Playbook\n- Wide spread + thin depth = slippage risk.\n- Watch round numbers for spoofing/icebergs.\n- If depth vanishes, switch to smaller slices.\n\n### Practical moves\n- Use limit orders near mid when possible.\n- Avoid market orders during sudden depth drops.",tags:["liquidity","execution"]}],C=[{topic:"analysis",title:"Reusable Trade Review Template",md:"## Trade Review (Template)\n**Context**: (market regime / news / liquidity)\n\n**Entry thesis**: (one sentence)\n- Evidence: \n- Invalidation: \n\n**Execution**:\n- Order type (limit/market/TWAP): \n- Size rationale: \n- Fees/slippage observed: \n\n**Outcome**:\n- What went right:\n- What went wrong:\n- Next improvement:",tags:["template","review","discipline"]},{topic:"security",title:"Security Incident Checklist (Template)",md:"## Security Incident Checklist (Template)\n- Freeze: stop sending funds; stop screen sharing.\n- Verify: confirm addresses and parties via trusted channels.\n- Document: screenshots, tx hashes, chat logs.\n- Contain: rotate passwords / enable 2FA / revoke sessions.\n- Escalate: open dispute/support ticket with evidence.",tags:["template","security","safety"]}];function S(e,t){let i=Math.max(1,t.length),r=Number(e%BigInt(i));return{picked:t[r]??t[0],idx:r,total:i}}function $(e){return(0,R.bytesToU64BigInt)(Buffer.from(e.slice(0,16),"hex"))}var I=e.i(796929),P=e.i(533821),H=e.i(60828),N=e.i(273278);let D=g.z.object({action_id:g.z.string().uuid(),client_seed:g.z.string().min(8).max(256)}),O="insight_pack";async function q(e){let t,i=(0,E.getActingUserId)(e),r=(0,E.requireActingUserIdInProd)(i);if(r)return(0,y.apiError)(r);if(!i)return(0,y.apiError)("missing_x_user_id");let a=await e.json().catch(()=>({}));try{t=D.parse(a)}catch(e){return(0,y.apiZodError)(e)??(0,y.apiError)("invalid_input")}let n=t.action_id,o=String(t.client_seed??"").trim(),s=(0,k.getSql)();try{let e=await (0,w.retryOnceOnTransientDbError)(async()=>await s.begin(async e=>{let t=await (0,I.enforceArcadeSafety)(e,{userId:i,module:O,shardSpend:20});if(!t.ok)return{kind:"err",err:(0,y.apiError)(t.error,{details:t.details})};let r=await e`
          SELECT
            id::text AS id,
            user_id::text AS user_id,
            module,
            profile,
            status,
            client_commit_hash,
            server_commit_hash,
            server_seed_b64,
            outcome_json
          FROM arcade_action
          WHERE id = ${n}::uuid
          LIMIT 1
          FOR UPDATE
        `;if(!r.length)return{kind:"err",err:(0,y.apiError)("not_found")};let a=r[0];if(a.user_id!==i)return{kind:"err",err:(0,y.apiError)("x_user_id_mismatch")};if(a.module!==O)return{kind:"err",err:(0,y.apiError)("invalid_input")};if("resolved"===a.status)return{kind:"ok",already:!0,outcome:a.outcome_json};if("committed"!==a.status)return{kind:"err",err:(0,y.apiError)("trade_state_conflict",{details:{status:a.status}})};let s=(0,R.sha256Hex)(o);if(!(0,R.isSha256Hex)(s)||s!==String(a.client_commit_hash??"").toLowerCase())return{kind:"err",err:(0,y.apiError)("invalid_input",{details:"client_seed does not match commit"})};if((0,R.sha256Hex)(`${a.server_seed_b64}:${a.client_commit_hash}:${a.module}:${a.profile}:${i}`)!==String(a.server_commit_hash??"").toLowerCase())return{kind:"err",err:(0,y.apiError)("internal_error",{details:"server_commit_mismatch"})};let d=await e`
          SELECT id::text AS id, quantity
          FROM arcade_inventory
          WHERE user_id = ${i}::uuid
            AND kind = ${P.SHARD_ITEM.kind}
            AND code = ${P.SHARD_ITEM.code}
            AND rarity = ${P.SHARD_ITEM.rarity}
          LIMIT 1
          FOR UPDATE
        `,l=Number(d[0]?.quantity??0);if(l<20)return{kind:"err",err:(0,y.apiError)("insufficient_balance",{details:{message:"Need 20 shards to open a pack."}})};let c=function(e){let t,i,r=(0,R.sha256Hex)(`${e.serverSeedB64}:${e.clientSeed}:${e.actionId}:${e.userId}:${e.module}:${e.profile}:${e.clientCommitHash}:rarity`),a=function(e,t){let i=t.reduce((e,t)=>e+t.weight,0),r=Number(e%BigInt(i)),a=0;for(let e of t)if(r<(a+=e.weight))return{picked:e.value,roll:r,total:i};return{picked:t[t.length-1].value,roll:r,total:i}}($(r),b[e.profile]??b.low),n=a.picked,o=(0,R.sha256Hex)(`${r}:topic:${n}`),s=S($(o),x),d=(0,R.sha256Hex)(`${o}:content`),l=$(d),c="legendary"===n?"template":"epic"===n?"playbook":"rare"===n?"checklist":"education",u="Insight",p="",h=s.picked.topic;if("education"===c){let e=(0,R.sha256Hex)(`${d}:title`),r=S($(e),s.picked.titles),a=S($((0,R.sha256Hex)(`${e}:line`)),s.picked.lines);u=r.picked,p=`${a.picked} (${s.picked.topic})`,t=void 0,i=[s.picked.topic]}else if("checklist"===c){let e=S(l,T);u=e.picked.title,h=e.picked.topic,i=e.picked.tags,p=`Checklist: ${e.picked.topic}`,t=[`## ${e.picked.title}`,...e.picked.bullets.map(e=>`- ${e}`)].join("\n")}else if("playbook"===c){let e=S(l,A);u=e.picked.title,h=e.picked.topic,i=e.picked.tags,p=`Playbook: ${e.picked.topic}`,t=e.picked.md}else{let e=S(l,C);u=e.picked.title,h=e.picked.topic,i=e.picked.tags,p=`Template: ${e.picked.topic}`,t=e.picked.md}let m=d.slice(0,10);return{outcome:{kind:"insight",code:`insight:${h}:${c}:${n}:${m}`,rarity:n,label:u,metadata:{kind:c,text:p,content_md:t,disclaimer:"Informational only. Not financial advice. Always verify independently.",topic:h,tags:i}},audit:{random_hash:d,rarity_roll:a.roll,rarity_total:a.total,topic_roll:s.idx,topic_total:s.total}}}({actionId:a.id,userId:i,module:a.module,profile:a.profile,serverSeedB64:a.server_seed_b64,clientSeed:o,clientCommitHash:a.client_commit_hash}),u=d[0].id,p=l-20;0===p?await e`DELETE FROM arcade_inventory WHERE id = ${u}::uuid`:await e`UPDATE arcade_inventory SET quantity = ${p}, updated_at = now() WHERE id = ${u}::uuid`,await (0,H.logArcadeConsumption)(e,{user_id:i,kind:P.SHARD_ITEM.kind,code:P.SHARD_ITEM.code,rarity:P.SHARD_ITEM.rarity,quantity:20,context_type:"insight_pack",context_id:a.id,module:O,metadata:{cost_shards:20}});let h={module:a.module,profile:a.profile,outcome:c.outcome,audit:{client_commit_hash:a.client_commit_hash,server_commit_hash:a.server_commit_hash,server_seed_b64:a.server_seed_b64,random_hash:c.audit.random_hash,rarity_roll:c.audit.rarity_roll,rarity_total:c.audit.rarity_total,topic_roll:c.audit.topic_roll,topic_total:c.audit.topic_total}};return await e`
          INSERT INTO arcade_inventory (user_id, kind, code, rarity, quantity, metadata_json, created_at, updated_at)
          VALUES (
            ${i}::uuid,
            ${c.outcome.kind},
            ${c.outcome.code},
            ${c.outcome.rarity},
            1,
            ${e.json({label:c.outcome.label,...c.outcome.metadata,source:O,action_id:a.id})},
            now(),
            now()
          )
          ON CONFLICT (user_id, kind, code, rarity)
          DO UPDATE SET quantity = arcade_inventory.quantity + 1, updated_at = now()
        `,await e`
          UPDATE arcade_action
          SET status = 'resolved',
              resolved_at = now(),
              reveal_json = ${e.json({client_seed_present:!0})},
              outcome_json = ${e.json(h)}
          WHERE id = ${a.id}::uuid
        `,await (0,N.addArcadeXp)(e,{userId:i,deltaXp:1,contextRandomHash:c.audit.random_hash,source:O}),{kind:"ok",already:!1,outcome:h}}));if("err"===e.kind)return e.err;return Response.json({ok:!0,action_id:n,already_resolved:e.already,result:e.outcome},{status:200})}catch(t){let e=(0,w.responseForDbError)("arcade_insight_reveal",t);if(e)return e;return(0,y.apiError)("internal_error")}}e.s(["POST",()=>q,"dynamic",0,"force-dynamic","runtime",0,"nodejs"],362085);var U=e.i(362085);let M=new t.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/arcade/insight/reveal/route",pathname:"/api/arcade/insight/reveal",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/arcade/insight/reveal/route.ts",nextConfigOutput:"",userland:U}),{workAsyncStorage:j,workUnitAsyncStorage:F,serverHooks:L}=M;function W(){return(0,r.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:F})}async function B(e,t,r){M.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let g="/api/arcade/insight/reveal/route";g=g.replace(/\/index$/,"")||"/";let y=await M.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:k,params:w,nextConfig:E,parsedUrl:R,isDraftMode:b,prerenderManifest:x,routerServerContext:T,isOnDemandRevalidate:A,revalidateOnlyGenerated:C,resolvedPathname:S,clientReferenceManifest:$,serverActionsManifest:I}=y,P=(0,s.normalizeAppPath)(g),H=!!(x.dynamicRoutes[P]||x.routes[S]),N=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,R,!1):t.end("This page could not be found"),null);if(H&&!b){let e=!!x.routes[S],t=x.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await N();throw new v.NoFallbackError}}let D=null;!H||M.isDev||b||(D="/index"===(D=S)?"/":D);let O=!0===M.isDev||!H,q=H&&!O;I&&$&&(0,o.setManifestsSingleton)({page:g,clientReferenceManifest:$,serverActionsManifest:I});let U=e.method||"GET",j=(0,n.getTracer)(),F=j.getActiveScopeSpan(),L={params:w,prerenderManifest:x,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:O,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,r,a)=>M.onRequestError(e,t,r,a,T)},sharedContext:{buildId:k}},W=new d.NodeNextRequest(e),B=new d.NodeNextResponse(t),K=l.NextRequestAdapter.fromNodeNextRequest(W,(0,l.signalFromNodeResponse)(t));try{let o=async e=>M.handle(K,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=j.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=i.get("next.route");if(r){let t=`${U} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${g}`)}),s=!!(0,a.getRequestMeta)(e,"minimalMode"),d=async a=>{var n,d;let l=async({previousCacheEntry:i})=>{try{if(!s&&A&&C&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let d=L.renderOpts.pendingWaitUntil;d&&r.waitUntil&&(r.waitUntil(d),d=void 0);let l=L.renderOpts.collectedTags;if(!H)return await (0,p.sendResponse)(W,B,n,L.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);l&&(t[f.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,r=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:_.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:r}}}}catch(t){throw(null==i?void 0:i.isStale)&&await M.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:A})},!1,T),t}},c=await M.handleResponse({req:e,nextConfig:E,cacheKey:D,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:x,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:C,responseGenerator:l,waitUntil:r.waitUntil,isMinimalMode:s});if(!H)return null;if((null==c||null==(n=c.value)?void 0:n.kind)!==_.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(d=c.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",A?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),b&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let v=(0,h.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&H||v.delete(f.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||v.get("Cache-Control")||v.set("Cache-Control",(0,m.getCacheControlHeader)(c.cacheControl)),await (0,p.sendResponse)(W,B,new Response(c.value.body,{headers:v,status:c.value.status||200})),null};F?await d(F):await j.withPropagatedContext(e.headers,()=>j.trace(c.BaseServerSpan.handleRequest,{spanName:`${U} ${g}`,kind:n.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},d))}catch(t){if(t instanceof v.NoFallbackError||await M.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,u.getRevalidateReason)({isStaticGeneration:q,isOnDemandRevalidate:A})},!1,T),H)throw t;return await (0,p.sendResponse)(W,B,new Response(null,{status:500})),null}}e.s(["handler",()=>B,"patchFetch",()=>W,"routeModule",()=>M,"serverHooks",()=>L,"workAsyncStorage",()=>j,"workUnitAsyncStorage",()=>F],459056)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_63fff456.js.map