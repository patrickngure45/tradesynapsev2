(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,184724,e=>{"use strict";var t=e.i(843476);function r(e){let t=e?.variant??"secondary",r=e?.size??"md";return["inline-flex select-none items-center justify-center gap-2 whitespace-nowrap rounded-xl transition focus:outline-none focus:ring-2 focus:ring-[var(--v2-ring)] disabled:pointer-events-none disabled:opacity-55","lg"===r?"h-12 px-5 text-[15px]":"sm"===r?"h-9 px-3 text-[13px]":"h-11 px-4 text-[14px]","primary"===t?"bg-[var(--v2-accent)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"danger"===t?"bg-[var(--down)] text-white font-semibold shadow-[var(--v2-shadow-sm)] hover:brightness-105":"ghost"===t?"bg-transparent text-[var(--v2-text)] font-semibold hover:bg-[var(--v2-surface-2)]":"border border-[var(--v2-border)] bg-[var(--v2-surface)] text-[var(--v2-text)] font-semibold shadow-[var(--v2-shadow-sm)] hover:bg-[var(--v2-surface-2)]",e?.fullWidth?"w-full":"",e?.className??""].filter(Boolean).join(" ")}let s=e.i(271645).forwardRef(function({variant:e,size:s,fullWidth:a,className:i,type:n,...d},l){return(0,t.jsx)("button",{ref:l,type:n??"button",className:r({variant:e,size:s,fullWidth:a,className:i}),...d})});e.s(["V2Button",0,s,"v2ButtonClassName",()=>r])},283538,e=>{"use strict";var t=e.i(843476);function r({children:e,className:r=""}){return(0,t.jsx)("section",{className:"rounded-[var(--v2-radius-lg)] border border-[var(--v2-border)] bg-[var(--v2-surface)] shadow-[var(--v2-shadow-sm)] "+r,children:e})}function s({title:e,subtitle:r,right:s}){return(0,t.jsxs)("header",{className:"flex items-start justify-between gap-3 px-4 pt-4",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:e}),r?(0,t.jsx)("div",{className:"mt-0.5 text-[13px] text-[var(--v2-muted)]",children:r}):null]}),s?(0,t.jsx)("div",{className:"shrink-0",children:s}):null]})}function a({children:e}){return(0,t.jsx)("div",{className:"px-4 pb-4 pt-3",children:e})}e.s(["V2Card",()=>r,"V2CardBody",()=>a,"V2CardHeader",()=>s])},59298,e=>{"use strict";var t=e.i(843476);function r({className:e=""}){return(0,t.jsx)("div",{className:"animate-pulse rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface-2)] "+e,"aria-hidden":"true"})}e.s(["V2Skeleton",()=>r])},302921,e=>{"use strict";var t=e.i(843476),r=e.i(522016),s=e.i(271645),a=e.i(184724),i=e.i(283538),n=e.i(59298);function d(e){let t=Number(String(e??""));if(!Number.isFinite(t))return"—";if(0===t)return"0";let r=Math.abs(t);return t.toLocaleString(void 0,{maximumFractionDigits:r>=1e3?2:r>=1?4:r>=.01?6:8})}function l(){let[e,l]=(0,s.useState)([]),[c,o]=(0,s.useState)(!0),[u,v]=(0,s.useState)(null),x=(0,s.useRef)(!1),m=(0,s.useRef)(null),h=(0,s.useRef)(0),p=(0,s.useRef)(!1),f=(0,s.useRef)(0),b=(0,s.useRef)(null),g=async()=>{let e=++f.current;b.current?.abort();let t=new AbortController;b.current=t,v(null),x.current||o(!0);try{let r=await fetch("/api/p2p/orders",{cache:"no-store",credentials:"include",signal:t.signal}),s=await r.json().catch(()=>null);if(!r.ok){let e="string"==typeof s?.error?s.error:`http_${r.status}`;throw Error(e)}if(e!==f.current)return;l(Array.isArray(s?.orders)?s.orders:[]),x.current=!0}catch(t){if(t instanceof DOMException&&"AbortError"===t.name||e!==f.current)return;x.current||v(t instanceof Error?t.message:String(t))}finally{e===f.current&&o(!1)}};(0,s.useEffect)(()=>{p.current=e.some(e=>{let t=String(e.status||"").toLowerCase();return"created"===t||"paid_confirmed"===t||"disputed"===t})},[e]),(0,s.useEffect)(()=>{g();let e=null,t=()=>{e&&(window.clearTimeout(e),e=null)},r=()=>{t();let s=m.current?p.current?25e3:45e3:15e3;e=window.setTimeout(()=>{e=null,"visible"===document.visibilityState&&g(),r()},s)},s=()=>{"visible"===document.visibilityState?(g(),r()):t()};return document.addEventListener("visibilitychange",s),r(),()=>{document.removeEventListener("visibilitychange",s),t(),b.current?.abort()}},[]),(0,s.useEffect)(()=>{let e=()=>{try{m.current?.close()}catch{}m.current=null},t=()=>{let e=Date.now();e-h.current<900||(h.current=e,"visible"===document.visibilityState&&g())},r=()=>{if(!("visible"!==document.visibilityState||"u"<typeof EventSource)&&!m.current)try{let e=new EventSource("/api/notifications/stream",{withCredentials:!0});e.addEventListener("notification",e=>{try{var r;let s=JSON.parse(String(e.data??"{}"));r=String(s?.type??""),String(r||"").startsWith("p2p_")&&t()}catch{}}),e.addEventListener("ready",()=>t()),e.onerror=()=>{},m.current=e}catch{e()}},s=()=>{"visible"===document.visibilityState?r():e()};return document.addEventListener("visibilitychange",s),r(),()=>{document.removeEventListener("visibilitychange",s),e()}},[]);let{active:j,history:y,missingDetailsCount:N}=(0,s.useMemo)(()=>{let t=e.filter(e=>["created","paid_confirmed","disputed"].includes(String(e.status))),r=e.filter(e=>!["created","paid_confirmed","disputed"].includes(String(e.status))),s=t.filter(e=>!1===e.payment_details_ready).length;return{active:t,history:r,missingDetailsCount:s}},[e]),w=e=>(0,t.jsx)("div",{className:"grid gap-2",children:e.map(e=>{let s,a,i="BUY"===e.my_side?"text-[var(--up)]":"text-[var(--down)]";return(0,t.jsx)(r.default,{href:`/v2/p2p/orders/${encodeURIComponent(e.id)}`,className:"rounded-2xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-3 shadow-[var(--v2-shadow-sm)]",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("div",{className:`text-[12px] font-bold ${i}`,children:e.my_side}),(0,t.jsxs)("div",{className:"text-[15px] font-semibold text-[var(--v2-text)]",children:[d(e.amount_asset)," ",String(e.asset_symbol||"—")]}),(a="created"===(s=String(e.status||"").toLowerCase())?"text-[var(--v2-accent)]":"paid_confirmed"===s?"text-[var(--warn)]":"completed"===s?"text-[var(--up)]":"disputed"===s?"text-[var(--down)]":"text-[var(--v2-muted)]",(0,t.jsx)("span",{className:`rounded-full border border-[var(--v2-border)] bg-[var(--v2-surface-2)] px-2 py-0.5 text-[11px] font-semibold ${a}`,children:s.replaceAll("_"," ")||"—"}))]}),(0,t.jsxs)("div",{className:"mt-1 text-[12px] text-[var(--v2-muted)]",children:["≈ ",d(e.amount_fiat)," ",String(e.fiat_currency||"")]}),(0,t.jsx)("div",{className:"mt-1 text-[12px] text-[var(--v2-muted)]",children:function(e){if(!e)return"";try{return new Date(e).toLocaleString()}catch{return String(e)}}(e.created_at)})]}),!1===e.payment_details_ready?(0,t.jsx)("span",{className:"shrink-0 rounded-full border border-[var(--v2-border)] bg-[color-mix(in_srgb,var(--warn)_10%,transparent)] px-2 py-0.5 text-[11px] font-semibold text-[var(--warn)]",children:"Payment details missing"}):null]})},e.id)})});return(0,t.jsxs)("main",{className:"space-y-4",children:[(0,t.jsxs)("header",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--v2-muted)]",children:"P2P"}),(0,t.jsx)("h1",{className:"text-2xl font-extrabold tracking-tight",children:"My orders"})]}),(0,t.jsx)(r.default,{href:"/v2/p2p",className:"rounded-xl border border-[var(--v2-border)] bg-[var(--v2-surface)] px-3 py-2 text-[12px] font-semibold text-[var(--v2-text)]",children:"Marketplace"})]}),(0,t.jsx)("p",{className:"text-sm text-[var(--v2-muted)]",children:"Active orders first, then history."})]}),N>0?(0,t.jsxs)("div",{className:"rounded-2xl border border-[var(--v2-border)] bg-[color-mix(in_srgb,var(--warn)_10%,transparent)] px-3 py-3 text-[12px] text-[var(--v2-text)]",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Action needed:"})," ",N," active ",1===N?"order is":"orders are"," missing seller payment details."]}):null,u&&0===e.length?(0,t.jsxs)(i.V2Card,{children:[(0,t.jsx)(i.V2CardHeader,{title:"Orders unavailable",subtitle:"Sign in and try again."}),(0,t.jsxs)(i.V2CardBody,{children:[(0,t.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:String(u)}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)(a.V2Button,{variant:"primary",fullWidth:!0,onClick:()=>void g(),children:"Retry"})})]})]}):c&&0===e.length?(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(n.V2Skeleton,{className:"h-20"}),(0,t.jsx)(n.V2Skeleton,{className:"h-20"}),(0,t.jsx)(n.V2Skeleton,{className:"h-20"})]}):0===e.length?(0,t.jsxs)(i.V2Card,{children:[(0,t.jsx)(i.V2CardHeader,{title:"No P2P orders",subtitle:"Your P2P activity will appear here."}),(0,t.jsx)(i.V2CardBody,{children:(0,t.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Start from the marketplace to create an order."})})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("section",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-[13px] font-semibold text-[var(--v2-text)]",children:"Active"}),(0,t.jsx)("div",{className:"text-[12px] text-[var(--v2-muted)]",children:j.length})]}),0===j.length?(0,t.jsxs)(i.V2Card,{children:[(0,t.jsx)(i.V2CardHeader,{title:"No active orders",subtitle:"You’re all caught up."}),(0,t.jsx)(i.V2CardBody,{children:(0,t.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Completed/canceled orders are in history."})})]}):w(j)]}),(0,t.jsxs)("section",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-[13px] font-semibold text-[var(--v2-text)]",children:"History"}),(0,t.jsx)("div",{className:"text-[12px] text-[var(--v2-muted)]",children:y.length})]}),0===y.length?(0,t.jsxs)(i.V2Card,{children:[(0,t.jsx)(i.V2CardHeader,{title:"No history",subtitle:"No completed P2P orders yet."}),(0,t.jsx)(i.V2CardBody,{children:(0,t.jsx)("div",{className:"text-sm text-[var(--v2-muted)]",children:"Once you finish a trade, it’ll appear here."})})]}):w(y.slice(0,30))]})]})]})}e.s(["P2POrdersClient",()=>l])}]);