(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,261238,e=>{"use strict";class t extends Error{code;details;status;requestId;constructor(e,t){super(t?.requestId?`${e} (req ${t.requestId})`:e),this.name="ApiError",this.code=e,this.details=t?.details,this.status=t?.status,this.requestId=t?.requestId}}function s(e){return new Promise(t=>setTimeout(t,Math.max(0,Math.floor(e))))}async function r(e,r){let a=r?{...r,credentials:r.credentials??"same-origin"}:{credentials:"same-origin"},d=(a?.method??"GET").toUpperCase();if(("GET"===d||"HEAD"===d)&&function(e){try{let t=window.location.origin,s="string"==typeof e?new URL(e,t):e instanceof URL?e:e instanceof Request?new URL(e.url):null;if(!s||s.origin!==t)return!1;return s.pathname.startsWith("/api/")}catch{return!1}}(e)){let e=function(){try{return(new URL(window.location.href).searchParams.get("user_id")??"").trim()||null}catch{return null}}();if(e){let t=new Headers(a?.headers);t.has("x-impersonate-user-id")||t.set("x-impersonate-user-id",e),a.headers=t}}if(["POST","PUT","PATCH","DELETE"].includes(d)){let e=function(){if("u"<typeof document)return null;let e=document.cookie.match(/(?:^|;\s*)__csrf=([^;]+)/);return e?.[1]??null}();if(e){let t=new Headers(a?.headers);t.has("x-csrf-token")||t.set("x-csrf-token",e),a.headers=t}}let n=(a?.method??"GET").toUpperCase(),i="GET"===n||"HEAD"===n,l=2*!!i,o=null;for(let r=0;r<=l;r+=1)try{let d=await fetch(e,a),n=d.headers.get("x-request-id")??void 0;try{n&&window.sessionStorage.setItem("ts.last_request_id",n)}catch{}let o=await d.text().catch(()=>""),c=(d.headers.get("content-type")??"").includes("text/html")||function(e){let t=String(e??"").trimStart();return t.startsWith("<!DOCTYPE html")||t.startsWith("<html")||t.startsWith("<!doctype html")}(o),u=c?{_raw:"<html/>"}:function(e){try{return e?JSON.parse(e):null}catch{return{_raw:e}}}(o);if(!d.ok){if(i&&(502===d.status||503===d.status||504===d.status)&&r<l){await s(250*Math.pow(2,r));continue}if(u&&"object"==typeof u&&"error"in u){let e="string"==typeof u.error?u.error:`http_${d.status}`,s=void 0!==u.details?u.details:"string"==typeof u.message?u.message:c?{message:`Upstream error (HTTP ${d.status}). Please retry.`}:void 0;throw new t(e,{details:s,status:d.status,requestId:n})}if(u&&"object"==typeof u&&"message"in u){let e="string"==typeof u.message?u.message:u;throw new t(`http_${d.status}`,{details:e,status:d.status,requestId:n})}let e=c?{message:`Upstream error (HTTP ${d.status}). Please retry.`}:u;throw new t(`http_${d.status}`,{details:e,status:d.status,requestId:n})}return u}catch(e){if(o=e,i&&r<l){await s(250*Math.pow(2,r));continue}throw e}throw o}e.s(["ApiError",()=>t,"fetchJsonOrThrow",()=>r])},922911,e=>{"use strict";var t=e.i(843476),s=e.i(271645),r=e.i(261238);function a(e){if(!Number.isFinite(e)||e<=0)return"0s";if(e<1)return`${Math.round(1e3*e)}ms`;if(e<60)return`${Math.round(10*e)/10}s`;let t=Math.floor(e/60),s=Math.round(e-60*t);if(t<60)return`${t}m ${s}s`;let r=Math.floor(t/60);return`${r}h ${t-60*r}m`}function d(){let[e,d]=(0,s.useState)(!0),[n,i]=(0,s.useState)(null),[l,o]=(0,s.useState)(null);function c(e){let t=l?.[e]?.distribution_all_time??[],s=t.reduce((e,t)=>e+(Number.isFinite(t.count)?t.count:0),0);return{rows:t,total:s}}(0,s.useEffect)(()=>{let e=!1;return(async()=>{d(!0),i(null);try{let t=await (0,r.fetchJsonOrThrow)("/api/arcade/transparency",{cache:"no-store"});e||o(t)}catch(t){if(e)return;t instanceof r.ApiError?i(t.code):i("Network error")}finally{e||d(!1)}})(),()=>{e=!0}},[]);let u=(0,s.useMemo)(()=>c("daily_drop"),[l]),x=(0,s.useMemo)(()=>c("calendar_daily"),[l]),m=(0,s.useMemo)(()=>c("time_vault"),[l]),v=(0,s.useMemo)(()=>c("boost_draft"),[l]),h=(0,s.useMemo)(()=>c("ai_oracle"),[l]),b=(0,s.useMemo)(()=>{let e=l?.boost_consumption_7d??[],t=new Map;for(let s of e)t.set(s.code,(t.get(s.code)??0)+(Number(s.count)||0));let s=Array.from(t.entries()).map(([e,t])=>({code:e,count:t}));return s.sort((e,t)=>t.count-e.count),s.slice(0,10)},[l]),g=(0,s.useMemo)(()=>{let e=(l?.latency_7d??[]).map(e=>({module:e.module,n:Number(e.n)||0,p50_s:Number(e.p50_s)||0,p95_s:Number(e.p95_s)||0,avg_s:Number(e.avg_s)||0})).filter(e=>e.n>0);return e.sort((e,t)=>t.p95_s-e.p95_s),e},[l]),p=(0,s.useMemo)(()=>{let e=(l?.overdue??[]).map(e=>({module:e.module,count:Number(e.count)||0})).filter(e=>e.count>0);return e.sort((e,t)=>t.count-e.count),e},[l]);return e?(0,t.jsx)("div",{className:"h-40 w-full animate-pulse rounded-3xl border border-[var(--border)] bg-[color-mix(in_srgb,var(--card)_55%,transparent)]"}):n?(0,t.jsxs)("div",{className:"rounded-2xl border border-[var(--border)] bg-[var(--warn-bg)] px-6 py-5 text-sm text-[var(--foreground)]",children:["Error: ",(0,t.jsx)("span",{className:"font-semibold",children:n})]}):l?(0,t.jsxs)("div",{className:"grid gap-6",children:[(0,t.jsx)("section",{className:"grid gap-4 md:grid-cols-4",children:[{k:"Actions",v:l.counts.actions_total,sub:"Total commits"},{k:"Resolved",v:l.counts.actions_resolved,sub:"Reveals completed"},{k:"Inventory",v:l.counts.inventory_quantity,sub:"Total items"},{k:"Stacks",v:l.counts.inventory_rows,sub:"Unique items"}].map(e=>(0,t.jsxs)("div",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-4 shadow-[var(--shadow)]",children:[(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:e.k}),(0,t.jsx)("div",{className:"mt-2 text-2xl font-extrabold tracking-tight text-[var(--foreground)]",children:e.v}),(0,t.jsx)("div",{className:"mt-1 text-xs text-[var(--muted)]",children:e.sub})]},e.k))}),[{key:"daily_drop",title:"Daily drop distribution",dist:u},{key:"calendar_daily",title:"Calendar distribution",dist:x},{key:"time_vault",title:"Time vault distribution",dist:m},{key:"boost_draft",title:"Boost draft distribution",dist:v},{key:"ai_oracle",title:"AI Oracle tier distribution",dist:h}].map(e=>(0,t.jsxs)("section",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 shadow-[var(--shadow)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"relative inline-flex h-2.5 w-2.5 shrink-0 items-center justify-center",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 rounded-full bg-[var(--accent)]"}),(0,t.jsx)("span",{className:"absolute inline-flex h-4.5 w-4.5 rounded-full bg-[var(--ring)]"})]}),(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:e.title}),(0,t.jsx)("div",{className:"h-px flex-1 bg-[var(--border)]"})]}),0===e.dist.total?(0,t.jsx)("div",{className:"mt-5 text-sm text-[var(--muted)]",children:"No resolved actions yet."}):(0,t.jsx)("div",{className:"mt-5 grid gap-3",children:e.dist.rows.map(s=>{let r,a=Math.round(1e4*s.count/Math.max(1,e.dist.total))/100,d="legendary"===(r=String(s.rarity??"").toLowerCase())?{dot:"bg-[var(--warn)]",bg:"bg-[var(--warn-bg)]",text:"text-[var(--warn)]"}:"epic"===r?{dot:"bg-[var(--accent-2)]",bg:"bg-[color-mix(in_srgb,var(--accent-2)_12%,transparent)]",text:"text-[var(--accent-2)]"}:"rare"===r?{dot:"bg-[var(--accent)]",bg:"bg-[color-mix(in_srgb,var(--accent)_10%,transparent)]",text:"text-[var(--accent)]"}:{dot:"bg-[var(--border)]",bg:"bg-[var(--card-2)]",text:"text-[var(--muted)]"};return(0,t.jsxs)("div",{className:"rounded-xl border border-[var(--border)] bg-[var(--bg)] p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`h-2.5 w-2.5 rounded-full ${d.dot}`,"aria-hidden":!0}),(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--foreground)]",children:s.rarity})]}),(0,t.jsxs)("div",{className:"text-xs text-[var(--muted)]",children:[s.count," · ",a,"%"]})]}),(0,t.jsx)("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-[var(--card-2)]",children:(0,t.jsx)("div",{className:`h-full ${d.bg}`,style:{width:`${Math.min(100,Math.max(0,a))}%`}})})]},s.rarity)})})]},e.key)),(0,t.jsxs)("section",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 shadow-[var(--shadow)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"relative inline-flex h-2.5 w-2.5 shrink-0 items-center justify-center",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 rounded-full bg-[var(--accent)]"}),(0,t.jsx)("span",{className:"absolute inline-flex h-4.5 w-4.5 rounded-full bg-[var(--ring)]"})]}),(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Resolution latency (7d)"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-[var(--border)]"})]}),0===g.length?(0,t.jsx)("div",{className:"mt-5 text-sm text-[var(--muted)]",children:"No resolved actions in the last 7 days."}):(0,t.jsx)("div",{className:"mt-5 grid gap-2",children:g.map(e=>(0,t.jsxs)("div",{className:"grid gap-2 rounded-xl border border-[var(--border)] bg-[var(--bg)] p-4 md:grid-cols-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-[var(--foreground)]",children:e.module}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-[var(--muted)]",children:["n=",e.n]})]}),(0,t.jsxs)("div",{className:"text-xs text-[var(--muted)]",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--foreground)]",children:"p50"})," ",a(e.p50_s)]}),(0,t.jsxs)("div",{className:"text-xs text-[var(--muted)]",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--foreground)]",children:"p95"})," ",a(e.p95_s)]}),(0,t.jsxs)("div",{className:"text-xs text-[var(--muted)]",children:[(0,t.jsx)("span",{className:"font-semibold text-[var(--foreground)]",children:"avg"})," ",a(e.avg_s)]})]},e.module))})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 shadow-[var(--shadow)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"relative inline-flex h-2.5 w-2.5 shrink-0 items-center justify-center",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 rounded-full bg-[var(--warn)]"}),(0,t.jsx)("span",{className:"absolute inline-flex h-4.5 w-4.5 rounded-full bg-[var(--ring)]"})]}),(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Overdue actions"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-[var(--border)]"})]}),0===p.length?(0,t.jsx)("div",{className:"mt-5 text-sm text-[var(--muted)]",children:"No overdue actions right now."}):(0,t.jsx)("div",{className:"mt-5 grid gap-2",children:p.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-[var(--border)] bg-[var(--bg)] px-4 py-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--foreground)]",children:e.module}),(0,t.jsxs)("div",{className:"text-xs font-bold text-[var(--muted)]",children:["×",e.count]})]},e.module))})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 shadow-[var(--shadow)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"relative inline-flex h-2.5 w-2.5 shrink-0 items-center justify-center",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 rounded-full bg-[var(--accent-2)]"}),(0,t.jsx)("span",{className:"absolute inline-flex h-4.5 w-4.5 rounded-full bg-[var(--ring)]"})]}),(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Boosts spent (7d)"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-[var(--border)]"})]}),0===b.length?(0,t.jsx)("div",{className:"mt-5 text-sm text-[var(--muted)]",children:"No boosts spent in the last 7 days."}):(0,t.jsx)("div",{className:"mt-5 grid gap-2",children:b.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-[var(--border)] bg-[var(--bg)] px-4 py-3",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-[var(--foreground)]",children:e.code}),(0,t.jsxs)("div",{className:"text-xs font-bold text-[var(--muted)]",children:["×",e.count]})]},e.code))})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] p-5 shadow-[var(--shadow)]",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"relative inline-flex h-2.5 w-2.5 shrink-0 items-center justify-center",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 rounded-full bg-[var(--accent)]"}),(0,t.jsx)("span",{className:"absolute inline-flex h-4.5 w-4.5 rounded-full bg-[var(--ring)]"})]}),(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Crafting activity (7d)"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-[var(--border)]"})]}),(0,t.jsxs)("div",{className:"mt-5 grid gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-[var(--border)] bg-[var(--bg)] p-4",children:[(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Items salvaged"}),(0,t.jsx)("div",{className:"mt-2 text-2xl font-extrabold tracking-tight text-[var(--foreground)]",children:l.crafting_7d.items_salvaged}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-[var(--muted)]",children:["Across ",l.crafting_7d.salvage_events," salvage events"]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-[var(--border)] bg-[var(--bg)] p-4",children:[(0,t.jsx)("div",{className:"text-[11px] font-bold uppercase tracking-widest text-[var(--muted)]",children:"Shards spent"}),(0,t.jsx)("div",{className:"mt-2 text-2xl font-extrabold tracking-tight text-[var(--foreground)]",children:l.crafting_7d.shards_spent}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-[var(--muted)]",children:["Across ",l.crafting_7d.craft_events," craft events"]})]})]})]})]}):(0,t.jsx)("div",{className:"rounded-2xl border border-[var(--border)] bg-[var(--card)] px-6 py-10 text-center text-sm text-[var(--muted)]",children:"No data yet."})}e.s(["ArcadeTransparencyClient",()=>d])}]);